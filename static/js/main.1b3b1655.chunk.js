(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(t,e,n){t.exports=n(30)},25:function(t,e,n){},28:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(18),s=n.n(r),o=(n(25),n(3)),l=n(4),c=n(7),d=n(5),u=n(6),h=n(19),p=n(1),g=n(8),m=n(11),b=function(t){return"string"!==typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},v=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setHeaderHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.datasets,a=e.selectDataset,r=e.strategies,s=e.strategy,o=(e.strategy_colors,e.selectStrategy),l=e.dataset,c=(e.activeStyle,e.grem);return i.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px"),fontWeight:"bold"}},"Active Learner")),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Dataset:"),n.map(function(t,e){var n,r=t===l;return n=r?i.a.createElement("span",null,t):i.a.createElement("button",{onClick:function(){a(e)}},t),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Strategy:"),r.map(function(t,e){var n,a=t===s;return n=a?i.a.createElement("span",null,b(t)):i.a.createElement("button",{onClick:function(){o(e)}},b(t)),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:a?"white":"transparent",color:a?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})))}}]),e}(a.Component);function f(t){return Math.round(1e4*t)/100+"%"}function y(t,e,n,a){a?t.moveTo(e,n):t.lineTo(e,n)}function _(t){return{background:t,boxShadow:"-0.25em 0 0 ".concat(t,", 0.25em 0 0 ").concat(t),textDecoration:"none"}}function w(t){var e=t.split("-");return{dataset:e[0],strategy:e[1],round:e[2]}}var x={random:{accuracy:[.9539,.9569,.9595,.9652,.9651,.9687,.9679,.9678,.9699],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},entropy:{accuracy:[.953,.9664,.971,.9746,.9791,.9776,.979,.9805,.9795],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},deepfool:{accuracy:[.954,.9656,.9703,.9762,.9782,.9805,.9765,.9819,.9816],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},ensemble:{accuracy:[.9639,.9703,.9772,.978,.9813,.9836,.9837,.9847,.9848],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]}},O=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return i.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},i.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),e}(a.Component),j=n(9),k=(Object(g.a)(Array(4)).map(function(t){return Object(g.a)(Array(5)).map(function(t){return Math.random()})}),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).ctx=null,n.getCtx=n.getCtx.bind(Object(p.a)(Object(p.a)(n))),n.draw=n.draw.bind(Object(p.a)(Object(p.a)(n))),n.handleRound=n.handleRound.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"getCtx",value:function(t){this.ctx=t.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(t){this.props.strategy_explored!==t.strategy_explored&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(t){t!==this.props.round&&this.props.selectRound(t)}},{key:"draw",value:function(){var t=this.props,e=(t.width,t.height),n=t.strategies,a=(t.strategy_colors,t.round),i=t.strategy,r=t.grem,s=t.transition_status,o=t.strategy_explored,l=x[i];e-=2*r,3===s&&(a+=1);var c=this.ctx,d=4,u=n.map(function(t){return j.min(x[t].accuracy)}),h=Math.floor(10*j.min(u))/10,p=1-h;c.clearRect(0,0,100*(o+1),e);var g=2*d;e-=2*g,c.fillStyle="rgba(100,100,100,0.3)",c.fillRect(100*a,g,100,e),c.lineWidth=3,c.strokeStyle="rgba(100,100,100,0.5)";for(var m=0;m<p+.05;m+=.05){c.beginPath();var b=m/p*e;y(c,0,b+g,!0),y(c,100*(o+1),b+g,!1),c.stroke()}var v=n.filter(function(t){return t!==i}),f=!0,_=!1,w=void 0;try{for(var O,k=v[Symbol.iterator]();!(f=(O=k.next()).done);f=!0){var E=O.value,S=x[E];c.lineWidth=2,c.strokeStyle="#666",c.fillStyle="#666",c.beginPath();for(var C=0;C<o+1;C++){y(c,100*C+50,e-(S.accuracy[C]-h)/(1-h)*e+g,0===C)}c.stroke();for(var M=0;M<o+1;M++){var A=(S.accuracy[M]-h)/(1-h);c.beginPath(),c.arc(100*M+50,e-A*e+g,d,0,2*Math.PI),c.fill()}}}catch(F){_=!0,w=F}finally{try{f||null==k.return||k.return()}finally{if(_)throw w}}d=6,c.lineWidth=2,c.strokeStyle="#efefef",c.fillStyle="#efefef",c.beginPath();for(var D=0;D<o+1;D++){y(c,100*D+50,e-(l.accuracy[D]-h)/(1-h)*e+g,0===D)}c.stroke();for(var T=0;T<o+1;T++){var P=(l.accuracy[T]-h)/(1-h);c.beginPath(),c.arc(100*T+50,e-P*e+g,d,0,2*Math.PI),c.fill()}}},{key:"render",value:function(){var t=this,e=this.props,n=(e.width,e.height),a=e.grem,r=(e.strategies,e.strategy),s=e.round,o=e.transition_status,l=(e.adjusted_round,e.strategy_explored),c=x[r],d=s;return o>1&&(d=s+1),i.a.createElement("div",{style:{}},i.a.createElement("div",{style:{display:"inline-flex",pointerEvents:"auto"}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("span",null,"Round ",s+1)," ")),i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Accuracy: ",f(c.accuracy[s])))),i.a.createElement("div",{style:{position:"relative",width:100*(l+1),height:n-2*a,pointerEvents:"auto"}},i.a.createElement(O,{width:100*(l+1),height:n-2*a,getCtx:this.getCtx,grem:a}),i.a.createElement(i.a.Fragment,null,Object(g.a)(Array(l+1)).map(function(e,r){return i.a.createElement("div",{onClick:function(){t.handleRound(r)},style:{position:"absolute",top:0,left:100*r,width:100,height:n-2*a,cursor:r===s?"default":"pointer"}})}))),i.a.createElement("div",{style:{display:"flex",pointerEvents:"auto",justifyContent:"space-between",padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"100,000 points, ",function(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}(c.num_labeled[d])," labelled (",f(c.num_labeled[d]/1e6),")")))}}]),e}(a.Component)),E=(Math.floor(10*Math.random()),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setFooterHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.round,a=e.ww,r=e.grem,s=e.strategies,o=e.strategy_colors,l=e.strategy,c=(e.selectRound,e.color_array_hexes,e.transition_status),d=(e.simulating_labeling,e.gradient_string,n),u=e.strategy_explored;return c>1&&c<2.3&&(d=Math.max(0,d-1),u=Math.max(0,u-1)),i.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",bottom:0,left:0,height:7*r,pointerEvents:"none"}},i.a.createElement(k,{width:a,transition_status:c,height:7*r,grem:r,strategies:s,selectRound:this.props.selectRound,strategy_colors:o,strategy:l,round:d,strategy_explored:u}))}}]),e}(a.Component)),S=n(14),C=n(2),M=n(12),A=n(10);var D=Object(g.a)(Array(12)).map(function(t,e){return"".concat("/activelearner","/").concat("mnist_").concat(e,".png")});(new C.i).load("".concat("/activelearner","/circle.png")).flipY=!1;for(var T=[],P=0;P<12;P++){var F=5329*P,H=5329*(P+1);11===P&&(H=63948),T.push([F,H])}var z=10,R=Object(g.a)(Array(z)).map(function(t,e){return m.hsl(0+360/z*e,1,.5).luminance(.5).gl()});R.push(m.hsl(0,0,.5).luminance(.1).gl()),z=10;var U=Object(g.a)(Array(z)).map(function(t,e){return m.hsl(0+360/z*e,1,.5).luminance(.5).hex()}),L=R.map(function(t){return t.slice(0,3)});function W(t,e){return{coordinates:t.coordinates.slice(e[0],e[1]),labels:t.labels.slice(e[0],e[1]),statuses:t.statuses.slice(e[0],e[1])}}function q(t){for(var e=[],n=0;n<t.length;n++){var a=t[n];e.push(a[0],a[1],0)}return new Float32Array(e)}for(var G=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.init=n.init.bind(Object(p.a)(Object(p.a)(n))),n.animate=n.animate.bind(Object(p.a)(Object(p.a)(n))),n.addPoints=n.addPoints.bind(Object(p.a)(Object(p.a)(n))),n.transitionPoints=n.transitionPoints.bind(Object(p.a)(Object(p.a)(n))),n.addSelectedPoints=n.addSelectedPoints.bind(Object(p.a)(Object(p.a)(n))),n.labelSelected=n.labelSelected.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"getZFromScale",value:function(t){var e=C.d.degToRad(this.camera.fov);return this.props.height/t/(2*Math.tan(e/2))}},{key:"getScaleFromZ",value:function(t){var e=C.d.degToRad(this.camera.fov),n=2*(Math.tan(e/2)*t);return this.props.height/n}},{key:"zoomHandler",value:function(){var t=M.a.transform,e=t.k,n=-(t.x-this.props.width/2)/e,a=(t.y-this.props.height/2)/e,i=this.getZFromScale(e);this.camera.position.set(n,a,i)}},{key:"addPoints",value:function(){var t=this.props,e=t.loaded_embedding,n=t.embeddings;this.scene.children[0]=new C.c;for(var a=n[e],i=T.map(function(t){return W(a,t)}),r=new C.c,s=i.length,o=0;o<s;o++){for(var l=i[o],c=l.coordinates.length,d=new C.b,u=q(l.coordinates),h=new Float32Array(2*c),p=0,g=0,m=c;p<m;p++,g+=2){var b=p%73*28/2048,v=28*Math.floor(p/73)/2048;h[g]=b,h[g+1]=v}var f=l.labels.map(function(t){return L[t]}),y=j.flatten(f),_=new Float32Array(y),w=this.textures[o],x=[1/73,1/73];d.addAttribute("position",new C.a(u,3)),d.addAttribute("offset",new C.a(h,2)),d.addAttribute("color",new C.a(_,3));var O={texture:{value:w},repeat:{value:Object(S.a)(C.j,x)},size:{value:20}},k=new C.h({uniforms:O,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new C.f(d,k);r.add(E)}this.scene.children[0]=r}},{key:"transitionPoints",value:function(t,e){for(var n=this,a=this.scene.children[0],i=this.scene.children[1].children,r=e[t],s=T.map(function(t){return W(r,t)}),o=s.length,l=function(t){var e=a.children[t],r=s[t],o=e.geometry.attributes.position.array.slice(),l=q(r.coordinates),c=new A.Tween(o).to(l,800).easing(A.Easing.Linear.None);c.onUpdate(function(){e.geometry.attributes.position.array=o,e.geometry.attributes.position.needsUpdate=!0}),c.start();var d=i[t],u=Array.from(d.geometry.attributes.indexes.array),h=d.geometry.attributes.position.array.slice(),p=q(u.map(function(t){return r.coordinates[t]})),g=new Float32Array(p),m={value:20},b=n,v=new A.Tween(m).to({value:0},400).easing(A.Easing.Linear.None).delay(400).onComplete(function(){0===t&&(b.addSelectedPoints(),b.props.setTransitionStatus(.5))});v.onUpdate(function(){d.material.uniforms.size=m});var f=new A.Tween(h).to(g,800).easing(A.Easing.Linear.None);f.onUpdate(function(){d.geometry.attributes.position.array=h,d.geometry.attributes.position.needsUpdate=!0}),f.onComplete(function(){0===t&&setTimeout(function(){b.addPoints(),d.material.uniforms.size.value>0?b.props.setTransitionStatus(2.6):(b.addSelectedPoints(),b.props.setTransitionStatus(0))},0)}),d.material.uniforms.size.value>0&&f.chain(v),f.start()},c=0;c<o;c++)l(c)}},{key:"addSelectedPoints",value:function(){var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings;this.scene.children[1]=new C.c;for(var i=a[n],r=T.map(function(t){return W(i,t)}),s=new C.c,o=r.length,l=function(e){for(var n=r[e],a=[],i=0;i<n.statuses.length;i++)1===n.statuses[i]&&a.push(i);for(var o=new Float32Array(a),l=a.length,c=new C.b,d=q(a.map(function(t){return n.coordinates[t]})),u=new Float32Array(2*l),h=0,p=0,g=l;h<g;h++,p+=2){var m=a[h],b=m%73*28/2048,v=28*Math.floor(m/73)/2048;u[p]=b,u[p+1]=v}var f=a.map(function(t){return[1,1,1]}),y=j.flatten(f),_=new Float32Array(y),w=t.textures[e],x=[1/73,1/73];c.addAttribute("position",new C.a(d,3)),c.addAttribute("offset",new C.a(u,2)),c.addAttribute("color",new C.a(_,3)),c.addAttribute("indexes",new C.a(o,1));var O={texture:{value:w},repeat:{value:Object(S.a)(C.j,x)},size:{value:0}},k=new C.h({uniforms:O,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new C.f(c,k);s.add(E)},c=0;c<o;c++)l(c);this.scene.children[1]=s}},{key:"revealSelected",value:function(){for(var t=this,e={value:0},n={value:20},a=this.scene.children[1].children,i=function(i){var r=a[i],s=new A.Tween(e).to(n,400).easing(A.Easing.Linear.None);s.onUpdate(function(){r.material.uniforms.size=e});var o=t;s.onComplete(function(){0===i&&o.props.setTransitionStatus(1)}),s.start()},r=0;r<a.length;r++)i(r)}},{key:"labelSelected",value:function(){for(var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings[n],i=T.map(function(t){return W(a,t)}),r=this.scene.children[1].children,s=function(e){var n=i[e],a=r[e],s=Array.from(a.geometry.attributes.indexes.array),o=r[e].geometry.attributes.color.array.slice(),l=s.map(function(t){var e=n.labels[t];return L[e]}),c=j.flatten(l),d=new Float32Array(c),u=new A.Tween(o).to(d,400).easing(A.Easing.Linear.None),h=r[e];u.onUpdate(function(){h.geometry.attributes.color.array=o,h.geometry.attributes.color.needsUpdate=!0});var p=t;u.onComplete(function(){0===e&&setTimeout(function(){p.props.setTransitionStatus(2.3)},0)}),u.start()},o=0;o<i.length;o++)s(o)}},{key:"componentDidUpdate",value:function(t){var e=this;if(null===t.loaded_embedding&&null!==this.props.loaded_embedding)Promise.all(function(t){var e=new C.i;return t.map(function(t){return new Promise(function(n,a){e.load(t,function(t){t.flipY=!1,n(t)},void 0,function(t){return a(t)})})})}(D)).then(function(t){e.textures=t,e.addPoints(),e.addSelectedPoints(),e.props.setTransitionStatus(.5)});else if(t.loaded_embedding!==this.props.loaded_embedding){var n=w(t.loaded_embedding),a=w(this.props.loaded_embedding);n.dataset!==a.dataset?console.log("different dataset"):n.strategy!==a.strategy?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):n.round!==a.round&&1.5!==this.props.transition_status&&this.transitionPoints(this.props.loaded_embedding,this.props.embeddings)}else.5===this.props.transition_status&&0===t.transition_status||.5===this.props.transition_status&&2.6===t.transition_status?this.revealSelected():2===this.props.transition_status&&1.5===t.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===t.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):(this.props.round,t.round)}},{key:"init",value:function(){var t=this.props,e=t.width,n=t.height;this.scene=new C.g;var a=e/n;this.camera=new C.e(75,a,.01,1e3),this.camera.position.z=30,this.renderer=new C.k,this.renderer.setClearColor(1118481,1),this.renderer.setSize(e,n),this.mount.appendChild(this.renderer.domElement);var i=new C.c;this.scene.add(i);var r=new C.c;this.scene.add(r),this.d3_zoom=M.d().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var s=M.c(this.mount);this.view=s,s.call(this.d3_zoom);var o=this.getScaleFromZ(this.camera.position.z),l=M.e.translate(e/2,n/2).scale(o);this.d3_zoom.transform(s,l),this.animate()}},{key:"animate",value:function(){requestAnimationFrame(this.animate),A.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,a=e.height,r=e.grem;return i.a.createElement("div",{style:{position:"absolute",left:0,width:n,height:a,background:"#222",overflow:"hidden"},grem:r},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:n,height:a},ref:function(e){t.mount=e}}),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"auto",padding:"0 ".concat(r/4,"px"),position:"absolute",left:0,bottom:this.props.footer_height+r}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Labels:"),i.a.createElement("div",{style:{background:"#888",color:"#111",width:r,height:r,textAlign:"center"}},"?"),U.map(function(t,e){return i.a.createElement("div",{style:{background:U[e],height:r,textAlign:"center",color:"#111",width:r}},e)})))}}]),e}(a.Component),I=(Object(g.a)(Array(40)).map(function(t){return null}),Object(g.a)(Array(12)).map(function(t,e){return"".concat("/activelearner","/").concat("mnist_").concat(e,".png")})),N=Object(g.a)(Array(10)).map(function(t,e){return m.hsl(0+36*e,1,.5).luminance(.5).hex()}),Z=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={labels:null,prev_loaded:null},n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidUpdate",value:function(t){var e=this,n=this.props.embeddings;if(this.props.loaded_embedding!==t.loaded_embedding)if(null===t.loaded_embedding)this.setState({prev_loaded:this.props.loaded_embedding});else{for(var a=n[t.loaded_embedding],i=[],r=0;r<a.statuses.length;r++)1===a.statuses[r]&&i.push(r);var s=n[this.props.loaded_embedding],o=i.map(function(t,e){return s.labels[t]});this.setState({labels:o})}if(0===this.props.transition_status&&0!==t.transition_status){var l=this;setTimeout(function(){l.setState({prev_loaded:e.props.loaded_embedding,labels:null})},800)}}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,a=e.height,r=e.grem,s=e.embeddings,o=e.loaded_embedding,l=e.transition_status,c=e.header_height,d=e.round,u=e.round_limit,h=[],p=s[this.state.prev_loaded];if(p)for(var g=0;g<p.statuses.length;g++)1===p.statuses[g]&&h.push(g);var m=r/4,b=r/4,v=(n-2*b*2-3*m)/4,f=v,y=h.map(function(t){var e=t%5329;return[Math.floor(t/5329),e%73,Math.floor(e/73)]});null!==o&&h.map(function(t,e){return s[o].labels[e]});var _=v/28,w=d;return l>1&&l<2.3&&(w=Math.max(0,w-1)),i.a.createElement("div",{style:{position:"absolute",right:0,top:c,width:n,height:a,background:"#333",overflow:"hidden"}},0===l?i.a.createElement("div",{style:{padding:r/4}},i.a.createElement("div",{style:{padding:r/4}},"Use the select data button below to select data points based on the strategy.")):null,i.a.createElement("div",{style:{opacity:0===l||2.6===l||u===w?0:1,transition:"opacity 0.4s linear",padding:r/2,position:"relative"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",position:"absolute",left:0,top:0,width:n,background:"#444",padding:"".concat(r/4,"px ").concat(r/2,"px")}},i.a.createElement("div",null,l<2?"Selected":"Labeled",":"),i.a.createElement("div",null,"1,000")),i.a.createElement("div",{style:{right:0,top:c,width:n,height:a-r/2,paddingTop:1*r,background:"#333",overflow:"auto"}},i.a.createElement("div",{style:{display:"grid",paddingTop:2*b,paddingBottom:2*b,gridTemplateColumns:"repeat(".concat(4,", ").concat(v,"px)"),gridColumnGap:m,gridRowGap:2*m}},y.length>0?y.map(function(e,n){var a=null!==t.state.labels&&t.props.transition_status>1.5?t.state.labels[n]:"?",s=null!==t.state.labels&&t.props.transition_status>1.5?N[t.state.labels[n]]:"#fff";return i.a.createElement("div",{style:{width:v,height:f+r,background:s,color:"#111",textAlign:"center",transition:"background 400ms linear"}},i.a.createElement("div",{style:{backgroundImage:"url(".concat(I[e[0]],")"),backgroundSize:"".concat(2048*_,"px ").concat(2048*_,"px"),backgroundPosition:"-".concat(e[1]*_*28,"px -").concat(e[2]*_*28,"px"),width:v,height:f,imageRendering:"pixelated"}}),i.a.createElement("div",null,a))}):null))))}}]),e}(a.Component),B=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,a=t.grem,r=t.strategies,s=t.strategy_colors,o=t.strategy,l=t.active_embedding,c=t.requested_embedding,d=t.loaded_embedding,u=t.embeddings,h=t.mnist_images,p=t.ranges,g=t.transition_status,m=t.setTransitionStatus,b=t.loading_round,v=t.header_height,f=t.footer_height,y=t.round,_=t.round_limit;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(G,{width:e,height:n,grem:a,active_embedding:l,strategies:r,strategy_colors:s,strategy:o,embeddings:u,requested_embedding:c,loaded_embedding:d,transition_status:g,setTransitionStatus:m,loading_round:b,footer_height:f,round:y}),i.a.createElement(Z,{width:200,height:n-this.props.footer_height-2*a-v,grem:a,mnist_images:h,embeddings:u,loaded_embedding:d,ranges:p,transition_status:g,header_height:v,round:y,round_limit:_}))}}]),e}(a.Component),J=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t,e,n=this,a=this.props,r=a.transition_status,s=a.grem,o=a.round_limit,l=a.round;0===r?(t="Loading...",e=null):.5===r?(t="Selecting...",e=null):1===r?(t="Label & train",e=1.5):1.5===r?(t="Labeling...",e=null):2===r?(t="Training...",e=null):2.3===r?(t="Training...",e=null):2.6===r&&(t="Deselecting...",e=null);var c=l;return r>1&&r<2.3&&(c=Math.max(0,c-1)),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",background:"#111",position:"absolute",bottom:this.props.footer_height,right:0}},i.a.createElement("div",null,o!==c?i.a.createElement("button",{style:{width:200,height:2*s,background:null===e?"#eee":"white",color:"black",textAlign:"left",paddingLeft:s/2,cursor:null===e?"default":"pointer",textDecoration:null===e?"none":"underline"},disabled:null===e,onClick:function(){null!==e&&n.props.setTransitionStatus(e)}},t):null))}}]),e}(a.Component),V=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={count:0},n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=0,e=0,n=this;function a(){t+=25;var i=Math.floor(t);i!==e&&(e=i),n.setState({count:e}),e<1e3?requestAnimationFrame(a):setTimeout(function(){n.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(a)},200)}},{key:"render",value:function(){var t=this.props,e=t.grem,n=t.ww;return i.a.createElement("div",null,i.a.createElement("div",{style:{height:e,width:"".concat(100,"%"),marginTop:e/2,background:"#222"}},i.a.createElement("div",{style:{height:e,width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},i.a.createElement("div",{style:{height:e,width:Math.min(500,n)-2*e,background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),e}(a.Component),Y=4,Q=Object(g.a)(Array(Y)).map(function(t,e){return m.hsl(90/Y*e-45,1,.5).luminance(.5).hex()}),$=[],K=0;K<12;K++){var X=5329*K,tt=5329*(K+1);11===K&&(tt=63948),$.push([X,tt])}var et=Object(g.a)(Array(12)).map(function(t,e){return"".concat("/activelearner","/").concat("mnist_").concat(e,".png")}).map(function(t){var e=document.createElement("img");return e.src=t,e});Y=10;var nt=Object(g.a)(Array(Y)).map(function(t,e){return m.hsl(0+360/Y*e,1,.5).luminance(.5).hex()}),at=nt.reduce(function(t,e,n){return t+e+" "+Math.round(n/Y*100)+(n===Y-1?"%":"%, ")},""),it=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1},n.setSize=n.setSize.bind(Object(p.a)(Object(p.a)(n))),n.setHeaderHeight=n.setHeaderHeight.bind(Object(p.a)(Object(p.a)(n))),n.setFooterHeight=n.setFooterHeight.bind(Object(p.a)(Object(p.a)(n))),n.setTransitionStatus=n.setTransitionStatus.bind(Object(p.a)(Object(p.a)(n))),n.labelsGotten=n.labelsGotten.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeaderHeight",value:function(t){this.setState({header_height:t})}},{key:"setFooterHeight",value:function(t){this.setState({footer_height:t})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(t,e){!0===this.state.loading_round&&t.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(t){1.5===t?(this.setState({transition_status:t,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:t})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var t=this.state,e=t.ww,n=t.wh,a=t.header_height,r=t.footer_height,s=t.loading_round,o=t.simulating_labeling,l=t.transition_status,c=this.props,d=c.dataset,u=c.strategy,h=c.round,p=c.datasets,g=c.strategies,m=c.selectDataset,b=c.selectStrategy,f=c.embeddings,y=c.requested_embedding,w=c.loaded_embedding,x=c.strategy_explored;return null===e?i.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):i.a.createElement("div",{style:{width:e,height:n,overflow:"hidden",position:"relative"}},i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",top:0,right:0,padding:10.5,zIndex:999,background:"red",display:"none"}},l),null!==r&&null!==a?i.a.createElement("div",{style:{background:"white",height:n}},i.a.createElement(B,{width:e,height:n,grem:21,strategies:g,strategy_colors:Q,strategy:u,embeddings:f,requested_embedding:y,loaded_embedding:w,loading_round:s,mnist_images:et,ranges:$,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:r,round:h,header_height:a,round_limit:7})):null,null!==r?i.a.createElement(J,{transition_status:this.state.transition_status,grem:21,footer_height:r,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:h}):null,i.a.createElement(v,{datasets:p,selectDataset:m,strategies:g,strategy:u,strategy_colors:Q,selectStrategy:b,dataset:d,activeStyle:_,setHeaderHeight:this.setHeaderHeight,gradient_string:at,grem:21,transition_status:this.state.transition_status}),null!==a?i.a.createElement(E,{round:h,ww:e,grem:21,strategies:g,strategy_colors:Q,strategy:u,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:at,color_array_hexes:nt,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:o,strategy_explored:x}):null,this.state.simulating_labeling?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center"}},i.a.createElement("div",{style:{width:Math.min(500,e),background:"#666",padding:21}},i.a.createElement("div",null,"Getting labels for 1,000 selected points..."),i.a.createElement(V,{grem:21,gradient_string:at,ww:e,labelsGotten:this.labelsGotten}))):null))}}]),e}(a.Component),rt=["MNIST","Quickdraw","Caltech"],st=["random","entropy","deepfool","ensemble"],ot=["mnist_random_round","mnist_entropy_round","mnist_deepfool_round","mnist_ensemble_entropy_round"];function lt(t,e,n){return"".concat(t,"-").concat(e,"-").concat(n)}var ct=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={embeddings:{},dataset:rt[0],strategy:st[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0},n.scaleEmbeddings=n.scaleEmbeddings.bind(Object(p.a)(Object(p.a)(n))),n.fetchData=n.fetchData.bind(Object(p.a)(Object(p.a)(n))),n.checkOrFetchData=n.checkOrFetchData.bind(Object(p.a)(Object(p.a)(n))),n.selectRound=n.selectRound.bind(Object(p.a)(Object(p.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"selectRound",value:function(t){var e=Math.max(this.state.strategy_explored,t);this.setState({round:t,strategy_explored:e}),this.checkOrFetchData(this.state.dataset,this.state.strategy,t)}},{key:"selectDataset",value:function(t){this.setState({dataset:rt[t],strategy_explored:0}),this.checkOrFetchData(rt[t],this.state.strategy,this.state.round)}},{key:"selectStrategy",value:function(t){this.setState({strategy:st[t]}),this.checkOrFetchData(this.state.dataset,st[t],this.state.round)}},{key:"checkOrFetchData",value:function(t,e,n){var a=this.state.embeddings,i=lt(t,e,n);this.setState({requested_embedding:i}),void 0!==a[i]?this.setState({loaded_embedding:i}):this.fetchData(t,e,n)}},{key:"scaleEmbeddings",value:function(t){var e=t.map(function(t){return Math.abs(t[0])}),n=t.map(function(t){return Math.abs(t[1])}),a=j.max(e),i=j.max(n),r=Math.max(a,i),s=M.b().domain([-r,r]).range([-20,20]);return t.map(function(t){return[s(t[0]),s(t[1])]})}},{key:"fetchData",value:function(t,e,n){var a=this,i="".concat("/activelearner","/").concat(ot[st.indexOf(e)]).concat(n,".json");fetch(i).then(function(t){return t.json()}).then(function(i){var r=i.coordinates,s=r.map(function(t){return Math.abs(t[0])}),o=r.map(function(t){return Math.abs(t[1])}),l=j.max(s),c=j.max(o),d=Math.max(l,c),u=M.b().domain([-d,d]).range([-20,20]),p=r.map(function(t){return[u(t[0]),u(t[1])]}),g={};g.coordinates=p,g.statuses=i.status,g.labels=i.labels;var m=lt(t,e,n);a.setState({loaded_embedding:m,embeddings:Object.assign({},a.state.embeddings,Object(h.a)({},m,g))})})}},{key:"componentDidMount",value:function(){var t=this.state,e=t.dataset,n=t.strategy,a=t.round;this.checkOrFetchData(e,n,a)}},{key:"render",value:function(){return i.a.createElement(it,Object.assign({},this.state,{datasets:rt,strategies:st,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this)}))}}]),e}(a.Component),dt=(n(28),function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement(ct,null)}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(dt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.1b3b1655.chunk.js.map