(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(t,e,n){t.exports=n(30)},25:function(t,e,n){},28:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(18),s=n.n(r),o=(n(25),n(3)),l=n(4),c=n(7),d=n(5),u=n(6),h=n(19),g=n(1),p=n(8),m=n(10),b=function(t){return"string"!==typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},v=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setHeaderHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.datasets,a=e.selectDataset,r=e.strategies,s=e.strategy,o=(e.strategy_colors,e.selectStrategy),l=e.dataset,c=(e.activeStyle,e.grem);return i.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px"),fontWeight:"bold"}},"Active Learner")),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Dataset:"),n.map(function(t,e){var n,r=t===l;return n=r?i.a.createElement("span",null,t):i.a.createElement("button",{onClick:function(){a(e)}},t),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Strategy:"),r.map(function(t,e){var n,a=t===s;return n=a?i.a.createElement("span",null,b(t)):i.a.createElement("button",{onClick:function(){o(e)}},b(t)),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:a?"white":"transparent",color:a?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})))}}]),e}(a.Component);function f(t){return Math.round(1e4*t)/100+"%"}function y(t,e,n,a){a?t.moveTo(e,n):t.lineTo(e,n)}function _(t){return{background:t,boxShadow:"-0.25em 0 0 ".concat(t,", 0.25em 0 0 ").concat(t),textDecoration:"none"}}var w={accuracy:[.953,.9664,.971,.9746,.9791,.9776,.979,.9805,.9795],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},O=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return i.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},i.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),e}(a.Component),x=n(11),j=(Object(p.a)(Array(4)).map(function(t){return Object(p.a)(Array(5)).map(function(t){return Math.random()})}),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).ctx=null,n.getCtx=n.getCtx.bind(Object(g.a)(Object(g.a)(n))),n.draw=n.draw.bind(Object(g.a)(Object(g.a)(n))),n.handleRound=n.handleRound.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"getCtx",value:function(t){this.ctx=t.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(t){this.props.strategy_explored!==t.strategy_explored&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(t){t!==this.props.round&&this.props.selectRound(t)}},{key:"draw",value:function(){var t=this.props,e=(t.width,t.height),n=(t.strategies,t.strategy_colors,t.round),a=(t.strategy,t.grem),i=t.transition_status,r=t.strategy_explored;e-=2*a,3===i&&(n+=1);var s=this.ctx,o=Math.floor(10*x.min(w.accuracy))/10,l=1-o;s.clearRect(0,0,100*(r+1),e);e-=24,s.fillStyle="rgba(100,100,100,0.3)",s.fillRect(100*n,12,100,e),s.lineWidth=3,s.strokeStyle="rgba(100,100,100,0.5)";for(var c=0;c<l+.05;c+=.05){s.beginPath();var d=c/l*e;y(s,0,d+12,!0),y(s,100*(r+1),d+12,!1),s.stroke()}s.lineWidth=3,s.strokeStyle="#efefef",s.fillStyle="#efefef",s.beginPath();for(var u=0;u<r+1;u++){y(s,100*u+50,e-(w.accuracy[u]-o)/(1-o)*e+12,0===u)}s.stroke();for(var h=0;h<r+1;h++){var g=(w.accuracy[h]-o)/(1-o);s.beginPath(),s.arc(100*h+50,e-g*e+12,6,0,2*Math.PI),s.fill()}}},{key:"render",value:function(){var t=this,e=this.props,n=(e.width,e.height),a=e.grem,r=(e.strategies,e.strategy,e.round),s=e.transition_status,o=(e.adjusted_round,e.strategy_explored),l=r;return s>1&&(l=r+1),i.a.createElement("div",{style:{}},i.a.createElement("div",{style:{display:"inline-flex",pointerEvents:"auto"}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("span",null,"Round ",r+1)," ")),i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Accuracy: ",f(w.accuracy[r])))),i.a.createElement("div",{style:{position:"relative",width:100*(o+1),height:n-2*a,pointerEvents:"auto"}},i.a.createElement(O,{width:100*(o+1),height:n-2*a,getCtx:this.getCtx,grem:a}),i.a.createElement(i.a.Fragment,null,Object(p.a)(Array(o+1)).map(function(e,s){return i.a.createElement("div",{onClick:function(){t.handleRound(s)},style:{position:"absolute",top:0,left:100*s,width:100,height:n-2*a,cursor:s===r?"default":"pointer"}})}))),i.a.createElement("div",{style:{display:"flex",pointerEvents:"auto",justifyContent:"space-between",padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"100,000 points, ",function(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}(w.num_labeled[l])," labelled (",f(w.num_labeled[l]/1e6),")")))}}]),e}(a.Component)),k=(Math.floor(10*Math.random()),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setFooterHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.round,a=e.ww,r=e.grem,s=e.strategies,o=e.strategy_colors,l=e.strategy,c=(e.selectRound,e.color_array_hexes,e.transition_status),d=(e.simulating_labeling,e.gradient_string,n),u=e.strategy_explored;return c>1&&c<2.3&&(d=Math.max(0,d-1),u=Math.max(0,u-1)),i.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",bottom:0,left:0,height:7*r,pointerEvents:"none"}},i.a.createElement(j,{width:a,transition_status:c,height:7*r,grem:r,strategies:s,selectRound:this.props.selectRound,strategy_colors:o,strategy:l,round:d,strategy_explored:u}))}}]),e}(a.Component)),E=n(14),S=n(2),C=n(12),M=n(9);var A=Object(p.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")});(new S.i).load("".concat("","/circle.png")).flipY=!1;for(var D=[],F=0;F<12;F++){var T=5329*F,H=5329*(F+1);11===F&&(H=63948),D.push([T,H])}var z=10,P=Object(p.a)(Array(z)).map(function(t,e){return m.hsl(0+360/z*e,1,.5).luminance(.5).gl()});P.push(m.hsl(0,0,.5).luminance(.1).gl()),z=10;var R=Object(p.a)(Array(z)).map(function(t,e){return m.hsl(0+360/z*e,1,.5).luminance(.5).hex()}),U=P.map(function(t){return t.slice(0,3)});function W(t,e){return{coordinates:t.coordinates.slice(e[0],e[1]),labels:t.labels.slice(e[0],e[1]),statuses:t.statuses.slice(e[0],e[1])}}function L(t){for(var e=[],n=0;n<t.length;n++){var a=t[n];e.push(a[0],a[1],0)}return new Float32Array(e)}for(var G=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={},n.init=n.init.bind(Object(g.a)(Object(g.a)(n))),n.animate=n.animate.bind(Object(g.a)(Object(g.a)(n))),n.addPoints=n.addPoints.bind(Object(g.a)(Object(g.a)(n))),n.transitionPoints=n.transitionPoints.bind(Object(g.a)(Object(g.a)(n))),n.addSelectedPoints=n.addSelectedPoints.bind(Object(g.a)(Object(g.a)(n))),n.labelSelected=n.labelSelected.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"getZFromScale",value:function(t){var e=S.d.degToRad(this.camera.fov);return this.props.height/t/(2*Math.tan(e/2))}},{key:"getScaleFromZ",value:function(t){var e=S.d.degToRad(this.camera.fov),n=2*(Math.tan(e/2)*t);return this.props.height/n}},{key:"zoomHandler",value:function(){var t=C.a.transform,e=t.k,n=-(t.x-this.props.width/2)/e,a=(t.y-this.props.height/2)/e,i=this.getZFromScale(e);this.camera.position.set(n,a,i)}},{key:"addPoints",value:function(){var t=this.props,e=t.loaded_embedding,n=t.embeddings;this.scene.children[0]=new S.c;for(var a=n[e],i=D.map(function(t){return W(a,t)}),r=new S.c,s=i.length,o=0;o<s;o++){for(var l=i[o],c=l.coordinates.length,d=new S.b,u=L(l.coordinates),h=new Float32Array(2*c),g=0,p=0,m=c;g<m;g++,p+=2){var b=g%73*28/2048,v=28*Math.floor(g/73)/2048;h[p]=b,h[p+1]=v}var f=l.labels.map(function(t){return U[t]}),y=x.flatten(f),_=new Float32Array(y),w=this.textures[o],O=[1/73,1/73];d.addAttribute("position",new S.a(u,3)),d.addAttribute("offset",new S.a(h,2)),d.addAttribute("color",new S.a(_,3));var j={texture:{value:w},repeat:{value:Object(E.a)(S.j,O)},size:{value:20}},k=new S.h({uniforms:j,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),C=new S.f(d,k);r.add(C)}this.scene.children[0]=r}},{key:"transitionPoints",value:function(t,e){for(var n=this,a=this.scene.children[0],i=this.scene.children[1].children,r=e[t],s=D.map(function(t){return W(r,t)}),o=s.length,l=function(t){var e=a.children[t],r=s[t],o=e.geometry.attributes.position.array.slice(),l=L(r.coordinates),c=new M.Tween(o).to(l,800).easing(M.Easing.Linear.None);c.onUpdate(function(){e.geometry.attributes.position.array=o,e.geometry.attributes.position.needsUpdate=!0}),c.start();var d=i[t],u=Array.from(d.geometry.attributes.indexes.array),h=d.geometry.attributes.position.array.slice(),g=L(u.map(function(t){return r.coordinates[t]})),p=new Float32Array(g),m={value:30},b=n,v=new M.Tween(m).to({value:0},400).easing(M.Easing.Linear.None).delay(400).onComplete(function(){0===t&&(b.addSelectedPoints(),b.props.setTransitionStatus(0))});v.onUpdate(function(){d.material.uniforms.size=m});var f=new M.Tween(h).to(p,800).easing(M.Easing.Linear.None);f.onUpdate(function(){d.geometry.attributes.position.array=h,d.geometry.attributes.position.needsUpdate=!0}),f.onComplete(function(){0===t&&setTimeout(function(){b.addPoints(),d.material.uniforms.size.value>0?b.props.setTransitionStatus(2.6):(b.addSelectedPoints(),b.props.setTransitionStatus(0))},0)}),d.material.uniforms.size.value>0&&f.chain(v),f.start()},c=0;c<o;c++)l(c)}},{key:"addSelectedPoints",value:function(){var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings;this.scene.children[1]=new S.c;for(var i=a[n],r=D.map(function(t){return W(i,t)}),s=new S.c,o=r.length,l=function(e){for(var n=r[e],a=[],i=0;i<n.statuses.length;i++)1===n.statuses[i]&&a.push(i);for(var o=new Float32Array(a),l=a.length,c=new S.b,d=L(a.map(function(t){return n.coordinates[t]})),u=new Float32Array(2*l),h=0,g=0,p=l;h<p;h++,g+=2){var m=a[h],b=m%73*28/2048,v=28*Math.floor(m/73)/2048;u[g]=b,u[g+1]=v}var f=a.map(function(t){return[1,1,1]}),y=x.flatten(f),_=new Float32Array(y),w=t.textures[e],O=[1/73,1/73];c.addAttribute("position",new S.a(d,3)),c.addAttribute("offset",new S.a(u,2)),c.addAttribute("color",new S.a(_,3)),c.addAttribute("indexes",new S.a(o,1));var j={texture:{value:w},repeat:{value:Object(E.a)(S.j,O)},size:{value:0}},k=new S.h({uniforms:j,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),C=new S.f(c,k);s.add(C)},c=0;c<o;c++)l(c);this.scene.children[1]=s}},{key:"revealSelected",value:function(){for(var t=this,e={value:0},n={value:30},a=this.scene.children[1].children,i=function(i){var r=a[i],s=new M.Tween(e).to(n,400).easing(M.Easing.Linear.None);s.onUpdate(function(){r.material.uniforms.size=e});var o=t;s.onComplete(function(){0===i&&o.props.setTransitionStatus(1)}),s.start()},r=0;r<a.length;r++)i(r)}},{key:"labelSelected",value:function(){var t=this.props,e=t.loaded_embedding,n=t.embeddings;console.log(e);for(var a=n[e],i=D.map(function(t){return W(a,t)}),r=this.scene.children[1].children,s=function(t){var e=i[t],n=r[t],a=Array.from(n.geometry.attributes.indexes.array),s=r[t].geometry.attributes.color.array.slice(),o=a.map(function(t){var n=e.labels[t];return U[n]}),l=x.flatten(o),c=new Float32Array(l),d=new M.Tween(s).to(c,400).easing(M.Easing.Linear.None),u=r[t];d.onUpdate(function(){u.geometry.attributes.color.array=s,u.geometry.attributes.color.needsUpdate=!0}),d.start()},o=0;o<i.length;o++)s(o)}},{key:"componentDidUpdate",value:function(t){var e=this;null===t.loaded_embedding&&null!==this.props.loaded_embedding?Promise.all(function(t){var e=new S.i;return t.map(function(t){return new Promise(function(n,a){e.load(t,function(t){t.flipY=!1,n(t)},void 0,function(t){return a(t)})})})}(A)).then(function(t){e.textures=t,e.addPoints(),e.addSelectedPoints()}):.5===this.props.transition_status&&0===t.transition_status?this.revealSelected():2===this.props.transition_status&&1.5===t.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===t.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):this.props.round!==t.round&&1.5!==this.props.transition_status?(console.log("new round"),this.transitionPoints(this.props.loaded_embedding,this.props.embeddings)):(this.props.strategy,t.strategy)}},{key:"init",value:function(){var t=this.props,e=t.width,n=t.height;this.scene=new S.g;var a=e/n;this.camera=new S.e(75,a,.01,1e3),this.camera.position.z=30,this.renderer=new S.k,this.renderer.setClearColor(1118481,1),this.renderer.setSize(e,n),this.mount.appendChild(this.renderer.domElement);var i=new S.c;this.scene.add(i);var r=new S.c;this.scene.add(r),this.d3_zoom=C.d().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var s=C.c(this.mount);this.view=s,s.call(this.d3_zoom);var o=this.getScaleFromZ(this.camera.position.z),l=C.e.translate(e/2,n/2).scale(o);this.d3_zoom.transform(s,l),this.animate()}},{key:"animate",value:function(){requestAnimationFrame(this.animate),M.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,a=e.height,r=e.grem;return i.a.createElement("div",{style:{position:"absolute",left:0,width:n,height:a,background:"#222",overflow:"hidden"},grem:r},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:n,height:a},ref:function(e){t.mount=e}}),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"auto",padding:"0 ".concat(r/4,"px"),position:"absolute",left:0,bottom:this.props.footer_height+r}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Labels:"),i.a.createElement("div",{style:{background:"#888",color:"#111",width:r,height:r,textAlign:"center"}},"?"),R.map(function(t,e){return i.a.createElement("div",{style:{background:R[e],height:r,textAlign:"center",color:"#111",width:r}},e)})))}}]),e}(a.Component),q=(Object(p.a)(Array(40)).map(function(t){return null}),Object(p.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")})),I=Object(p.a)(Array(10)).map(function(t,e){return m.hsl(0+36*e,1,.5).luminance(.5).hex()}),N=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={labels:null,prev_loaded:null},n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidUpdate",value:function(t){var e=this,n=this.props.embeddings;if(this.props.loaded_embedding!==t.loaded_embedding)if(null===t.loaded_embedding)this.setState({prev_loaded:this.props.loaded_embedding});else{for(var a=n[t.loaded_embedding],i=[],r=0;r<a.statuses.length;r++)1===a.statuses[r]&&i.push(r);var s=n[this.props.loaded_embedding],o=i.map(function(t,e){return s.labels[t]});this.setState({labels:o})}if(0===this.props.transition_status&&0!==t.transition_status){var l=this;setTimeout(function(){l.setState({prev_loaded:e.props.loaded_embedding,labels:null})},800)}}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,a=e.height,r=e.grem,s=e.embeddings,o=e.loaded_embedding,l=e.transition_status,c=e.header_height,d=[],u=s[this.state.prev_loaded];if(u)for(var h=0;h<u.statuses.length;h++)1===u.statuses[h]&&d.push(h);var g=r/4,p=r/4,m=(n-2*p*2-3*g)/4,b=m,v=d.map(function(t){var e=t%5329;return[Math.floor(t/5329),e%73,Math.floor(e/73)]});null!==o&&d.map(function(t,e){return s[o].labels[e]});var f=m/28;return i.a.createElement("div",{style:{position:"absolute",right:0,top:c,width:n,height:a,background:"#333",overflow:"hidden"}},0===l?i.a.createElement("div",{style:{padding:r/4}},i.a.createElement("div",{style:{padding:r/4}},"Use the select data button below to select data points based on the strategy.")):null,i.a.createElement("div",{style:{opacity:0===l||2.6===l?0:1,transition:"opacity 0.4s linear",padding:r/2,position:"relative"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",position:"absolute",left:0,top:0,width:n,background:"#444",padding:"".concat(r/4,"px ").concat(r/2,"px")}},i.a.createElement("div",null,"Selected:"),i.a.createElement("div",null,"1,000")),i.a.createElement("div",{style:{right:0,top:c,width:n,height:a-r/2,paddingTop:1*r,background:"#333",overflow:"auto"}},i.a.createElement("div",{style:{display:"grid",paddingTop:2*p,paddingBottom:2*p,gridTemplateColumns:"repeat(".concat(4,", ").concat(m,"px)"),gridColumnGap:g,gridRowGap:2*g}},v.length>0?v.map(function(e,n){var a=null!==t.state.labels&&t.props.transition_status>1.5?t.state.labels[n]:"?",s=null!==t.state.labels&&t.props.transition_status>1.5?I[t.state.labels[n]]:"#bbb";return i.a.createElement("div",{style:{width:m,height:b+r,background:s,color:"#111",textAlign:"center",transition:"background 400ms linear"}},i.a.createElement("div",{style:{backgroundImage:"url(".concat(q[e[0]],")"),backgroundSize:"".concat(2048*f,"px ").concat(2048*f,"px"),backgroundPosition:"-".concat(e[1]*f*28,"px -").concat(e[2]*f*28,"px"),width:m,height:b,imageRendering:"pixelated"}}),i.a.createElement("div",null,a))}):null))))}}]),e}(a.Component),Z=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,a=t.grem,r=t.strategies,s=t.strategy_colors,o=t.strategy,l=t.active_embedding,c=t.requested_embedding,d=t.loaded_embedding,u=t.embeddings,h=t.mnist_images,g=t.ranges,p=t.transition_status,m=t.setTransitionStatus,b=t.loading_round,v=t.header_height,f=t.footer_height,y=t.round;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(G,{width:e,height:n,grem:a,active_embedding:l,strategies:r,strategy_colors:s,strategy:o,embeddings:u,requested_embedding:c,loaded_embedding:d,transition_status:p,setTransitionStatus:m,loading_round:b,footer_height:f,round:y}),i.a.createElement(N,{width:200,height:n-this.props.footer_height-2*a-v,grem:a,mnist_images:h,embeddings:u,loaded_embedding:d,ranges:g,transition_status:p,header_height:v}))}}]),e}(a.Component),B=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t,e,n=this,a=this.props,r=a.transition_status,s=a.grem,o=a.round_limit,l=a.round;0===r?(t="Select data",e=.5):.5===r?(t="Selecting...",e=null):1===r?(t="Get labels",e=1.5):1.5===r?(t="Labeling...",e=null):2===r?(t="Retrain model",e=2.3):2.3===r?(t="Retraining...",e=null):2.6===r&&(t="Deselecting...",e=null);var c=l;return r>1&&r<2.3&&(c=Math.max(0,c-1)),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",background:"#111",position:"absolute",bottom:this.props.footer_height,right:0}},i.a.createElement("div",null,o!==c?i.a.createElement("button",{style:{width:200,height:2*s,background:null===e?"#eee":"white",color:"black",textAlign:"left",paddingLeft:s/2,cursor:null===e?"default":"pointer",textDecoration:null===e?"none":"underline"},disabled:null===e,onClick:function(){null!==e&&n.props.setTransitionStatus(e)}},t):null))}}]),e}(a.Component),J=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={count:0},n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=0,e=0,n=this;function a(){t+=25;var i=Math.floor(t);i!==e&&(e=i),n.setState({count:e}),e<1e3?requestAnimationFrame(a):setTimeout(function(){n.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(a)},200)}},{key:"render",value:function(){var t=this.props,e=t.grem,n=t.ww;return i.a.createElement("div",null,i.a.createElement("div",{style:{height:e,width:"".concat(100,"%"),marginTop:e/2,background:"#222"}},i.a.createElement("div",{style:{height:e,width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},i.a.createElement("div",{style:{height:e,width:Math.min(500,n)-2*e,background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),e}(a.Component),V=4,Y=Object(p.a)(Array(V)).map(function(t,e){return m.hsl(90/V*e-45,1,.5).luminance(.5).hex()}),Q=[],$=0;$<12;$++){var K=5329*$,X=5329*($+1);11===$&&(X=63948),Q.push([K,X])}var tt=Object(p.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")}).map(function(t){var e=document.createElement("img");return e.src=t,e});V=10;var et=Object(p.a)(Array(V)).map(function(t,e){return m.hsl(0+360/V*e,1,.5).luminance(.5).hex()}),nt=et.reduce(function(t,e,n){return t+e+" "+Math.round(n/V*100)+(n===V-1?"%":"%, ")},""),at=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1},n.setSize=n.setSize.bind(Object(g.a)(Object(g.a)(n))),n.setHeaderHeight=n.setHeaderHeight.bind(Object(g.a)(Object(g.a)(n))),n.setFooterHeight=n.setFooterHeight.bind(Object(g.a)(Object(g.a)(n))),n.setTransitionStatus=n.setTransitionStatus.bind(Object(g.a)(Object(g.a)(n))),n.labelsGotten=n.labelsGotten.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"setHeaderHeight",value:function(t){this.setState({header_height:t})}},{key:"setFooterHeight",value:function(t){this.setState({footer_height:t})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(t,e){!0===this.state.loading_round&&t.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(t){1.5===t?(this.setState({transition_status:t,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:t})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var t=this.state,e=t.ww,n=t.wh,a=t.header_height,r=t.footer_height,s=t.loading_round,o=t.simulating_labeling,l=t.transition_status,c=this.props,d=c.dataset,u=c.strategy,h=c.round,g=c.datasets,p=c.strategies,m=c.selectDataset,b=c.selectStrategy,f=c.embeddings,y=c.requested_embedding,w=c.loaded_embedding,O=c.strategy_explored;return null===e?i.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):i.a.createElement("div",{style:{width:e,height:n,overflow:"hidden",position:"relative"}},i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",top:0,right:0,background:"red",padding:10.5,zIndex:999}},l),null!==r&&null!==a?i.a.createElement("div",{style:{background:"white",height:n}},i.a.createElement(Z,{width:e,height:n,grem:21,strategies:p,strategy_colors:Y,strategy:u,embeddings:f,requested_embedding:y,loaded_embedding:w,loading_round:s,mnist_images:tt,ranges:Q,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:r,round:h,header_height:a})):null,null!==r?i.a.createElement(B,{transition_status:this.state.transition_status,grem:21,footer_height:r,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:h}):null,i.a.createElement(v,{datasets:g,selectDataset:m,strategies:p,strategy:u,strategy_colors:Y,selectStrategy:b,dataset:d,activeStyle:_,setHeaderHeight:this.setHeaderHeight,gradient_string:nt,grem:21,transition_status:this.state.transition_status}),null!==a?i.a.createElement(k,{round:h,ww:e,grem:21,strategies:p,strategy_colors:Y,strategy:u,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:nt,color_array_hexes:et,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:o,strategy_explored:O}):null,this.state.simulating_labeling?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center"}},i.a.createElement("div",{style:{width:Math.min(500,e),background:"#666",padding:21}},i.a.createElement("div",null,"Getting labels for 1,000 selected points..."),i.a.createElement(J,{grem:21,gradient_string:nt,ww:e,labelsGotten:this.labelsGotten}))):null))}}]),e}(a.Component),it=["MNIST","Quickdraw","Caltech"],rt=["random","entropy","dropout","ensemble"];function st(t,e,n){return"".concat(t,"-").concat(e,"-").concat(n)}var ot=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(c.a)(this,Object(d.a)(e).call(this,t))).state={embeddings:{},dataset:it[0],strategy:rt[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0},n.scaleEmbeddings=n.scaleEmbeddings.bind(Object(g.a)(Object(g.a)(n))),n.fetchData=n.fetchData.bind(Object(g.a)(Object(g.a)(n))),n.checkOrFetchData=n.checkOrFetchData.bind(Object(g.a)(Object(g.a)(n))),n.selectRound=n.selectRound.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(e,t),Object(l.a)(e,[{key:"selectRound",value:function(t){var e=Math.max(this.state.strategy_explored,t);this.setState({round:t,strategy_explored:e}),this.checkOrFetchData(this.state.dataset,this.state.strategy,t)}},{key:"selectDataset",value:function(t){this.setState({dataset:it[t]}),this.checkOrFetchData(it[t],this.state.strategy,this.state.round)}},{key:"selectStrategy",value:function(t){this.setState({strategy:rt[t],strategy_explored:0}),this.checkOrFetchData(this.state.dataset,rt[t],this.state.round)}},{key:"checkOrFetchData",value:function(t,e,n){var a=this.state.embeddings,i=st(t,e,n);this.setState({requested_embedding:i}),void 0!==a[i]?this.setState({loaded_embedding:i}):this.fetchData(t,e,n)}},{key:"scaleEmbeddings",value:function(t){var e=t.map(function(t){return Math.abs(t[0])}),n=t.map(function(t){return Math.abs(t[1])}),a=x.max(e),i=x.max(n),r=Math.max(a,i),s=C.b().domain([-r,r]).range([-20,20]);return t.map(function(t){return[s(t[0]),s(t[1])]})}},{key:"fetchData",value:function(t,e,n){var a=this,i="".concat("","/mnist_entropy_round").concat(n,".json");fetch(i).then(function(t){return t.json()}).then(function(i){var r=i.coordinates,s=r.map(function(t){return Math.abs(t[0])}),o=r.map(function(t){return Math.abs(t[1])}),l=x.max(s),c=x.max(o),d=Math.max(l,c),u=C.b().domain([-d,d]).range([-20,20]),g=r.map(function(t){return[u(t[0]),u(t[1])]}),p={};p.coordinates=g,p.statuses=i.status,p.labels=i.labels;var m=st(t,e,n);a.setState({loaded_embedding:m,embeddings:Object.assign({},a.state.embeddings,Object(h.a)({},m,p))})})}},{key:"componentDidMount",value:function(){var t=this.state,e=t.dataset,n=t.strategy,a=t.round;this.checkOrFetchData(e,n,a)}},{key:"render",value:function(){return i.a.createElement(at,Object.assign({},this.state,{datasets:it,strategies:rt,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this)}))}}]),e}(a.Component),lt=(n(28),function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement(ot,null)}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(lt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.325891aa.chunk.js.map