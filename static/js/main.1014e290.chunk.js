(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(31)},26:function(e,t,a){},29:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(20),s=a.n(r),o=(a(26),a(3)),c=a(4),l=a(7),d=a(5),u=a(6),h=a(1),p=a(8),g=a(9),m=a(13),b=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},v=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={},a.setHeight=a.setHeight.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setHeaderHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"handleStrategy",value:function(e){this.props.selectStrategy(e),this.props.setTransitionStatus(0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.datasets,n=t.selectDataset,r=t.strategies,s=t.strategy,o=(t.strategy_colors,t.selectStrategy,t.dataset),c=(t.activeStyle,t.grem);return i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px 0 ").concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px"),fontWeight:"bold"}},"Active Learner")),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Dataset:"),a.map(function(e,t){var a,r=e===o;return a=r?i.a.createElement("span",null,e):i.a.createElement("button",{onClick:function(){n(t)}},e),i.a.createElement("span",{key:e,style:{padding:"0 ".concat(c/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},a)}).reduce(function(e,t){return[e," ",t]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Strategy:"),r.map(function(t,a){var n,r=t===s;return n=r?i.a.createElement("span",null,b(t)):i.a.createElement("button",{onClick:e.handleStrategy.bind(e,a)},b(t)),i.a.createElement("span",{key:t,style:{padding:"0 ".concat(c/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},n)}).reduce(function(e,t){return[e," ",t]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/2,"px"),pointerEvents:"all"}},i.a.createElement("button",{onClick:function(){e.props.toggleModal(!0)}},"? Info")))}}]),t}(n.Component);function f(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function y(e){return Math.round(1e4*e)/100+"%"}function _(e,t,a,n){n?e.moveTo(t,a):e.lineTo(t,a)}function w(e){return{background:e,boxShadow:"-0.25em 0 0 ".concat(e,", 0.25em 0 0 ").concat(e),textDecoration:"none"}}function x(e){var t=e.split("-");return{dataset:t[0],strategy:t[1],round:t[2]}}var k={MNIST:[0,1,2,3,4,5,6,7,8,9],Quickdraw:["dolphin","cat","face","angel","airplane","apple","broccoli","crayon","bicycle","elephant"],Caltech:["cake","dolphin","elephant","golden gate bridge","goldfish","rainbow","teapot","teddy bear","washing machine","waterfall"]},E=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return i.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},i.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),t}(n.Component),O=a(10),j={MNIST:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.923,.9468,.9379,.9551,.9558,.955,.958,.9664,.9635]},entropy:{accuracy:[.923,.9485,.9589,.96,.9744,.9702,.9774,.9764,.9782]},adversarial:{accuracy:[.923,.9534,.9558,.9691,.9743,.9716,.9775,.9801,.9795]},ensemble:{accuracy:[.923,.9554,.967,.9731,.9748,.979,.9812,.9848,.9829]}},Quickdraw:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.7685568264784619,.8011681674373327,.7949622779265028,.8040885860306644,.8141275249452421,.823192990995376,.8260525675346799,.831284984181066,.8297639328303723]},entropy:{accuracy:[.7685568264784619,.7963008031151132,.7894256510099781,.8050012168410805,.8212460452664881,.8202725724020443,.8123631053784376,.8289729861280117,.8267826721830129]},adversarial:{accuracy:[.7685568264784619,.805609637381358,.8077999513263567,.8172913117546848,.8289729861280117,.8298856169384279,.8343270868824532,.8541615964954977,.8440009734728644]},ensemble:{accuracy:[.7685568264784619,.8283037235337065,.8426624482842541,.83603066439523,.8523971769286931,.8506935994159163,.8619493794110489,.8623752737892432,.8586639084935508]}},Caltech:{num_labeled:[300,350,400,450,500,550,600,650,700],random:{accuracy:[.7547169811320755,.7971698113207547,.8490566037735849,.8632075471698113,.8490566037735849,.8726415094339622,.8915094339622641,.8584905660377359,.910377358490566]},entropy:{accuracy:[.7547169811320755,.8349056603773585,.8066037735849056,.8490566037735849,.8632075471698113,.8773584905660378,.8773584905660378,.9056603773584906,.8726415094339622]},adversarial:{accuracy:[.7547169811320755,.7971698113207547,.8537735849056604,.8867924528301887,.8679245283018868,.8726415094339622,.8773584905660378,.8584905660377359,.9056603773584906]},ensemble:{accuracy:[.7547169811320755,.9339622641509434,.9339622641509434,.9292452830188679,.9339622641509434,.9481132075471698,.9292452830188679,.9339622641509434,.9245283018867925]}}},S={MNIST:6e4,Quickdraw:65729,Caltech:822},C=(Object(p.a)(Array(4)).map(function(e){return Object(p.a)(Array(5)).map(function(e){return Math.random()})}),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={show_tip:null},a.ctx=null,a.getCtx=a.getCtx.bind(Object(h.a)(Object(h.a)(a))),a.draw=a.draw.bind(Object(h.a)(Object(h.a)(a))),a.handleRound=a.handleRound.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getCtx",value:function(e){this.ctx=e.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(e){(this.props.strategy_explored!==e.strategy_explored||this.props.width<800&&this.props.width!==e.width||this.props.width>800&&e.width<800)&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(e){e!==this.props.round&&this.props.selectRound(e)}},{key:"handleEnter",value:function(e){this.setState({show_tip:e})}},{key:"handleLeave",value:function(){this.setState({show_tip:null})}},{key:"draw",value:function(){var e=this.props,t=e.width,a=e.height,n=e.strategies,i=(e.strategy_colors,e.round),r=e.strategy,s=e.grem,o=e.transition_status,c=e.strategy_explored,l=e.dataset,d=j[l],u=d[r];a-=2*s,3===o&&(i+=1);var h=this.ctx,p=4,g=100,m=(g=Math.min(t/8,g))/2,b=n.map(function(e){return O.min(d[e].accuracy)}),v=Math.floor(10*O.min(b))/10,f=1-v;h.clearRect(0,0,g*(c+1),a);var y=2*p;a-=2*y,h.fillStyle="rgba(100,100,100,0.3)",h.fillRect(i*g,y,g,a),h.lineWidth=3,h.strokeStyle="rgba(100,100,100,0.5)";for(var w=0;w<f+.05;w+=.05){h.beginPath();var x=w/f*a;_(h,0,x+y,!0),_(h,g*(c+1),x+y,!1),h.stroke()}var k=n.filter(function(e){return e!==r}),E=!0,S=!1,C=void 0;try{for(var M,T=k[Symbol.iterator]();!(E=(M=T.next()).done);E=!0){var A=M.value,z=d[A];h.lineWidth=2,h.strokeStyle="#666",h.fillStyle="#666",h.beginPath();for(var I=0;I<c+1;I++){_(h,I*g+m,a-(z.accuracy[I]-v)/(1-v)*a+y,0===I)}h.stroke();for(var H=0;H<c+1;H++){var D=(z.accuracy[H]-v)/(1-v);h.beginPath(),h.arc(H*g+m,a-D*a+y,p,0,2*Math.PI),h.fill()}}}catch(L){S=!0,C=L}finally{try{E||null==T.return||T.return()}finally{if(S)throw C}}p=6,h.lineWidth=2,h.strokeStyle="#efefef",h.fillStyle="#efefef",h.beginPath();for(var F=0;F<c+1;F++){_(h,F*g+m,a-(u.accuracy[F]-v)/(1-v)*a+y,0===F)}h.stroke();for(var R=0;R<c+1;R++){var P=(u.accuracy[R]-v)/(1-v);h.beginPath(),h.arc(R*g+m,a-P*a+y,p,0,2*Math.PI),h.fill()}}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,r=t.grem,s=t.strategies,o=t.strategy,c=t.round,l=t.transition_status,d=(t.adjusted_round,t.strategy_explored),u=t.round_limit,h=t.dataset,m=this.state.show_tip,b=j[h].num_labeled,v=j[h][o],_=c,w=100;w=Math.min(a/8,w),l>1&&(_=c+1),_=c;var x=j[h];return i.a.createElement("div",{style:{pointerEvents:"none"}},i.a.createElement("div",{style:{display:"inline-flex"}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},i.a.createElement("span",null,"Round ",c+1," of ",u+1)," ")),i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Accuracy: ",(100*v.accuracy[c]).toFixed(2),"% (",1===Math.sign(v.accuracy[c]-v.accuracy[0])?"+":"",y(v.accuracy[c]-v.accuracy[0]),")")),i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px"),display:"none"}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Relative Error Reduction: ".concat((100*(1-(1-v.accuracy[c])/(1-v.accuracy[0]))).toFixed(2)),"%"))),i.a.createElement("div",{style:{position:"relative",width:w*(d+1),height:n-2*r,pointerEvents:"auto"}},i.a.createElement(E,{width:w*(d+1),height:n-2*r,getCtx:this.getCtx,grem:r}),i.a.createElement(i.a.Fragment,null,Object(p.a)(Array(d+1)).map(function(t,a){var l=s.map(function(e,t){return{string:"".concat(e,": ").concat(y(x[e].accuracy[a])),strategy:e,value:x[e].accuracy[a],diff:x[e].accuracy[a]-x[e].accuracy[0]}});return l=O.sortBy(l,"value").reverse(),i.a.createElement("div",{key:"explored"+a,onMouseEnter:e.handleEnter.bind(e,a),onMouseLeave:e.handleLeave.bind(e),onClick:function(){e.handleRound(a)},style:{position:"absolute",top:0,left:w*a,width:w,height:n-2*r,cursor:a===c?"default":"pointer"}},m===a?i.a.createElement("div",{style:{position:"absolute",left:0,bottom:n-2*r,background:"#333",padding:"".concat(r/2,"px ").concat(r/2,"px"),whiteSpace:"nowrap",pointerEvents:"none",fontSize:r/1.5*1}},i.a.createElement("div",{style:{color:"#fff",marginBottom:r/4}},"Round ",a+1),l.map(function(e,t){return i.a.createElement("div",{key:e.strategy,style:{textTransform:"capitalize",color:o===e.strategy?"#fff":"#aaa",display:"flex",marginBottom:r/8}},i.a.createElement("div",{style:{marginRight:r/4}},t+1,". ",e.strategy,":"),i.a.createElement("div",{style:{textAlign:"right",flexGrow:1}},(100*e.value).toFixed(2),"% (",1===Math.sign(e.diff)?"+":"",(100*e.diff).toFixed(2),"%)"))})):null)}),i.a.createElement("div",{style:Object(g.a)({position:"absolute",top:8,left:w*(d+1),width:(u-d)*w,height:n-2*r-16,border:"solid 2px rgba(100,100,100,0.2)",pointerEvents:"auto",borderLeft:"none"},"pointerEvents","none")}))),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"0 ".concat(r/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},f(S[this.props.dataset])," points,"," ",f(b[_])," labeled (",y(b[_]/S[this.props.dataset]),")")))}}]),t}(n.Component)),M=(Math.floor(10*Math.random()),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={},a.setHeight=a.setHeight.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setFooterHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this,t=this.props,a=t.round,n=t.ww,r=t.grem,s=t.strategies,o=t.strategy_colors,c=t.strategy,l=(t.selectRound,t.color_array_hexes,t.transition_status),d=(t.simulating_labeling,t.gradient_string,t.strategy_explored),u=t.round_limit,h=t.dataset,p=a,g=d;return l>1&&l<2.3&&(p=Math.max(0,p-1)),i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",bottom:null!==this.props.key_height?this.props.key_height+r/2:2*r,left:0,height:7*r,pointerEvents:"none"}},i.a.createElement(C,{width:n,transition_status:l,height:7*r,grem:r,strategies:s,selectRound:this.props.selectRound,dataset:h,strategy_colors:o,strategy:c,round:p,strategy_explored:g,round_limit:u}))}}]),t}(n.Component)),T=a(15),A=a(16),z=a(2),I=a(11),H=a(12);function D(e){var t=new z.j;return e.map(function(e){return new Promise(function(a,n){t.load(e,function(e){e.flipY=!1,a(e)},void 0,function(e){return n(e)})})})}var F={sprite_side:73,sprite_size:5329,sprite_number:12,sprite_image_size:28},R=Object.assign({},F,{sprite_number:13}),P=Object.assign({},F,{sprite_side:9,sprite_size:81,sprite_number:11,sprite_image_size:224}),L={MNIST:F,Quickdraw:R,Caltech:P},W={MNIST:30,Quickdraw:30,Caltech:30},N=(new z.j,Object(p.a)(Array(F.sprite_number)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")})),U=Object(p.a)(Array(R.sprite_number)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")}),B={MNIST:N,Quickdraw:U,Caltech:Object(p.a)(Array(P.sprite_number)).map(function(e,t){return"".concat("","/").concat("CALTECH_").concat(t,".png")})};function Q(e){for(var t=[],a=L[e],n=a.sprite_number,i=a.sprite_size,r=0;r<n;r++){var s=r*i,o=(r+1)*i;r===n-1&&(o=n*i),t.push([s,o])}return t}function q(e){var t=k[e].length,a=Object(p.a)(Array(t)).map(function(e,a){return m.hsl(0+360/t*a,1,.5).luminance(.5).gl()});a.push(m.hsl(0,0,.5).luminance(.1).gl());var n=Object(p.a)(Array(t)).map(function(e,a){return m.hsl(0+360/t*a,1,.5).luminance(.5).hex()}),i=a.map(function(e){return e.slice(0,3)});return{color_array:a,color_array_hexes:n,status_to_color:i}}function K(e,t){return{coordinates:e.coordinates.slice(t[0],t[1]),labels:e.labels.slice(t[0],t[1]),statuses:e.statuses.slice(t[0],t[1])}}function G(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];t.push(n[0],n[1],0)}return new Float32Array(t)}for(var Z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={color_array:null,color_array_hexes:null,status_to_color:null,initialized:!1},a.init=a.init.bind(Object(h.a)(Object(h.a)(a))),a.animate=a.animate.bind(Object(h.a)(Object(h.a)(a))),a.addPoints=a.addPoints.bind(Object(h.a)(Object(h.a)(a))),a.transitionPoints=a.transitionPoints.bind(Object(h.a)(Object(h.a)(a))),a.addSelectedPoints=a.addSelectedPoints.bind(Object(h.a)(Object(h.a)(a))),a.labelSelected=a.labelSelected.bind(Object(h.a)(Object(h.a)(a))),a.showHover=a.showHover.bind(Object(h.a)(Object(h.a)(a))),a.hover_ctx=null,a.resetCamera=a.resetCamera.bind(Object(h.a)(Object(h.a)(a))),a.prev_d3_x=null,a.prev_d3_y=null,a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getZFromScale",value:function(e){var t=z.d.degToRad(this.camera.fov);return this.props.height/e/(2*Math.tan(t/2))}},{key:"getScaleFromZ",value:function(e){var t=z.d.degToRad(this.camera.fov),a=2*(Math.tan(t/2)*e);return this.props.height/a}},{key:"zoomHandler",value:function(){var e=I.a.transform,t=e.k,a=-(e.x-this.props.width/2)/t,n=(e.y-this.props.height/2)/t,i=this.getZFromScale(t);if(I.a.transform.k===this.getScaleFromZ(this.camera.position.z)&&null!==this.prev_d3_x){var r=e.x-this.prev_d3_x,s=e.y-this.prev_d3_y,o=this.hover_mount.style.transform.split(","),c=parseInt(o[0].split("(")[1]),l=parseInt(o[1]);this.hover_mount.style.transform="translate3d(".concat(c+r,"px, ").concat(l+s,"px, 0)")}this.prev_d3_x=e.x,this.prev_d3_y=e.y,this.camera.position.set(a,n,i)}},{key:"addPoints",value:function(){var e=this,t=this.props,a=t.loaded_embedding,n=t.embeddings;this.scene.children[0]=new z.c;for(var i=n[a],r=Q(this.props.dataset).map(function(e){return K(i,e)}),s=new z.c,o=L[this.props.dataset],c=o.sprite_side,l=o.sprite_image_size,d=r.length,u=0;u<d;u++){for(var h=r[u],p=h.coordinates.length,g=new z.b,m=G(h.coordinates),b=new Float32Array(2*p),v=0,f=0,y=p;v<y;v++,f+=2){var _=v%c*l/2048,w=Math.floor(v/c)*l/2048;b[f]=_,b[f+1]=w}var x=h.labels.map(function(t){return e.state.status_to_color[t]}),k=O.flatten(x),E=new Float32Array(k),j=1/c,S=this.textures[u],C=[j,j];g.addAttribute("position",new z.a(m,3)),g.addAttribute("offset",new z.a(b,2)),g.addAttribute("color",new z.a(E,3));var M={texture:{value:S},repeat:{value:Object(A.a)(z.k,C)},size:{value:W[this.props.dataset]}},T="\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }";"Caltech"===this.props.dataset&&(T="\n          uniform sampler2D texture;\n          uniform vec2 repeat;\n          varying vec2 vOffset;\n          varying vec3 vColor;\n          void main() {\n            vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n            // vec4 tex = texture2D( texture, uv * repeat );\n            vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n            // if ( tex.r < 0.5 ) discard;\n            if ( uv[0] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[0] > 0.9 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] > 0.9 ) tex = vec4(vColor, 1.0);\n            // tex.r = 1.0;\n            // tex.g = 1.0;\n            // tex.b = 1.0;\n            gl_FragColor = tex;\n        }");var I=new z.i({uniforms:M,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:T}),H=new z.f(g,I);H.userData={sprite_index:u},s.add(H)}this.scene.children[0]=s}},{key:"transitionPoints",value:function(e,t,a){for(var n=this,i=this.scene.children[0],r=this.scene.children[1].children,s=t[e],o=Q(this.props.dataset).map(function(e){return K(s,e)}),c=o.length,l=function(e){var t=i.children[e],s=o[e],c=t.geometry.attributes.position.array.slice(),l=G(s.coordinates),d=t.geometry.attributes.color.array.slice(),u=s.labels.map(function(e){return n.state.status_to_color[e]}),h=O.flatten(u),p=new Float32Array(h),g=new H.Tween(d).to(p,500).easing(H.Easing.Linear.None);g.onUpdate(function(){t.geometry.attributes.color.array=d,t.geometry.attributes.color.needsUpdate=!0}),g.delay(500);var m=new H.Tween(c).to(l,1e3).easing(H.Easing.Linear.None);m.onUpdate(function(){t.geometry.attributes.position.array=c,t.geometry.attributes.position.needsUpdate=!0}),m.start().chain(g);var b=r[e],v=Array.from(b.geometry.attributes.indexes.array),f=b.geometry.attributes.position.array.slice(),y=G(v.map(function(e){return s.coordinates[e]})),_=new Float32Array(y),w=1200;a||(w=400);var x={value:W[n.props.dataset]},k=n,E=new H.Tween(x).to({value:0},500).easing(H.Easing.Linear.None).delay(w).onComplete(function(){0===e&&(k.addSelectedPoints(),k.props.setTransitionStatus(.5))});E.onUpdate(function(){b.material.uniforms.size=x});var j=new H.Tween(f).to(_,1e3).easing(H.Easing.Linear.None);j.onUpdate(function(){b.geometry.attributes.position.array=f,b.geometry.attributes.position.needsUpdate=!0}),j.onComplete(function(){0===e&&setTimeout(function(){b.material.uniforms.size.value>0?k.props.setTransitionStatus(2.6):(k.addSelectedPoints(),k.props.setTransitionStatus(2.6),k.props.setTransitionStatus(.5))},0)}),b.material.uniforms.size.value>0&&j.chain(E),j.start()},d=0;d<c;d++)l(d)}},{key:"addSelectedPoints",value:function(){var e=this,t=this.props,a=t.loaded_embedding,n=t.embeddings;this.scene.children[1]=new z.c;for(var i=n[a],r=L[this.props.dataset],s=r.sprite_side,o=r.sprite_image_size,c=Q(this.props.dataset).map(function(e){return K(i,e)}),l=new z.c,d=c.length,u=function(t){for(var a=c[t],n=[],i=0;i<a.statuses.length;i++)1===a.statuses[i]&&n.push(i);for(var r=new Float32Array(n),d=n.length,u=new z.b,h=G(n.map(function(e){return a.coordinates[e]})),p=new Float32Array(2*d),g=0,m=0,b=d;g<b;g++,m+=2){var v=n[g],f=v%s*o/2048,y=Math.floor(v/s)*o/2048;p[m]=f,p[m+1]=y}var _=n.map(function(e){return[.85,.85,.85]}),w=O.flatten(_),x=new Float32Array(w),k=1/s,E=e.textures[t],j=[k,k];u.addAttribute("position",new z.a(h,3)),u.addAttribute("offset",new z.a(p,2)),u.addAttribute("color",new z.a(x,3)),u.addAttribute("indexes",new z.a(r,1));var S={texture:{value:E},repeat:{value:Object(A.a)(z.k,j)},size:{value:0}},C="\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }";"Caltech"===e.props.dataset&&(C="\n          uniform sampler2D texture;\n          uniform vec2 repeat;\n          varying vec2 vOffset;\n          varying vec3 vColor;\n          void main() {\n            vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n            // vec4 tex = texture2D( texture, uv * repeat );\n            vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n            // if ( tex.r < 0.5 ) discard;\n            if ( uv[0] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[0] > 0.9 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] > 0.9 ) tex = vec4(vColor, 1.0);\n            // tex.r = 1.0;\n            // tex.g = 1.0;\n            // tex.b = 1.0;\n            gl_FragColor = tex;\n        }");var M=new z.i({uniforms:S,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:C}),T=new z.f(u,M);l.add(T)},h=0;h<d;h++)u(h);this.scene.children[1]=l}},{key:"revealSelected",value:function(){for(var e=this,t={value:0},a={value:W[this.props.dataset]},n=this.scene.children[1].children,i=function(i){var r=n[i],s=new H.Tween(t).to(a,500).easing(H.Easing.Linear.None);s.onUpdate(function(){r.material.uniforms.size=t});var o=e;s.onComplete(function(){0===i&&setTimeout(function(){o.props.setTransitionStatus(1)},200)}),s.start()},r=0;r<n.length;r++)i(r)}},{key:"labelSelected",value:function(){for(var e=this,t=this.props,a=t.loaded_embedding,n=t.embeddings[a],i=Q(this.props.dataset).map(function(e){return K(n,e)}),r=this.scene.children[1].children,s=function(t){var a=i[t],n=r[t],s=Array.from(n.geometry.attributes.indexes.array),o=r[t].geometry.attributes.color.array.slice(),c=s.map(function(t){var n=a.labels[t];return e.state.status_to_color[n]}),l=O.flatten(c),d=new Float32Array(l),u=new H.Tween(o).to(d,400).easing(H.Easing.Linear.None),h=r[t];u.onUpdate(function(){h.geometry.attributes.color.array=o,h.geometry.attributes.color.needsUpdate=!0});var p=e;u.onComplete(function(){0===t&&setTimeout(function(){p.props.setTransitionStatus(2.3)},0)}),u.start()},o=0;o<i.length;o++)s(o)}},{key:"componentDidUpdate",value:function(e){var t=this;if(null!==this.props.loaded_embedding&&!1===this.state.initialized)this.setState({initialized:!0}),Promise.all(D(B[this.props.dataset])).then(function(e){t.textures=e,t.addPoints(),t.addSelectedPoints(),t.props.setTransitionStatus(.5);var a=["MNIST","Quickdraw","Caltech"].indexOf(t.props.dataset),n=t;setTimeout(function(){n.props.loadImages(a);var e=t.divElement.clientHeight;n.props.setKeyHeight(e)},0)}).catch(function(e){console.log(e.message)});else if(e.loaded_embedding!==this.props.loaded_embedding){var a=x(e.loaded_embedding),n=x(this.props.loaded_embedding);if(a.dataset!==n.dataset){var i=q(n.dataset),r=i.color_array,s=i.color_array_hexes,o=i.status_to_color;for(this.setState({color_array:r,color_array_hexes:s,status_to_color:o});this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);this.resetCamera(),this.props.setTransitionStatus(0);var c=this.divElement.clientHeight;this.props.setKeyHeight(c);var l=this;setTimeout(function(){Promise.all(D(B[l.props.dataset])).then(function(e){l.textures=e,l.addPoints(),l.addSelectedPoints(),l.props.setTransitionStatus(.5)})},0)}else a.strategy!==n.strategy?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0):a.round!==n.round&&1.5!==this.props.transition_status&&this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0)}else.5===this.props.transition_status&&0===e.transition_status||.5===this.props.transition_status&&2.6===e.transition_status?this.props.round!==this.props.round_limit?this.revealSelected():this.props.setTransitionStatus(1):2===this.props.transition_status&&1.5===e.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===e.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):(this.props.round,e.round);var d=this.props,u=d.width,h=d.height;if(u!==e.width||h!==e.height){this.camera.aspect=u/h,this.camera.updateProjectionMatrix(),this.renderer.setSize(u,h);var p=this.getScaleFromZ(this.camera.position.z),g=-this.camera.position.x*p+this.props.width/2,m=this.camera.position.y*p+this.props.height/2,b=I.f.translate(g,m).scale(p),v=I.d(this.mount);this.d3_zoom.transform(v,b);var f=this;setTimeout(function(){var e=f.divElement.clientHeight;f.props.setKeyHeight(e)},0)}}},{key:"showHover",value:function(e,t,a,n){var i=this.props.images,r={MNIST:i[0],Quickdraw:i[1],Caltech:i[2]},s=this.props.embeddings[this.props.loaded_embedding];this.hover_mount.style.display="block";var o="".concat(e[1]-84-this.props.grem-16-14,"px");this.hover_mount.style.transform="translate3d(".concat(e[0]-42-4,"px, ").concat(o,",0)"),this.hover_ctx=this.hover_mount.childNodes[0].getContext("2d"),this.hover_ctx.imageSmoothingEnabled=!1;var c=this.hover_mount.childNodes[1];this.hover_ctx.fillRect(0,0,84,84);var l=s.statuses[n],d=this.state.status_to_color.slice(0,this.state.status_to_color.length-1);d.push([.5,.5,.5]);var u=null,h="black";1===l&&this.props.round!==this.props.round_limit?(u="#eee",h="black"):u="rgba("+d[s.labels[n]].map(function(e){return Math.round(255*e)}).join(",")+",1)",this.hover_mount.style.background=u,this.hover_mount.style.color=h;var g=L[this.props.dataset],m=g.sprite_side,b=g.sprite_image_size;c.style.background=u,c.innerText=1===l&&this.props.round!==this.props.round_limit?"selected":[].concat(Object(p.a)(k[this.props.dataset]),["unlabeled"])[s.labels[n]],this.hover_ctx.drawImage(r[this.props.dataset][t],a%m*b,Math.floor(a/m)*b,b,b,0,0,84,84)}},{key:"checkIntersects",value:function(e){var t=this.props,a=t.width,n=t.height,i=Object(T.a)(e,2),r=i[0],s=i[1],o=L[this.props.dataset].sprite_size;var c=function(e){var t=Object(T.a)(e,2),i=t[0],r=t[1];return new z.l(i/a*2-1,-r/n*2+1,1)}(e);if(this.raycaster.setFromCamera(c,this.camera),this.raycaster.params.Points.threshold=.25,"Caletch"===this.props.dataset&&(this.raycaster.params.Points.threshold=4),void 0!==this.scene.children[0]&&this.scene.children[0].children.length>0){var l=this.raycaster.intersectObjects(this.scene.children[0].children);if(l[0]){var d=function(e){return O.sortBy(e,"distanceToRay")}(l)[0],u=d.object.userData.sprite_index,h=d.index,p=u*o+h;this.showHover([r,s],u,h,p)}else this.hover_mount.style.display="none"}}},{key:"handleMouse",value:function(){var e=this,t=I.d(this.renderer.domElement);this.raycaster=new z.g,t.on("mousemove",function(){var a=I.b(t.node()),n=Object(T.a)(a,2),i=[n[0],n[1]];e.checkIntersects(i)}),t.on("mouseleave",function(){e.hover_mount.style.display="none"})}},{key:"init",value:function(){var e=this.props,t=e.width,a=e.height,n=q(this.props.dataset),i=n.color_array,r=n.color_array_hexes,s=n.status_to_color;this.setState({color_array:i,color_array_hexes:r,status_to_color:s}),this.scene=new z.h;var o=t/a;this.camera=new z.e(75,o,.01,1e3),this.camera.position.z=30,this.renderer=new z.m,this.renderer.setClearColor(1118481,1),this.renderer.setSize(t,a),this.mount.appendChild(this.renderer.domElement);var c=new z.c;this.scene.add(c);var l=new z.c;this.scene.add(l),this.d3_zoom=I.e().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var d=I.d(this.mount);this.view=d,d.call(this.d3_zoom);var u=this.getScaleFromZ(this.camera.position.z),h=I.f.translate(t/2,a/2).scale(u);this.d3_zoom.transform(d,h),this.animate(),this.handleMouse()}},{key:"resetCamera",value:function(){var e=this.props,t=e.width,a=e.height,n=I.d(this.mount);this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=30;var i=this.getScaleFromZ(this.camera.position.z),r=I.f.translate(t/2,a/2).scale(i);this.d3_zoom.transform(n,r)}},{key:"animate",value:function(){requestAnimationFrame(this.animate),H.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height,r=t.grem,s=t.dataset;return i.a.createElement("div",{style:{position:"absolute",left:0,width:a,height:n,background:"#222",overflow:"hidden",cursor:"crosshair"},grem:r},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:a,height:n},ref:function(t){e.mount=t}}),i.a.createElement("div",{ref:function(t){e.divElement=t},style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(r/4,"px"),position:"absolute",left:0,bottom:0,pointerEvents:"none"}},i.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginBottom:r/2}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Key:"),i.a.createElement("div",{style:{background:"#888",color:"#111",height:r,padding:"0 ".concat(r/4,"px"),textAlign:"center"}},"unlabeled"),i.a.createElement("div",{style:{background:"#fff",color:"#111",height:r,padding:"0 ".concat(r/4,"px"),textAlign:"center",marginLeft:r/4}},"selected")),i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px 0 ").concat(r/4,"px"),display:"flex",flexWrap:"wrap",marginBottom:r/2}},i.a.createElement("div",{style:{padding:"0 0 0 0"}},"Labels:"),null!==this.state.color_array_hexes?this.state.color_array_hexes.map(function(t,a){return i.a.createElement("div",{key:"color_"+a,style:{background:e.state.color_array_hexes[a],height:r,textAlign:"center",color:"#111",padding:"0 ".concat(r/4,"px"),marginRight:r/4}},k[s][a])}):null)),i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:92,pointerEvents:"none",padding:4,display:"none",color:"white",height:r+84+12+0,lineHeight:0,border:"solid ".concat(0,"px rgba(0,0,0,0.3)")},ref:function(t){e.hover_mount=t}},i.a.createElement("canvas",{width:84,height:84,style:{imageRendering:"pixelated"}}),i.a.createElement("div",{style:{width:84,height:r,textAlign:"center",lineHeight:1.5,paddingTop:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})))}}]),t}(n.Component),Y=(Object(p.a)(Array(40)).map(function(e){return null}),Object(p.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")})),J={MNIST:Y,Quickdraw:Object(p.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")})},V=Object(p.a)(Array(10)).map(function(e,t){return m.hsl(0+36*t,1,.5).luminance(.5).hex()}),$=(n.Component,function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=e.grem,r=e.strategies,s=e.strategy_colors,o=e.strategy,c=e.active_embedding,l=e.requested_embedding,d=e.loaded_embedding,u=e.embeddings,h=(e.mnist_images,e.ranges,e.transition_status),p=e.setTransitionStatus,g=e.loading_round,m=(e.header_height,e.footer_height),b=e.round,v=e.round_limit,f=e.dataset;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(Z,{width:t,height:a,grem:n,active_embedding:c,strategies:r,strategy_colors:s,strategy:o,embeddings:u,requested_embedding:l,loaded_embedding:d,transition_status:h,setTransitionStatus:p,loading_round:g,footer_height:m,selectRound:this.props.selectRound,round:b,round_limit:v,dataset:f,loadImages:this.props.loadImages,images:this.props.images,setKeyHeight:this.props.setKeyHeight}),null)}}]),t}(n.Component)),X=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,a,n,r=this,s=this.props,o=s.transition_status,c=s.grem,l=s.round_limit,d=s.round,u=s.dataset,h=s.strategy,p=d;o>1&&o<2.3&&(p=Math.max(0,p-1)),0===o?(t="Loading...",a=null):.5===o?(t="Selecting points...",a=null):1===o?(t="".concat("Caltech"===this.props.dataset?"50":"1,000"," points selected from ").concat(u," using ").concat("string"!==typeof(n=h)?"":n.charAt(0).toUpperCase()+n.slice(1)),p===l&&(t="Final round of ".concat(u," using ").concat(h)),this.props.loading_embedding&&(t="Loading..."),a=1.5):1.5===o?(t="Labeling points...",a=null):2===o?(t="Retraining model...",a=null):2.3===o?(t="Retraining model...",a=null):2.6===o&&(t="Selecting points...",p===l&&(t="Final round of ".concat(u," using ").concat(h)),a=null);var m=null===a||l===p;return i.a.createElement("div",{style:{position:"absolute",bottom:null===this.props.key_height?c+this.props.footer_height+1.5*c:this.props.key_height+this.props.footer_height+1*c,left:0,padding:"0 ".concat(c/4,"px"),pointerEvents:"none"}},i.a.createElement("div",{style:{display:"flex",marginBottom:c/2}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px"),position:"relative"}},t)),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},i.a.createElement("button",{style:Object(g.a)({pointerEvents:"auto",color:m?"#555":"white",textDecoration:m?"none":"underline",cursor:m?"default":"pointer"},"pointerEvents",m?"none":"auto"),onClick:function(){null!==a&&l!==p&&r.props.toggleList(!0)}},"View list")),i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},i.a.createElement("button",{className:null===a?"gray-bg":"rainbow-animate",style:(e={width:120,height:c,color:null===a?"#222":"black",textAlign:"left",cursor:null===a?"default":"pointer",textDecoration:null===a?"none":"underline",borderRadius:c/2},Object(g.a)(e,"textAlign","center"),Object(g.a)(e,"pointerEvents","auto"),e),disabled:null===a,onClick:function(){null!==a&&(l===p?r.props.selectRound(0):r.props.setTransitionStatus(a))}},l!==p?"Next round":"Restart")),i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},i.a.createElement("button",{style:Object(g.a)({pointerEvents:"auto",color:m?"#555":"white",textDecoration:m?"none":"underline",cursor:m?"default":"pointer"},"pointerEvents",m?"none":"auto"),onClick:function(){null!==a&&l!==p&&null!==a&&r.props.selectRound(l)}},"Jump to end"))))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={count:0},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=0,t=0,a=this;function n(){e+=25;var i=Math.floor(e);i!==t&&(t=i),a.setState({count:t}),t<1e3?requestAnimationFrame(n):setTimeout(function(){a.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(n)},200)}},{key:"render",value:function(){var e=this.props;e.grem,e.ww;return i.a.createElement("div",null,i.a.createElement("div",{style:{position:"absolute",height:"100%",width:"100%",left:0,top:0,background:"#ddd"}},i.a.createElement("div",{style:{height:"100%",width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},i.a.createElement("div",{style:{height:"100%",width:"100%",background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),t}(n.Component),te={sprite_side:73,sprite_size:5329,sprite_number:12,sprite_image_size:28},ae=Object.assign({},te,{sprite_number:13}),ne=Object.assign({},te,{sprite_side:9,sprite_size:81,sprite_number:11,sprite_image_size:224}),ie={MNIST:te,Quickdraw:ae,Caltech:ne},re=Object(p.a)(Array(te.sprite_number)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")}),se=Object(p.a)(Array(ae.sprite_number)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")}),oe={MNIST:re,Quickdraw:se,Caltech:Object(p.a)(Array(ne.sprite_number)).map(function(e,t){return"".concat("","/").concat("CALTECH_").concat(t,".png")})},ce=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.grem,n=t.embeddings,r=t.loaded_embedding,s=t.dataset,o=t.ww,c=t.wh,l=[],d=n[r];if(d)for(var u=0;u<d.statuses.length;u++)1===d.statuses[u]&&l.push(u);var h=ie[s],p=h.sprite_size,g=h.sprite_side,m=h.sprite_image_size,b=80+a/2,v=Math.floor((o-a)/b),f=(o-a-a/2*(v-1))/v,y=f/m,_=l.map(function(e){var t=Math.floor(e/p),a=e%p;return[t,a%g,Math.floor(a/g)]});return i.a.createElement("div",{style:{background:"#888"}},i.a.createElement("div",{style:{padding:a/2,background:"white",color:"black",position:"relative"}},"Selected points",i.a.createElement("button",{style:{position:"absolute",right:0,top:0,padding:a/2,color:"black"},onClick:function(){e.props.toggleList(!1)}},"\xd7")),i.a.createElement("div",{style:{overflow:"auto",height:c-6*a}},i.a.createElement("div",{style:{padding:a/2,paddingBottom:0}},"Caltech"===this.props.dataset?"50":"1,000"," points selected for labeling from the ",this.props.dataset," dataset using the"," ",this.props.strategy," strategy:"),i.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, ".concat(f,"px)"),gridRowGap:a/2,gridColumnGap:a/2,padding:a/2}},_.length>0?_.map(function(e,t){return i.a.createElement("div",{key:e,style:{paddingBottom:"100%",position:"relative"}},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundImage:"url(".concat(oe[s][e[0]],")"),backgroundSize:"".concat(2048*y,"px ").concat(2048*y,"px"),backgroundPosition:"-".concat(e[1]*y*m,"px -").concat(e[2]*y*m,"px"),imageRendering:"pixelated"}}))}):null)))}}]),t}(n.Component),le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.grem;return i.a.createElement("div",{style:{}},i.a.createElement("div",{style:{padding:t/2,color:"black",position:"relative",background:"white"}},"About Active Learner",i.a.createElement("button",{style:{position:"absolute",right:0,top:0,padding:t/2,color:"black"},onClick:function(){e.props.toggleModal(!1)}},"\xd7")),i.a.createElement("div",{style:{padding:t/2,background:"#ccc"}},i.a.createElement("p",{style:{fontStyle:"italic"}},"Active Learner is a research prototype by"," ",i.a.createElement("a",{href:"http://fastforwardlabs.com"},"Cloudera Fast Forward Labs"),","," ","built to accompany our report on Learning with Limited Labeled Data. For more about the report"," ",i.a.createElement("a",{href:"https://blog.fastforwardlabs.com/2019/03/20/learning-with-limited-labeled-data.html"},"read our blog post"),"."),i.a.createElement("p",{style:{textIndent:t}},"Supervised machine learning, while powerful, needs labeled data to be effective. Active learning"," ",i.a.createElement("span",{style:{color:"black",background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}},"reduces the number of labeled examples needed to train a model"),", saving time and money while obtaining comparable performance to models trained with much more data."),i.a.createElement("p",{style:{textIndent:t}},"In Active Learner, we visualize the selections of"," ",i.a.createElement("span",{style:{background:"#111",color:"white"}},"four different training strategies")," ","on"," ",i.a.createElement("span",{style:{background:"#111",color:"white"}},"three different datasets"),". We use a dimensionality reduction technique called"," ",i.a.createElement("a",{href:"https://umap-learn.readthedocs.io/en/latest/"},"UMAP")," to visualize how the model is clustering the dataset."," ",i.a.createElement("span",{style:{background:"white",color:"black"}},"We highlight the points that the strategy has selected to be labeled in the next round.")," ","Clicking on the"," ",i.a.createElement("span",{className:"rainbow-animate"},"Next\xa0round")," button retrieves the labels for those selections and retrains the model, showing how the clusters shift."," ",i.a.createElement("span",{style:{background:"#666",color:"#fff"}},"The graph at the bottom shows the changes in accuracy for different rounds.")," ","You can use the graph to compare the effectiveness of the different strategies."),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("button",{style:{color:"black"},onClick:function(){e.props.toggleModal(!1)}},"Start exploring now")," ","or learn more about strategies and datasets below."),i.a.createElement("div",{style:Object(g.a)({width:"100%",height:1,background:"linear-gradient(to right, ".concat(this.props.gradient_string,")"),marginTop:t/2-.5,marginBottom:t/2-.5},"background","#aaa")}),i.a.createElement("p",{style:{marginBottom:t/2}},"Strategy and dataset info"),i.a.createElement("p",{style:{marginBottom:t/2,textIndent:t}},"Active learning strategies focus on points that the model is especially uncertain about. You can see this focus in the visualization when the"," ",i.a.createElement("span",{style:{background:"white"}},"selected points are at the boundaries of clusters"),". You can compare the different active learning strategies (",i.a.createElement("span",{style:{background:"black",color:"white"}},"Entropy"),","," ",i.a.createElement("span",{style:{background:"black",color:"white"}},"Adversarial"),","," ",i.a.createElement("span",{style:{background:"black",color:"white"}},"Ensemble"),") with the"," ",i.a.createElement("span",{style:{background:"black",color:"white"}},"Random")," ","strategy to get a feel for how active learning works."),i.a.createElement("p",null,"About the strategies"),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Random"),":"," ",i.a.createElement("span",{style:{background:"white"}},"points are selected randomly"),"."),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Entropy"),":"," ",i.a.createElement("span",{style:{background:"white"}},"points with high entropy are selected"),". The outcome of an uncertain event carries a higher entropy compared to an event with no uncertainty."),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Adversarial"),":"," ",i.a.createElement("span",{style:{background:"white"}},"points with small adversarial perturbation magnitudes are selected"),". A perturbation causes a particular datapoint to be classified as a different category."),i.a.createElement("p",{style:{textIndent:t,marginBottom:t/2}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Ensemble"),":"," ",i.a.createElement("span",{style:{background:"white"}},"points are selected using the averaged prediction probabilities across an ensemble of models"),"."),i.a.createElement("p",null,"About the datasets"),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"MNIST"),": The ",i.a.createElement("a",{href:"http://yann.lecun.com/exdb/mnist/"},"MNIST dataset")," ","consists of handwritten digits from 0 to 9. It has a training set of 60,000 examples, and a test set of 10,000 examples. We use 5,000 labels to start and add 1,000 more labels each round."),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Quickdraw"),": The"," ",i.a.createElement("a",{href:"https://quickdraw.withgoogle.com/data"},"Quick Draw dataset")," ","consists of 50 million hand-drawn figures across 345 categories. We randomly selected 10 categories for which to build a classifier, resulting in a training set of 65,729 examples and a test set of 16,436 examples. We use 5,000 labels to start and add 1,000 more labels each round."),i.a.createElement("p",{style:{textIndent:t}},i.a.createElement("span",{style:{background:"black",color:"white"}},"Caltech"),": The"," ",i.a.createElement("a",{href:"http://www.vision.caltech.edu/Image_Datasets/Caltech256/"},"Caltech 256 dataset")," ","consists of 30,607 images from 256 categories. We randomly selected 10 categories for which to build a classifier, resulting in a training set of 822 examples, and a test set of 212 examples. We use 300 labels to start and add 50 labels each round.")))}}]),t}(n.Component),de=4,ue=Object(p.a)(Array(de)).map(function(e,t){return m.hsl(90/de*t-45,1,.5).luminance(.5).hex()}),he=[],pe=0;pe<12;pe++){var ge=5329*pe,me=5329*(pe+1);11===pe&&(me=63948),he.push([ge,me])}Object(p.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")});de=10;var be,ve=Object(p.a)(Array(de)).map(function(e,t){return m.hsl(0+360/de*t,1,.5).luminance(.5).hex()}),fe=ve.reduce(function(e,t,a){return e+t+" "+Math.round(a/de*100)+(a===de-1?"%":"%, ")},""),ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1,show_list:!1,show_modal:!0,key_height:null},a.setSize=a.setSize.bind(Object(h.a)(Object(h.a)(a))),a.setSize=Object(O.debounce)(a.setSize,200),a.setHeaderHeight=a.setHeaderHeight.bind(Object(h.a)(Object(h.a)(a))),a.setFooterHeight=a.setFooterHeight.bind(Object(h.a)(Object(h.a)(a))),a.setTransitionStatus=a.setTransitionStatus.bind(Object(h.a)(Object(h.a)(a))),a.labelsGotten=a.labelsGotten.bind(Object(h.a)(Object(h.a)(a))),a.toggleList=a.toggleList.bind(Object(h.a)(Object(h.a)(a))),a.toggleModal=a.toggleModal.bind(Object(h.a)(Object(h.a)(a))),a.setKeyHeight=a.setKeyHeight.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setKeyHeight",value:function(e){this.setState({key_height:e})}},{key:"setHeaderHeight",value:function(e){this.setState({header_height:e})}},{key:"setFooterHeight",value:function(e){this.setState({footer_height:e})}},{key:"toggleList",value:function(e){this.setState({show_list:e})}},{key:"toggleModal",value:function(e){this.setState({show_modal:e})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(e,t){!0===this.state.loading_round&&e.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(e){1.5===e?(this.setState({transition_status:e,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:e})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.ww,r=a.wh,s=a.header_height,o=a.footer_height,c=a.loading_round,l=a.simulating_labeling,d=a.transition_status,u=a.show_list,h=a.show_modal,p=this.props,m=p.dataset,b=p.strategy,f=p.round,y=p.datasets,_=p.strategies,x=p.selectDataset,k=p.selectStrategy,E=p.embeddings,O=p.requested_embedding,j=p.loaded_embedding,S=p.strategy_explored,C=(p.toggleList,O!==j);return null===n?i.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):i.a.createElement("div",{style:{width:n,height:r,overflow:"hidden",position:"relative"}},i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",top:0,right:0,padding:10.5,zIndex:999,background:"red",display:"none"}},d),null!==o&&null!==s?i.a.createElement("div",{style:{background:"white",height:r}},i.a.createElement($,{width:n,height:r,grem:21,strategies:_,strategy_colors:ue,strategy:b,dataset:m,embeddings:E,requested_embedding:O,loaded_embedding:j,loading_round:c,selectRound:this.props.selectRound,ranges:he,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:o,round:f,header_height:s,round_limit:7,loadImages:this.props.loadImages,images:this.props.images,setKeyHeight:this.setKeyHeight})):null,null!==o?i.a.createElement(X,(e={transition_status:this.state.transition_status,grem:21,footer_height:o,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:f,dataset:m,toggleList:this.toggleList,selectRound:this.props.selectRound},Object(g.a)(e,"dataset",m),Object(g.a)(e,"strategy",b),Object(g.a)(e,"loading_embedding",C),Object(g.a)(e,"key_height",this.state.key_height),e)):null,i.a.createElement(v,{datasets:y,selectDataset:x,strategies:_,strategy:b,strategy_colors:ue,selectStrategy:k,dataset:m,activeStyle:w,setHeaderHeight:this.setHeaderHeight,gradient_string:fe,grem:21,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,toggleModal:this.toggleModal}),null!==s?i.a.createElement(M,{round:f,ww:n,grem:21,strategies:_,strategy_colors:ue,strategy:b,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:fe,color_array_hexes:ve,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:l,strategy_explored:S,round_limit:7,dataset:m,key_height:this.state.key_height}):null,this.state.simulating_labeling?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center",color:"black"}},i.a.createElement("div",{style:Object(g.a)({position:"relative",width:Math.min(500,n),background:"white",color:"black",padding:21},"background","#888")},i.a.createElement("div",{style:{marginBottom:10.5}},"Round ",f+1),i.a.createElement("div",{style:{position:"relative",height:21}},i.a.createElement(ee,{grem:21,gradient_string:fe,ww:n,labelsGotten:this.labelsGotten})),i.a.createElement("div",{style:{position:"relative",paddingTop:10.5}},"Getting labels for selected points..."))):null,u?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center",color:"black",background:"rgba(0, 0, 0, 0.4)"},onClick:function(){t.toggleList(!1)}},i.a.createElement("div",{style:{position:"relative",width:n-63,color:"black"},onClick:function(e){e.stopPropagation()}},i.a.createElement(ce,{grem:21,dataset:m,strategy:b,embeddings:E,loaded_embedding:j,wh:r,ww:n-63,toggleList:this.toggleList}))):null,h?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center",color:"black",background:"rgba(60, 60, 60, 0.4)",overflow:"auto",paddingTop:r<800?r/4:52.5,paddingBottom:r/4},onClick:function(){t.toggleModal(!1)}},i.a.createElement("div",{style:{position:"relative",maxWidth:600,width:"100%",color:"black"},onClick:function(e){e.stopPropagation()}},i.a.createElement(le,{grem:21,toggleModal:this.toggleModal,gradient_string:fe}))):null))}}]),t}(n.Component),_e=["MNIST","Quickdraw","Caltech"],we=["random","entropy","adversarial","ensemble"],xe=(be={},Object(g.a)(be,_e[0],["mnist_random_round","mnist_entropy_round","mnist_adv_round","mnist_ensemble_entropy_round"]),Object(g.a)(be,_e[1],["quickdraw_random_round","quickdraw_entropy_round","quickdraw_adv_round","quickdraw_ensemble_entropy_round"]),Object(g.a)(be,_e[2],["caltech_random_round","caltech_entropy_round","caltech_adv_round","caltech_ensemble_entropy_round"]),be);function ke(e,t,a){return"".concat(e,"-").concat(t,"-").concat(a)}var Ee={sprite_side:73,sprite_size:5329,sprite_number:12,sprite_image_size:28},Oe=Object.assign({},Ee,{sprite_number:13}),je=Object.assign({},Ee,{sprite_side:9,sprite_size:81,sprite_number:11,sprite_image_size:224}),Se=Object(p.a)(Array(Ee.sprite_number)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")}),Ce=Object(p.a)(Array(Oe.sprite_number)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")}),Me=Object(p.a)(Array(je.sprite_number)).map(function(e,t){return"".concat("","/").concat("CALTECH_").concat(t,".png")}),Te=[Se,Ce,Me],Ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={embeddings:{},dataset:_e[0],strategy:we[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0,loading:!1,images:[null,null,null]},a.scaleEmbeddings=a.scaleEmbeddings.bind(Object(h.a)(Object(h.a)(a))),a.fetchData=a.fetchData.bind(Object(h.a)(Object(h.a)(a))),a.checkOrFetchData=a.checkOrFetchData.bind(Object(h.a)(Object(h.a)(a))),a.selectRound=a.selectRound.bind(Object(h.a)(Object(h.a)(a))),a.loadImages=a.loadImages.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"selectRound",value:function(e){var t=Math.max(this.state.strategy_explored,e);this.setState({round:e,strategy_explored:t}),this.checkOrFetchData(this.state.dataset,this.state.strategy,e)}},{key:"loadImages",value:function(e){if(null===this.state.images[e]){var t=Te[e].map(function(e){var t=document.createElement("img");return t.src=e,t}),a=this.state.images.slice();a[e]=t,this.setState({images:a})}}},{key:"selectDataset",value:function(e){this.setState({dataset:_e[e],strategy_explored:0,round:0}),this.checkOrFetchData(_e[e],this.state.strategy,0),this.loadImages(e)}},{key:"selectStrategy",value:function(e){this.setState({strategy:we[e]}),this.checkOrFetchData(this.state.dataset,we[e],this.state.round)}},{key:"checkOrFetchData",value:function(e,t,a){var n=this.state.embeddings,i=ke(e,t,a);this.setState({requested_embedding:i}),void 0!==n[i]?this.setState({loaded_embedding:i}):this.fetchData(e,t,a)}},{key:"scaleEmbeddings",value:function(e){var t=e.map(function(e){return Math.abs(e[0])}),a=e.map(function(e){return Math.abs(e[1])}),n=O.max(t),i=O.max(a),r=Math.max(n,i),s=I.c().domain([-r,r]).range([-20,20]);return e.map(function(e){return[s(e[0]),s(e[1])]})}},{key:"fetchData",value:function(e,t,a){var n=this,i="".concat("","/").concat(xe[e][we.indexOf(t)]).concat(a,".json");fetch(i).then(function(e){return e.json()}).then(function(i){var r=i.coordinates,s=r.map(function(e){return Math.abs(e[0])}),o=r.map(function(e){return Math.abs(e[1])}),c=O.max(s),l=O.max(o),d=Math.max(c,l),u=I.c().domain([-d,d]).range([-20,20]),h=r.map(function(e){return[u(e[0]),u(e[1])]}),p={};p.coordinates=h,p.statuses=i.status,p.labels=i.labels;var m=ke(e,t,a);n.setState({loaded_embedding:m,embeddings:Object.assign({},n.state.embeddings,Object(g.a)({},m,p))})})}},{key:"componentDidMount",value:function(){var e=this.state,t=e.dataset,a=e.strategy,n=e.round;this.checkOrFetchData(t,a,n)}},{key:"render",value:function(){return i.a.createElement(ye,Object.assign({},this.state,{datasets:_e,strategies:we,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this),loadImages:this.loadImages.bind(this)}))}}]),t}(n.Component),ze=(a(29),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(Ae,null)}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.1014e290.chunk.js.map