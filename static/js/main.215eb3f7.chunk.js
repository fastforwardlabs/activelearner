(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n(30)},25:function(e,t,n){},28:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(18),s=n.n(r),o=(n(25),n(3)),l=n(4),c=n(7),d=n(5),u=n(6),h=n(19),g=n(1),p=n(8),m=n(11),b=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},v=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},n.setHeight=n.setHeight.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setHeaderHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this,t=this.props,n=t.datasets,a=t.selectDataset,r=t.strategies,s=t.strategy,o=(t.strategy_colors,t.selectStrategy),l=t.dataset,c=(t.activeStyle,t.grem);return i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px"),fontWeight:"bold"}},"Active Learner")),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Dataset:"),n.map(function(e,t){var n,r=e===l;return n=r?i.a.createElement("span",null,e):i.a.createElement("button",{onClick:function(){a(t)}},e),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},n)}).reduce(function(e,t){return[e," ",t]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(c/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(c/4,"px")}},"Strategy:"),r.map(function(e,t){var n,a=e===s;return n=a?i.a.createElement("span",null,b(e)):i.a.createElement("button",{onClick:function(){o(t)}},b(e)),i.a.createElement("span",{style:{padding:"0 ".concat(c/4,"px"),background:a?"white":"transparent",color:a?"black":"white"}},n)}).reduce(function(e,t){return[e," ",t]})))}}]),t}(a.Component);function f(e){return Math.round(1e4*e)/100+"%"}function y(e,t,n,a){a?e.moveTo(t,n):e.lineTo(t,n)}function _(e){return{background:e,boxShadow:"-0.25em 0 0 ".concat(e,", 0.25em 0 0 ").concat(e),textDecoration:"none"}}function w(e){var t=e.split("-");return{dataset:t[0],strategy:t[1],round:t[2]}}var O={random:{accuracy:[.9539,.9569,.9595,.9652,.9651,.9687,.9679,.9678,.9699],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},entropy:{accuracy:[.953,.9664,.971,.9746,.9791,.9776,.979,.9805,.9795],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},deepfool:{accuracy:[.954,.9656,.9703,.9762,.9782,.9805,.9765,.9819,.9816],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]},ensemble:{accuracy:[.9639,.9703,.9772,.978,.9813,.9836,.9837,.9847,.9848],num_labeled:[1e4,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3]}},x=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return i.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},i.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),t}(a.Component),j=n(9),k=(Object(p.a)(Array(4)).map(function(e){return Object(p.a)(Array(5)).map(function(e){return Math.random()})}),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).ctx=null,n.getCtx=n.getCtx.bind(Object(g.a)(Object(g.a)(n))),n.draw=n.draw.bind(Object(g.a)(Object(g.a)(n))),n.handleRound=n.handleRound.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getCtx",value:function(e){this.ctx=e.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(e){this.props.strategy_explored!==e.strategy_explored&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(e){e!==this.props.round&&this.props.selectRound(e)}},{key:"draw",value:function(){var e=this.props,t=(e.width,e.height),n=e.strategies,a=(e.strategy_colors,e.round),i=e.strategy,r=e.grem,s=e.transition_status,o=e.strategy_explored,l=O[i];t-=2*r,3===s&&(a+=1);var c=this.ctx,d=4,u=n.map(function(e){return j.min(O[e].accuracy)}),h=Math.floor(10*j.min(u))/10,g=1-h;c.clearRect(0,0,100*(o+1),t);var p=2*d;t-=2*p,c.fillStyle="rgba(100,100,100,0.3)",c.fillRect(100*a,p,100,t),c.lineWidth=3,c.strokeStyle="rgba(100,100,100,0.5)";for(var m=0;m<g+.05;m+=.05){c.beginPath();var b=m/g*t;y(c,0,b+p,!0),y(c,100*(o+1),b+p,!1),c.stroke()}var v=n.filter(function(e){return e!==i}),f=!0,_=!1,w=void 0;try{for(var x,k=v[Symbol.iterator]();!(f=(x=k.next()).done);f=!0){var E=x.value,S=O[E];c.lineWidth=2,c.strokeStyle="#666",c.fillStyle="#666",c.beginPath();for(var C=0;C<o+1;C++){y(c,100*C+50,t-(S.accuracy[C]-h)/(1-h)*t+p,0===C)}c.stroke();for(var M=0;M<o+1;M++){var A=(S.accuracy[M]-h)/(1-h);c.beginPath(),c.arc(100*M+50,t-A*t+p,d,0,2*Math.PI),c.fill()}}}catch(T){_=!0,w=T}finally{try{f||null==k.return||k.return()}finally{if(_)throw w}}d=6,c.lineWidth=2,c.strokeStyle="#efefef",c.fillStyle="#efefef",c.beginPath();for(var D=0;D<o+1;D++){y(c,100*D+50,t-(l.accuracy[D]-h)/(1-h)*t+p,0===D)}c.stroke();for(var P=0;P<o+1;P++){var F=(l.accuracy[P]-h)/(1-h);c.beginPath(),c.arc(100*P+50,t-F*t+p,d,0,2*Math.PI),c.fill()}}},{key:"render",value:function(){var e=this,t=this.props,n=(t.width,t.height),a=t.grem,r=(t.strategies,t.strategy),s=t.round,o=t.transition_status,l=(t.adjusted_round,t.strategy_explored),c=O[r],d=s;return o>1&&(d=s+1),i.a.createElement("div",{style:{}},i.a.createElement("div",{style:{display:"inline-flex",pointerEvents:"auto"}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("span",null,"Round ",s+1)," ")),i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Accuracy: ",f(c.accuracy[s])))),i.a.createElement("div",{style:{position:"relative",width:100*(l+1),height:n-2*a,pointerEvents:"auto"}},i.a.createElement(x,{width:100*(l+1),height:n-2*a,getCtx:this.getCtx,grem:a}),i.a.createElement(i.a.Fragment,null,Object(p.a)(Array(l+1)).map(function(t,r){return i.a.createElement("div",{onClick:function(){e.handleRound(r)},style:{position:"absolute",top:0,left:100*r,width:100,height:n-2*a,cursor:r===s?"default":"pointer"}})}))),i.a.createElement("div",{style:{display:"flex",pointerEvents:"auto",justifyContent:"space-between",padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"100,000 points, ",function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}(c.num_labeled[d])," labelled (",f(c.num_labeled[d]/1e6),")")))}}]),t}(a.Component)),E=(Math.floor(10*Math.random()),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},n.setHeight=n.setHeight.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setFooterHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this,t=this.props,n=t.round,a=t.ww,r=t.grem,s=t.strategies,o=t.strategy_colors,l=t.strategy,c=(t.selectRound,t.color_array_hexes,t.transition_status),d=(t.simulating_labeling,t.gradient_string,n),u=t.strategy_explored;return c>1&&c<2.3&&(d=Math.max(0,d-1),u=Math.max(0,u-1)),i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",bottom:0,left:0,height:7*r,pointerEvents:"none"}},i.a.createElement(k,{width:a,transition_status:c,height:7*r,grem:r,strategies:s,selectRound:this.props.selectRound,strategy_colors:o,strategy:l,round:d,strategy_explored:u}))}}]),t}(a.Component)),S=n(14),C=n(2),M=n(12),A=n(10);var D=Object(p.a)(Array(12)).map(function(e,t){return"".concat("/activelearner","/").concat("mnist_").concat(t,".png")});(new C.i).load("".concat("/activelearner","/circle.png")).flipY=!1;for(var P=[],F=0;F<12;F++){var T=5329*F,H=5329*(F+1);11===F&&(H=63948),P.push([T,H])}var z=10,R=Object(p.a)(Array(z)).map(function(e,t){return m.hsl(0+360/z*t,1,.5).luminance(.5).gl()});R.push(m.hsl(0,0,.5).luminance(.1).gl()),z=10;var U=Object(p.a)(Array(z)).map(function(e,t){return m.hsl(0+360/z*t,1,.5).luminance(.5).hex()}),W=R.map(function(e){return e.slice(0,3)});function L(e,t){return{coordinates:e.coordinates.slice(t[0],t[1]),labels:e.labels.slice(t[0],t[1]),statuses:e.statuses.slice(t[0],t[1])}}function G(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];t.push(a[0],a[1],0)}return new Float32Array(t)}for(var q=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},n.init=n.init.bind(Object(g.a)(Object(g.a)(n))),n.animate=n.animate.bind(Object(g.a)(Object(g.a)(n))),n.addPoints=n.addPoints.bind(Object(g.a)(Object(g.a)(n))),n.transitionPoints=n.transitionPoints.bind(Object(g.a)(Object(g.a)(n))),n.addSelectedPoints=n.addSelectedPoints.bind(Object(g.a)(Object(g.a)(n))),n.labelSelected=n.labelSelected.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getZFromScale",value:function(e){var t=C.d.degToRad(this.camera.fov);return this.props.height/e/(2*Math.tan(t/2))}},{key:"getScaleFromZ",value:function(e){var t=C.d.degToRad(this.camera.fov),n=2*(Math.tan(t/2)*e);return this.props.height/n}},{key:"zoomHandler",value:function(){var e=M.a.transform,t=e.k,n=-(e.x-this.props.width/2)/t,a=(e.y-this.props.height/2)/t,i=this.getZFromScale(t);this.camera.position.set(n,a,i)}},{key:"addPoints",value:function(){var e=this.props,t=e.loaded_embedding,n=e.embeddings;this.scene.children[0]=new C.c;for(var a=n[t],i=P.map(function(e){return L(a,e)}),r=new C.c,s=i.length,o=0;o<s;o++){for(var l=i[o],c=l.coordinates.length,d=new C.b,u=G(l.coordinates),h=new Float32Array(2*c),g=0,p=0,m=c;g<m;g++,p+=2){var b=g%73*28/2048,v=28*Math.floor(g/73)/2048;h[p]=b,h[p+1]=v}var f=l.labels.map(function(e){return W[e]}),y=j.flatten(f),_=new Float32Array(y),w=this.textures[o],O=[1/73,1/73];d.addAttribute("position",new C.a(u,3)),d.addAttribute("offset",new C.a(h,2)),d.addAttribute("color",new C.a(_,3));var x={texture:{value:w},repeat:{value:Object(S.a)(C.j,O)},size:{value:20}},k=new C.h({uniforms:x,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new C.f(d,k);r.add(E)}this.scene.children[0]=r}},{key:"transitionPoints",value:function(e,t){for(var n=this,a=this.scene.children[0],i=this.scene.children[1].children,r=t[e],s=P.map(function(e){return L(r,e)}),o=s.length,l=function(e){var t=a.children[e],r=s[e],o=t.geometry.attributes.position.array.slice(),l=G(r.coordinates),c=new A.Tween(o).to(l,800).easing(A.Easing.Linear.None);c.onUpdate(function(){t.geometry.attributes.position.array=o,t.geometry.attributes.position.needsUpdate=!0}),c.start();var d=i[e],u=Array.from(d.geometry.attributes.indexes.array),h=d.geometry.attributes.position.array.slice(),g=G(u.map(function(e){return r.coordinates[e]})),p=new Float32Array(g),m={value:30},b=n,v=new A.Tween(m).to({value:0},400).easing(A.Easing.Linear.None).delay(400).onComplete(function(){0===e&&(b.addSelectedPoints(),b.props.setTransitionStatus(0))});v.onUpdate(function(){d.material.uniforms.size=m});var f=new A.Tween(h).to(p,800).easing(A.Easing.Linear.None);f.onUpdate(function(){d.geometry.attributes.position.array=h,d.geometry.attributes.position.needsUpdate=!0}),f.onComplete(function(){0===e&&setTimeout(function(){b.addPoints(),d.material.uniforms.size.value>0?b.props.setTransitionStatus(2.6):(b.addSelectedPoints(),b.props.setTransitionStatus(0))},0)}),d.material.uniforms.size.value>0&&f.chain(v),f.start()},c=0;c<o;c++)l(c)}},{key:"addSelectedPoints",value:function(){var e=this,t=this.props,n=t.loaded_embedding,a=t.embeddings;this.scene.children[1]=new C.c;for(var i=a[n],r=P.map(function(e){return L(i,e)}),s=new C.c,o=r.length,l=function(t){for(var n=r[t],a=[],i=0;i<n.statuses.length;i++)1===n.statuses[i]&&a.push(i);for(var o=new Float32Array(a),l=a.length,c=new C.b,d=G(a.map(function(e){return n.coordinates[e]})),u=new Float32Array(2*l),h=0,g=0,p=l;h<p;h++,g+=2){var m=a[h],b=m%73*28/2048,v=28*Math.floor(m/73)/2048;u[g]=b,u[g+1]=v}var f=a.map(function(e){return[1,1,1]}),y=j.flatten(f),_=new Float32Array(y),w=e.textures[t],O=[1/73,1/73];c.addAttribute("position",new C.a(d,3)),c.addAttribute("offset",new C.a(u,2)),c.addAttribute("color",new C.a(_,3)),c.addAttribute("indexes",new C.a(o,1));var x={texture:{value:w},repeat:{value:Object(S.a)(C.j,O)},size:{value:0}},k=new C.h({uniforms:x,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new C.f(c,k);s.add(E)},c=0;c<o;c++)l(c);this.scene.children[1]=s}},{key:"revealSelected",value:function(){for(var e=this,t={value:0},n={value:30},a=this.scene.children[1].children,i=function(i){var r=a[i],s=new A.Tween(t).to(n,400).easing(A.Easing.Linear.None);s.onUpdate(function(){r.material.uniforms.size=t});var o=e;s.onComplete(function(){0===i&&o.props.setTransitionStatus(1)}),s.start()},r=0;r<a.length;r++)i(r)}},{key:"labelSelected",value:function(){var e=this.props,t=e.loaded_embedding,n=e.embeddings;console.log(t);for(var a=n[t],i=P.map(function(e){return L(a,e)}),r=this.scene.children[1].children,s=function(e){var t=i[e],n=r[e],a=Array.from(n.geometry.attributes.indexes.array),s=r[e].geometry.attributes.color.array.slice(),o=a.map(function(e){var n=t.labels[e];return W[n]}),l=j.flatten(o),c=new Float32Array(l),d=new A.Tween(s).to(c,400).easing(A.Easing.Linear.None),u=r[e];d.onUpdate(function(){u.geometry.attributes.color.array=s,u.geometry.attributes.color.needsUpdate=!0}),d.start()},o=0;o<i.length;o++)s(o)}},{key:"componentDidUpdate",value:function(e){var t=this;if(null===e.loaded_embedding&&null!==this.props.loaded_embedding)Promise.all(function(e){var t=new C.i;return e.map(function(e){return new Promise(function(n,a){t.load(e,function(e){e.flipY=!1,n(e)},void 0,function(e){return a(e)})})})}(D)).then(function(e){t.textures=e,t.addPoints(),t.addSelectedPoints()});else if(e.loaded_embedding!==this.props.loaded_embedding){var n=w(e.loaded_embedding),a=w(this.props.loaded_embedding);n.dataset!==a.dataset?console.log("different dataset"):n.strategy!==a.strategy?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):n.round!==a.round&&1.5!==this.props.transition_status&&this.transitionPoints(this.props.loaded_embedding,this.props.embeddings)}else.5===this.props.transition_status&&0===e.transition_status?this.revealSelected():2===this.props.transition_status&&1.5===e.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===e.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):(this.props.round,e.round)}},{key:"init",value:function(){var e=this.props,t=e.width,n=e.height;this.scene=new C.g;var a=t/n;this.camera=new C.e(75,a,.01,1e3),this.camera.position.z=30,this.renderer=new C.k,this.renderer.setClearColor(1118481,1),this.renderer.setSize(t,n),this.mount.appendChild(this.renderer.domElement);var i=new C.c;this.scene.add(i);var r=new C.c;this.scene.add(r),this.d3_zoom=M.d().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var s=M.c(this.mount);this.view=s,s.call(this.d3_zoom);var o=this.getScaleFromZ(this.camera.position.z),l=M.e.translate(t/2,n/2).scale(o);this.d3_zoom.transform(s,l),this.animate()}},{key:"animate",value:function(){requestAnimationFrame(this.animate),A.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,r=t.grem;return i.a.createElement("div",{style:{position:"absolute",left:0,width:n,height:a,background:"#222",overflow:"hidden"},grem:r},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:n,height:a},ref:function(t){e.mount=t}}),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"auto",padding:"0 ".concat(r/4,"px"),position:"absolute",left:0,bottom:this.props.footer_height+r}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Labels:"),i.a.createElement("div",{style:{background:"#888",color:"#111",width:r,height:r,textAlign:"center"}},"?"),U.map(function(e,t){return i.a.createElement("div",{style:{background:U[t],height:r,textAlign:"center",color:"#111",width:r}},t)})))}}]),t}(a.Component),I=(Object(p.a)(Array(40)).map(function(e){return null}),Object(p.a)(Array(12)).map(function(e,t){return"".concat("/activelearner","/").concat("mnist_").concat(t,".png")})),N=Object(p.a)(Array(10)).map(function(e,t){return m.hsl(0+36*t,1,.5).luminance(.5).hex()}),Z=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={labels:null,prev_loaded:null},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.embeddings;if(this.props.loaded_embedding!==e.loaded_embedding)if(null===e.loaded_embedding)this.setState({prev_loaded:this.props.loaded_embedding});else{for(var a=n[e.loaded_embedding],i=[],r=0;r<a.statuses.length;r++)1===a.statuses[r]&&i.push(r);var s=n[this.props.loaded_embedding],o=i.map(function(e,t){return s.labels[e]});this.setState({labels:o})}if(0===this.props.transition_status&&0!==e.transition_status){var l=this;setTimeout(function(){l.setState({prev_loaded:t.props.loaded_embedding,labels:null})},800)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,r=t.grem,s=t.embeddings,o=t.loaded_embedding,l=t.transition_status,c=t.header_height,d=[],u=s[this.state.prev_loaded];if(u)for(var h=0;h<u.statuses.length;h++)1===u.statuses[h]&&d.push(h);var g=r/4,p=r/4,m=(n-2*p*2-3*g)/4,b=m,v=d.map(function(e){var t=e%5329;return[Math.floor(e/5329),t%73,Math.floor(t/73)]});null!==o&&d.map(function(e,t){return s[o].labels[t]});var f=m/28;return i.a.createElement("div",{style:{position:"absolute",right:0,top:c,width:n,height:a,background:"#333",overflow:"hidden"}},0===l?i.a.createElement("div",{style:{padding:r/4}},i.a.createElement("div",{style:{padding:r/4}},"Use the select data button below to select data points based on the strategy.")):null,i.a.createElement("div",{style:{opacity:0===l||2.6===l?0:1,transition:"opacity 0.4s linear",padding:r/2,position:"relative"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",position:"absolute",left:0,top:0,width:n,background:"#444",padding:"".concat(r/4,"px ").concat(r/2,"px")}},i.a.createElement("div",null,"Selected:"),i.a.createElement("div",null,"1,000")),i.a.createElement("div",{style:{right:0,top:c,width:n,height:a-r/2,paddingTop:1*r,background:"#333",overflow:"auto"}},i.a.createElement("div",{style:{display:"grid",paddingTop:2*p,paddingBottom:2*p,gridTemplateColumns:"repeat(".concat(4,", ").concat(m,"px)"),gridColumnGap:g,gridRowGap:2*g}},v.length>0?v.map(function(t,n){var a=null!==e.state.labels&&e.props.transition_status>1.5?e.state.labels[n]:"?",s=null!==e.state.labels&&e.props.transition_status>1.5?N[e.state.labels[n]]:"#bbb";return i.a.createElement("div",{style:{width:m,height:b+r,background:s,color:"#111",textAlign:"center",transition:"background 400ms linear"}},i.a.createElement("div",{style:{backgroundImage:"url(".concat(I[t[0]],")"),backgroundSize:"".concat(2048*f,"px ").concat(2048*f,"px"),backgroundPosition:"-".concat(t[1]*f*28,"px -").concat(t[2]*f*28,"px"),width:m,height:b,imageRendering:"pixelated"}}),i.a.createElement("div",null,a))}):null))))}}]),t}(a.Component),B=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,a=e.grem,r=e.strategies,s=e.strategy_colors,o=e.strategy,l=e.active_embedding,c=e.requested_embedding,d=e.loaded_embedding,u=e.embeddings,h=e.mnist_images,g=e.ranges,p=e.transition_status,m=e.setTransitionStatus,b=e.loading_round,v=e.header_height,f=e.footer_height,y=e.round;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(q,{width:t,height:n,grem:a,active_embedding:l,strategies:r,strategy_colors:s,strategy:o,embeddings:u,requested_embedding:c,loaded_embedding:d,transition_status:p,setTransitionStatus:m,loading_round:b,footer_height:f,round:y}),i.a.createElement(Z,{width:200,height:n-this.props.footer_height-2*a-v,grem:a,mnist_images:h,embeddings:u,loaded_embedding:d,ranges:g,transition_status:p,header_height:v}))}}]),t}(a.Component),J=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t,n=this,a=this.props,r=a.transition_status,s=a.grem,o=a.round_limit,l=a.round;0===r?(e="Select data",t=.5):.5===r?(e="Selecting...",t=null):1===r?(e="Get labels",t=1.5):1.5===r?(e="Labeling...",t=null):2===r?(e="Retrain model",t=2.3):2.3===r?(e="Retraining...",t=null):2.6===r&&(e="Deselecting...",t=null);var c=l;return r>1&&r<2.3&&(c=Math.max(0,c-1)),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",background:"#111",position:"absolute",bottom:this.props.footer_height,right:0}},i.a.createElement("div",null,o!==c?i.a.createElement("button",{style:{width:200,height:2*s,background:null===t?"#eee":"white",color:"black",textAlign:"left",paddingLeft:s/2,cursor:null===t?"default":"pointer",textDecoration:null===t?"none":"underline"},disabled:null===t,onClick:function(){null!==t&&n.props.setTransitionStatus(t)}},e):null))}}]),t}(a.Component),V=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={count:0},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=0,t=0,n=this;function a(){e+=25;var i=Math.floor(e);i!==t&&(t=i),n.setState({count:t}),t<1e3?requestAnimationFrame(a):setTimeout(function(){n.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(a)},200)}},{key:"render",value:function(){var e=this.props,t=e.grem,n=e.ww;return i.a.createElement("div",null,i.a.createElement("div",{style:{height:t,width:"".concat(100,"%"),marginTop:t/2,background:"#222"}},i.a.createElement("div",{style:{height:t,width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},i.a.createElement("div",{style:{height:t,width:Math.min(500,n)-2*t,background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),t}(a.Component),Y=4,Q=Object(p.a)(Array(Y)).map(function(e,t){return m.hsl(90/Y*t-45,1,.5).luminance(.5).hex()}),$=[],K=0;K<12;K++){var X=5329*K,ee=5329*(K+1);11===K&&(ee=63948),$.push([X,ee])}var te=Object(p.a)(Array(12)).map(function(e,t){return"".concat("/activelearner","/").concat("mnist_").concat(t,".png")}).map(function(e){var t=document.createElement("img");return t.src=e,t});Y=10;var ne=Object(p.a)(Array(Y)).map(function(e,t){return m.hsl(0+360/Y*t,1,.5).luminance(.5).hex()}),ae=ne.reduce(function(e,t,n){return e+t+" "+Math.round(n/Y*100)+(n===Y-1?"%":"%, ")},""),ie=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1},n.setSize=n.setSize.bind(Object(g.a)(Object(g.a)(n))),n.setHeaderHeight=n.setHeaderHeight.bind(Object(g.a)(Object(g.a)(n))),n.setFooterHeight=n.setFooterHeight.bind(Object(g.a)(Object(g.a)(n))),n.setTransitionStatus=n.setTransitionStatus.bind(Object(g.a)(Object(g.a)(n))),n.labelsGotten=n.labelsGotten.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setHeaderHeight",value:function(e){this.setState({header_height:e})}},{key:"setFooterHeight",value:function(e){this.setState({footer_height:e})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(e,t){!0===this.state.loading_round&&e.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(e){1.5===e?(this.setState({transition_status:e,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:e})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var e=this.state,t=e.ww,n=e.wh,a=e.header_height,r=e.footer_height,s=e.loading_round,o=e.simulating_labeling,l=e.transition_status,c=this.props,d=c.dataset,u=c.strategy,h=c.round,g=c.datasets,p=c.strategies,m=c.selectDataset,b=c.selectStrategy,f=c.embeddings,y=c.requested_embedding,w=c.loaded_embedding,O=c.strategy_explored;return null===t?i.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):i.a.createElement("div",{style:{width:t,height:n,overflow:"hidden",position:"relative"}},i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",top:0,right:0,background:"red",padding:10.5,zIndex:999,display:"none"}},l),null!==r&&null!==a?i.a.createElement("div",{style:{background:"white",height:n}},i.a.createElement(B,{width:t,height:n,grem:21,strategies:p,strategy_colors:Q,strategy:u,embeddings:f,requested_embedding:y,loaded_embedding:w,loading_round:s,mnist_images:te,ranges:$,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:r,round:h,header_height:a})):null,null!==r?i.a.createElement(J,{transition_status:this.state.transition_status,grem:21,footer_height:r,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:h}):null,i.a.createElement(v,{datasets:g,selectDataset:m,strategies:p,strategy:u,strategy_colors:Q,selectStrategy:b,dataset:d,activeStyle:_,setHeaderHeight:this.setHeaderHeight,gradient_string:ae,grem:21,transition_status:this.state.transition_status}),null!==a?i.a.createElement(E,{round:h,ww:t,grem:21,strategies:p,strategy_colors:Q,strategy:u,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:ae,color_array_hexes:ne,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:o,strategy_explored:O}):null,this.state.simulating_labeling?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center"}},i.a.createElement("div",{style:{width:Math.min(500,t),background:"#666",padding:21}},i.a.createElement("div",null,"Getting labels for 1,000 selected points..."),i.a.createElement(V,{grem:21,gradient_string:ae,ww:t,labelsGotten:this.labelsGotten}))):null))}}]),t}(a.Component),re=["MNIST","Quickdraw","Caltech"],se=["random","entropy","deepfool","ensemble"],oe=["mnist_random_round","mnist_entropy_round","mnist_deepfool_round","mnist_ensemble_entropy_round"];function le(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}var ce=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={embeddings:{},dataset:re[0],strategy:se[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0},n.scaleEmbeddings=n.scaleEmbeddings.bind(Object(g.a)(Object(g.a)(n))),n.fetchData=n.fetchData.bind(Object(g.a)(Object(g.a)(n))),n.checkOrFetchData=n.checkOrFetchData.bind(Object(g.a)(Object(g.a)(n))),n.selectRound=n.selectRound.bind(Object(g.a)(Object(g.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"selectRound",value:function(e){var t=Math.max(this.state.strategy_explored,e);this.setState({round:e,strategy_explored:t}),this.checkOrFetchData(this.state.dataset,this.state.strategy,e)}},{key:"selectDataset",value:function(e){this.setState({dataset:re[e],strategy_explored:0}),this.checkOrFetchData(re[e],this.state.strategy,this.state.round)}},{key:"selectStrategy",value:function(e){this.setState({strategy:se[e]}),this.checkOrFetchData(this.state.dataset,se[e],this.state.round)}},{key:"checkOrFetchData",value:function(e,t,n){var a=this.state.embeddings,i=le(e,t,n);this.setState({requested_embedding:i}),void 0!==a[i]?this.setState({loaded_embedding:i}):this.fetchData(e,t,n)}},{key:"scaleEmbeddings",value:function(e){var t=e.map(function(e){return Math.abs(e[0])}),n=e.map(function(e){return Math.abs(e[1])}),a=j.max(t),i=j.max(n),r=Math.max(a,i),s=M.b().domain([-r,r]).range([-20,20]);return e.map(function(e){return[s(e[0]),s(e[1])]})}},{key:"fetchData",value:function(e,t,n){var a=this,i="".concat("/activelearner","/").concat(oe[se.indexOf(t)]).concat(n,".json");fetch(i).then(function(e){return e.json()}).then(function(i){var r=i.coordinates,s=r.map(function(e){return Math.abs(e[0])}),o=r.map(function(e){return Math.abs(e[1])}),l=j.max(s),c=j.max(o),d=Math.max(l,c),u=M.b().domain([-d,d]).range([-20,20]),g=r.map(function(e){return[u(e[0]),u(e[1])]}),p={};p.coordinates=g,p.statuses=i.status,p.labels=i.labels;var m=le(e,t,n);a.setState({loaded_embedding:m,embeddings:Object.assign({},a.state.embeddings,Object(h.a)({},m,p))})})}},{key:"componentDidMount",value:function(){var e=this.state,t=e.dataset,n=e.strategy,a=e.round;this.checkOrFetchData(t,n,a)}},{key:"render",value:function(){return i.a.createElement(ie,Object.assign({},this.state,{datasets:re,strategies:se,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this)}))}}]),t}(a.Component),de=(n(28),function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(ce,null)}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.215eb3f7.chunk.js.map