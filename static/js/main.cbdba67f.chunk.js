(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(t,e,n){t.exports=n(31)},26:function(t,e,n){},29:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(20),o=n.n(i),s=(n(26),n(3)),c=n(4),l=n(7),d=n(5),u=n(6),h=n(1),p=n(12),g=n(8),m=n(11),v=function(t){return"string"!==typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},f=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setHeaderHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.datasets,a=e.selectDataset,i=e.strategies,o=e.strategy,s=(e.strategy_colors,e.selectStrategy),c=e.dataset,l=(e.activeStyle,e.grem);return r.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},r.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px 0 ").concat(l/2,"px"),pointerEvents:"all"}},r.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px"),fontWeight:"bold"}},"Active Learner")),r.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px"),pointerEvents:"all"}},r.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px")}},"Dataset:"),n.map(function(t,e){var n,i=t===c;return n=i?r.a.createElement("span",null,t):r.a.createElement("button",{onClick:function(){a(e)}},t),r.a.createElement("span",{key:t,style:{padding:"0 ".concat(l/4,"px"),background:i?"white":"transparent",color:i?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})),r.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px"),pointerEvents:"all"}},r.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px")}},"Strategy:"),i.map(function(t,e){var n,a=t===o;return n=a?r.a.createElement("span",null,v(t)):r.a.createElement("button",{onClick:function(){s(e)}},v(t)),r.a.createElement("span",{key:t,style:{padding:"0 ".concat(l/4,"px"),background:a?"white":"transparent",color:a?"black":"white"}},n)}).reduce(function(t,e){return[t," ",e]})))}}]),e}(a.Component);function b(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}function y(t){return Math.round(1e4*t)/100+"%"}function _(t,e,n,a){a?t.moveTo(e,n):t.lineTo(e,n)}function x(t){return{background:t,boxShadow:"-0.25em 0 0 ".concat(t,", 0.25em 0 0 ").concat(t),textDecoration:"none"}}function w(t){var e=t.split("-");return{dataset:e[0],strategy:e[1],round:e[2]}}var O={MNIST:[0,1,2,3,4,5,6,7,8,9],Quickdraw:["dolphin","cat","face","angel","airplane","apple","broccoli","crayon","bicycle","elephant"],Caltech:["cake","dolphin","elephant","golden gate bridge","goldfish","rainbow","teapot","teddy bear","washing machine","waterfall"]},j=function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return r.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},r.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),e}(a.Component),k=n(9),E={MNIST:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.923,.9468,.9379,.9551,.9558,.955,.958,.9664,.9635]},entropy:{accuracy:[.923,.9485,.9589,.96,.9744,.9702,.9774,.9764,.9782]},adversarial:{accuracy:[.923,.9534,.9558,.9691,.9743,.9716,.9775,.9801,.9795]},ensemble:{accuracy:[.923,.9554,.967,.9731,.9748,.979,.9812,.9848,.9829]}},Quickdraw:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.7685568264784619,.8011681674373327,.7949622779265028,.8040885860306644,.8141275249452421,.823192990995376,.8260525675346799,.831284984181066,.8297639328303723]},entropy:{accuracy:[.7685568264784619,.7963008031151132,.7894256510099781,.8050012168410805,.8212460452664881,.8202725724020443,.8123631053784376,.8289729861280117,.8267826721830129]},adversarial:{accuracy:[.7685568264784619,.7963008031151132,.7894256510099781,.8050012168410805,.8212460452664881,.8202725724020443,.8123631053784376,.8289729861280117,.8267826721830129]},ensemble:{accuracy:[.7685568264784619,.8283037235337065,.8426624482842541,.83603066439523,.8523971769286931,.8506935994159163,.8619493794110489,.8623752737892432,.8586639084935508]}},Caltech:{num_labeled:[300,350,400,450,500,550,600,650,700],random:{accuracy:[.7547169811320755,.7971698113207547,.8490566037735849,.8632075471698113,.8490566037735849,.8726415094339622,.8915094339622641,.8584905660377359,.910377358490566]},entropy:{accuracy:[.7547169811320755,.8349056603773585,.8066037735849056,.8490566037735849,.8632075471698113,.8773584905660378,.8773584905660378,.9056603773584906,.8726415094339622]},adversarial:{accuracy:[.7547169811320755,.7971698113207547,.8537735849056604,.8867924528301887,.8679245283018868,.8726415094339622,.8773584905660378,.8584905660377359,.9056603773584906]},ensemble:{accuracy:[.7547169811320755,.9339622641509434,.9339622641509434,.9292452830188679,.9339622641509434,.9481132075471698,.9292452830188679,.9339622641509434,.9245283018867925]}}},S={MNIST:6e4,Quickdraw:65729,Caltech:822},C=(Object(g.a)(Array(4)).map(function(t){return Object(g.a)(Array(5)).map(function(t){return Math.random()})}),function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={show_tip:null},n.ctx=null,n.getCtx=n.getCtx.bind(Object(h.a)(Object(h.a)(n))),n.draw=n.draw.bind(Object(h.a)(Object(h.a)(n))),n.handleRound=n.handleRound.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"getCtx",value:function(t){this.ctx=t.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(t){this.props.strategy_explored!==t.strategy_explored&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(t){t!==this.props.round&&this.props.selectRound(t)}},{key:"handleEnter",value:function(t){this.setState({show_tip:t})}},{key:"handleLeave",value:function(){this.setState({show_tip:null})}},{key:"draw",value:function(){var t=this.props,e=(t.width,t.height),n=t.strategies,a=(t.strategy_colors,t.round),r=t.strategy,i=t.grem,o=t.transition_status,s=t.strategy_explored,c=t.dataset,l=E[c],d=l[r];e-=2*i,3===o&&(a+=1);var u=this.ctx,h=4,p=n.map(function(t){return k.min(l[t].accuracy)}),g=Math.floor(10*k.min(p))/10,m=1-g;u.clearRect(0,0,100*(s+1),e);var v=2*h;e-=2*v,u.fillStyle="rgba(100,100,100,0.3)",u.fillRect(100*a,v,100,e),u.lineWidth=3,u.strokeStyle="rgba(100,100,100,0.5)";for(var f=0;f<m+.05;f+=.05){u.beginPath();var b=f/m*e;_(u,0,b+v,!0),_(u,100*(s+1),b+v,!1),u.stroke()}var y=n.filter(function(t){return t!==r}),x=!0,w=!1,O=void 0;try{for(var j,S=y[Symbol.iterator]();!(x=(j=S.next()).done);x=!0){var C=j.value,M=l[C];u.lineWidth=2,u.strokeStyle="#666",u.fillStyle="#666",u.beginPath();for(var T=0;T<s+1;T++){_(u,100*T+50,e-(M.accuracy[T]-g)/(1-g)*e+v,0===T)}u.stroke();for(var A=0;A<s+1;A++){var z=(M.accuracy[A]-g)/(1-g);u.beginPath(),u.arc(100*A+50,e-z*e+v,h,0,2*Math.PI),u.fill()}}}catch(H){w=!0,O=H}finally{try{x||null==S.return||S.return()}finally{if(w)throw O}}h=6,u.lineWidth=2,u.strokeStyle="#efefef",u.fillStyle="#efefef",u.beginPath();for(var D=0;D<s+1;D++){_(u,100*D+50,e-(d.accuracy[D]-g)/(1-g)*e+v,0===D)}u.stroke();for(var P=0;P<s+1;P++){var F=(d.accuracy[P]-g)/(1-g);u.beginPath(),u.arc(100*P+50,e-F*e+v,h,0,2*Math.PI),u.fill()}}},{key:"render",value:function(){var t=this,e=this.props,n=(e.width,e.height),a=e.grem,i=e.strategies,o=e.strategy,s=e.round,c=e.transition_status,l=(e.adjusted_round,e.strategy_explored),d=e.round_limit,u=e.dataset,h=this.state.show_tip,m=E[u].num_labeled,v=E[u][o],f=s;c>1&&(f=s+1),f=s;var _=E[u];return r.a.createElement("div",{style:{}},r.a.createElement("div",{style:{display:"inline-flex",pointerEvents:"auto"}},r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},r.a.createElement("span",null,"Round ",s+1," of ",d+1)," ")),r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Accuracy: ",(100*v.accuracy[s]).toFixed(2),"% (+",y(v.accuracy[s]-v.accuracy[0]),")")),r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px"),display:"none"}},r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Relative Error Reduction: ".concat((100*(1-(1-v.accuracy[s])/(1-v.accuracy[0]))).toFixed(2)),"%"))),r.a.createElement("div",{style:{position:"relative",width:100*(l+1),height:n-2*a,pointerEvents:"auto"}},r.a.createElement(j,{width:100*(l+1),height:n-2*a,getCtx:this.getCtx,grem:a}),r.a.createElement(r.a.Fragment,null,Object(g.a)(Array(l+1)).map(function(e,c){var l=i.map(function(t,e){return{string:"".concat(t,": ").concat(y(_[t].accuracy[c])),strategy:t,value:_[t].accuracy[c]}});return l=k.sortBy(l,"value").reverse(),r.a.createElement("div",{key:"explored"+c,onMouseEnter:t.handleEnter.bind(t,c),onMouseLeave:t.handleLeave.bind(t),onClick:function(){t.handleRound(c)},style:{position:"absolute",top:0,left:100*c,width:100,height:n-2*a,cursor:c===s?"default":"pointer"}},h===c?r.a.createElement("div",{style:{position:"absolute",left:0,bottom:n-1.5*a,background:"#333",padding:a/2,whiteSpace:"nowrap",pointerEvents:"none"}},r.a.createElement("div",{style:{color:"#fff"}},"Round ",c+1),l.map(function(t){return r.a.createElement("div",{style:{textTransform:"capitalize",color:o===t.strategy?"#fff":"#aaa",fontSize:a/1.5*.9,display:"flex",marginBottom:a/8}},r.a.createElement("div",{style:{marginRight:a/4}},t.strategy,":"),r.a.createElement("div",{style:{textAlign:"right",flexGrow:1}},(100*t.value).toFixed(2),"%"))})):null)}),r.a.createElement("div",{style:Object(p.a)({position:"absolute",top:8,left:100*(l+1),width:100*(d-l),height:n-2*a-16,border:"solid 2px rgba(100,100,100,0.2)",pointerEvents:"auto",borderLeft:"none"},"pointerEvents","none")}))),r.a.createElement("div",{style:{display:"flex",pointerEvents:"auto",justifyContent:"space-between",padding:"0 ".concat(a/4,"px")}},r.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},b(S[this.props.dataset])," points,"," ",b(m[f])," labelled (",y(m[f]/S[this.props.dataset]),")")))}}]),e}(a.Component)),M=(Math.floor(10*Math.random()),function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={},n.setHeight=n.setHeight.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"setHeight",value:function(){var t=this.divElement.clientHeight;this.props.setFooterHeight(t)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var t=this,e=this.props,n=e.round,a=e.ww,i=e.grem,o=e.strategies,s=e.strategy_colors,c=e.strategy,l=(e.selectRound,e.color_array_hexes,e.transition_status),d=(e.simulating_labeling,e.gradient_string,e.strategy_explored),u=e.round_limit,h=e.dataset,p=n,g=d;return l>1&&l<2.3&&(p=Math.max(0,p-1),g=Math.max(0,g-1)),r.a.createElement("div",{ref:function(e){t.divElement=e},style:{position:"absolute",bottom:2*i,left:0,height:7*i,pointerEvents:"none"}},r.a.createElement(C,{width:a,transition_status:l,height:7*i,grem:i,strategies:o,selectRound:this.props.selectRound,dataset:h,strategy_colors:s,strategy:c,round:p,strategy_explored:g,round_limit:u}))}}]),e}(a.Component)),T=n(15),A=n(16),z=n(2),D=n(13),P=n(10);function F(t){var e=new z.j;return t.map(function(t){return new Promise(function(n,a){e.load(t,function(t){t.flipY=!1,n(t)},void 0,function(t){return a(t)})})})}var H={sprite_side:73,sprite_size:5329,sprite_number:12,sprite_image_size:28},R=Object.assign({},H,{sprite_number:13}),L=Object.assign({},H,{sprite_side:9,sprite_size:81,sprite_number:11,sprite_image_size:224}),I={MNIST:H,Quickdraw:R,Caltech:L},W={MNIST:30,Quickdraw:30,Caltech:30};(new z.j).load("".concat("","/circle.png")).flipY=!1;var N=Object(g.a)(Array(H.sprite_number)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")}),U=Object(g.a)(Array(R.sprite_number)).map(function(t,e){return"".concat("","/").concat("QUICKDRAW_").concat(e,".png")}),Q=Object(g.a)(Array(L.sprite_number)).map(function(t,e){return"".concat("","/").concat("CALTECH_").concat(e,".png")}),q={MNIST:N,Quickdraw:U,Caltech:Q},G={MNIST:N.map(function(t){var e=document.createElement("img");return e.src=t,e}),Quickdraw:U.map(function(t){var e=document.createElement("img");return e.src=t,e}),Caltech:Q.map(function(t){var e=document.createElement("img");return e.src=t,e})};function B(t){for(var e=[],n=I[t],a=n.sprite_number,r=n.sprite_size,i=0;i<a;i++){var o=i*r,s=(i+1)*r;i===a-1&&(s=a*r),e.push([o,s])}return e}function Z(t){var e=O[t].length,n=Object(g.a)(Array(e)).map(function(t,n){return m.hsl(0+360/e*n,1,.5).luminance(.5).gl()});n.push(m.hsl(0,0,.5).luminance(.1).gl());var a=Object(g.a)(Array(e)).map(function(t,n){return m.hsl(0+360/e*n,1,.5).luminance(.5).hex()}),r=n.map(function(t){return t.slice(0,3)});return{color_array:n,color_array_hexes:a,status_to_color:r}}function K(t,e){return{coordinates:t.coordinates.slice(e[0],e[1]),labels:t.labels.slice(e[0],e[1]),statuses:t.statuses.slice(e[0],e[1])}}function J(t){for(var e=[],n=0;n<t.length;n++){var a=t[n];e.push(a[0],a[1],0)}return new Float32Array(e)}for(var V=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={color_array:null,color_array_hexes:null,status_to_color:null},n.init=n.init.bind(Object(h.a)(Object(h.a)(n))),n.animate=n.animate.bind(Object(h.a)(Object(h.a)(n))),n.addPoints=n.addPoints.bind(Object(h.a)(Object(h.a)(n))),n.transitionPoints=n.transitionPoints.bind(Object(h.a)(Object(h.a)(n))),n.addSelectedPoints=n.addSelectedPoints.bind(Object(h.a)(Object(h.a)(n))),n.labelSelected=n.labelSelected.bind(Object(h.a)(Object(h.a)(n))),n.showHover=n.showHover.bind(Object(h.a)(Object(h.a)(n))),n.hover_ctx=null,n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"getZFromScale",value:function(t){var e=z.d.degToRad(this.camera.fov);return this.props.height/t/(2*Math.tan(e/2))}},{key:"getScaleFromZ",value:function(t){var e=z.d.degToRad(this.camera.fov),n=2*(Math.tan(e/2)*t);return this.props.height/n}},{key:"zoomHandler",value:function(){var t=D.a.transform,e=t.k,n=-(t.x-this.props.width/2)/e,a=(t.y-this.props.height/2)/e,r=this.getZFromScale(e);this.camera.position.set(n,a,r)}},{key:"addPoints",value:function(){var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings;this.scene.children[0]=new z.c;for(var r=a[n],i=B(this.props.dataset).map(function(t){return K(r,t)}),o=new z.c,s=I[this.props.dataset],c=s.sprite_side,l=s.sprite_image_size,d=i.length,u=0;u<d;u++){for(var h=i[u],p=h.coordinates.length,g=new z.b,m=J(h.coordinates),v=new Float32Array(2*p),f=0,b=0,y=p;f<y;f++,b+=2){var _=f%c*l/2048,x=Math.floor(f/c)*l/2048;v[b]=_,v[b+1]=x}var w=h.labels.map(function(e){return t.state.status_to_color[e]}),O=k.flatten(w),j=new Float32Array(O),E=1/c,S=this.textures[u],C=[E,E];g.addAttribute("position",new z.a(m,3)),g.addAttribute("offset",new z.a(v,2)),g.addAttribute("color",new z.a(j,3));var M={texture:{value:S},repeat:{value:Object(A.a)(z.k,C)},size:{value:W[this.props.dataset]}},T="\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }";"Caltech"===this.props.dataset&&(T="\n          uniform sampler2D texture;\n          uniform vec2 repeat;\n          varying vec2 vOffset;\n          varying vec3 vColor;\n          void main() {\n            vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n            // vec4 tex = texture2D( texture, uv * repeat );\n            vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n            // if ( tex.r < 0.5 ) discard;\n            if ( uv[0] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[0] > 0.9 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] > 0.9 ) tex = vec4(vColor, 1.0);\n            // tex.r = 1.0;\n            // tex.g = 1.0;\n            // tex.b = 1.0;\n            gl_FragColor = tex;\n        }");var D=new z.i({uniforms:M,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:T}),P=new z.f(g,D);P.userData={sprite_index:u},o.add(P)}this.scene.children[0]=o}},{key:"transitionPoints",value:function(t,e,n){for(var a=this,r=this.scene.children[0],i=this.scene.children[1].children,o=e[t],s=B(this.props.dataset).map(function(t){return K(o,t)}),c=s.length,l=function(t){var e=r.children[t],o=s[t],c=e.geometry.attributes.position.array.slice(),l=J(o.coordinates),d=e.geometry.attributes.color.array.slice(),u=o.labels.map(function(t){return a.state.status_to_color[t]}),h=k.flatten(u),p=new Float32Array(h),g=new P.Tween(d).to(p,400).easing(P.Easing.Linear.None);g.onUpdate(function(){e.geometry.attributes.color.array=d,e.geometry.attributes.color.needsUpdate=!0}),g.delay(400);var m=new P.Tween(c).to(l,800).easing(P.Easing.Linear.None);m.onUpdate(function(){e.geometry.attributes.position.array=c,e.geometry.attributes.position.needsUpdate=!0}),m.start().chain(g);var v=i[t],f=Array.from(v.geometry.attributes.indexes.array),b=v.geometry.attributes.position.array.slice(),y=J(f.map(function(t){return o.coordinates[t]})),_=new Float32Array(y),x=1200;n||(x=400);var w={value:W[a.props.dataset]},O=a,j=new P.Tween(w).to({value:0},400).easing(P.Easing.Linear.None).delay(x).onComplete(function(){0===t&&(O.addSelectedPoints(),O.props.setTransitionStatus(.5))});j.onUpdate(function(){v.material.uniforms.size=w});var E=new P.Tween(b).to(_,800).easing(P.Easing.Linear.None);E.onUpdate(function(){v.geometry.attributes.position.array=b,v.geometry.attributes.position.needsUpdate=!0}),E.onComplete(function(){0===t&&setTimeout(function(){v.material.uniforms.size.value>0?O.props.setTransitionStatus(2.6):(O.addSelectedPoints(),O.props.setTransitionStatus(0))},0)}),v.material.uniforms.size.value>0&&E.chain(j),E.start()},d=0;d<c;d++)l(d)}},{key:"addSelectedPoints",value:function(){var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings;this.scene.children[1]=new z.c;for(var r=a[n],i=I[this.props.dataset],o=i.sprite_side,s=i.sprite_image_size,c=B(this.props.dataset).map(function(t){return K(r,t)}),l=new z.c,d=c.length,u=function(e){for(var n=c[e],a=[],r=0;r<n.statuses.length;r++)1===n.statuses[r]&&a.push(r);for(var i=new Float32Array(a),d=a.length,u=new z.b,h=J(a.map(function(t){return n.coordinates[t]})),p=new Float32Array(2*d),g=0,m=0,v=d;g<v;g++,m+=2){var f=a[g],b=f%o*s/2048,y=Math.floor(f/o)*s/2048;p[m]=b,p[m+1]=y}var _=a.map(function(t){return[.85,.85,.85]}),x=k.flatten(_),w=new Float32Array(x),O=1/o,j=t.textures[e],E=[O,O];u.addAttribute("position",new z.a(h,3)),u.addAttribute("offset",new z.a(p,2)),u.addAttribute("color",new z.a(w,3)),u.addAttribute("indexes",new z.a(i,1));var S={texture:{value:j},repeat:{value:Object(A.a)(z.k,E)},size:{value:0}},C="\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }";"Caltech"===t.props.dataset&&(C="\n          uniform sampler2D texture;\n          uniform vec2 repeat;\n          varying vec2 vOffset;\n          varying vec3 vColor;\n          void main() {\n            vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n            // vec4 tex = texture2D( texture, uv * repeat );\n            vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n            // if ( tex.r < 0.5 ) discard;\n            if ( uv[0] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] < 0.1 ) tex = vec4(vColor, 1.0);\n            if ( uv[0] > 0.9 ) tex = vec4(vColor, 1.0);\n            if ( uv[1] > 0.9 ) tex = vec4(vColor, 1.0);\n            // tex.r = 1.0;\n            // tex.g = 1.0;\n            // tex.b = 1.0;\n            gl_FragColor = tex;\n        }");var M=new z.i({uniforms:S,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:C}),T=new z.f(u,M);l.add(T)},h=0;h<d;h++)u(h);this.scene.children[1]=l}},{key:"revealSelected",value:function(){for(var t=this,e={value:0},n={value:W[this.props.dataset]},a=this.scene.children[1].children,r=function(r){var i=a[r],o=new P.Tween(e).to(n,400).easing(P.Easing.Linear.None);o.onUpdate(function(){i.material.uniforms.size=e});var s=t;o.onComplete(function(){0===r&&s.props.setTransitionStatus(1)}),o.start()},i=0;i<a.length;i++)r(i)}},{key:"labelSelected",value:function(){for(var t=this,e=this.props,n=e.loaded_embedding,a=e.embeddings[n],r=B(this.props.dataset).map(function(t){return K(a,t)}),i=this.scene.children[1].children,o=function(e){var n=r[e],a=i[e],o=Array.from(a.geometry.attributes.indexes.array),s=i[e].geometry.attributes.color.array.slice(),c=o.map(function(e){var a=n.labels[e];return t.state.status_to_color[a]}),l=k.flatten(c),d=new Float32Array(l),u=new P.Tween(s).to(d,400).easing(P.Easing.Linear.None),h=i[e];u.onUpdate(function(){h.geometry.attributes.color.array=s,h.geometry.attributes.color.needsUpdate=!0});var p=t;u.onComplete(function(){0===e&&setTimeout(function(){p.props.setTransitionStatus(2.3)},0)}),u.start()},s=0;s<r.length;s++)o(s)}},{key:"componentDidUpdate",value:function(t){var e=this;if(null===t.loaded_embedding&&null!==this.props.loaded_embedding)Promise.all(F(q[this.props.dataset])).then(function(t){e.textures=t,e.addPoints(),e.addSelectedPoints(),e.props.setTransitionStatus(.5)});else if(t.loaded_embedding!==this.props.loaded_embedding){var n=w(t.loaded_embedding),a=w(this.props.loaded_embedding);if(n.dataset!==a.dataset){var r=Z(a.dataset),i=r.color_array,o=r.color_array_hexes,s=r.status_to_color;for(this.setState({color_array:i,color_array_hexes:o,status_to_color:s});this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);this.props.setTransitionStatus(0);var c=this;setTimeout(function(){Promise.all(F(q[c.props.dataset])).then(function(t){c.textures=t,c.addPoints(),c.addSelectedPoints(),c.props.setTransitionStatus(.5)})},0)}else n.strategy!==a.strategy?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0):n.round!==a.round&&1.5!==this.props.transition_status&&this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0)}else.5===this.props.transition_status&&0===t.transition_status||.5===this.props.transition_status&&2.6===t.transition_status?this.revealSelected():2===this.props.transition_status&&1.5===t.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===t.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):(this.props.round,t.round)}},{key:"showHover",value:function(t,e,n,a){var r=this.props.embeddings[this.props.loaded_embedding];this.scene.children[1].visible=!0,this.hover_mount.style.display="block";var i="".concat(t[1]-84-this.props.grem-16-14,"px");this.hover_mount.style.transform="translate3d(".concat(t[0]-42-4,"px, ").concat(i,",0)"),this.hover_ctx=this.hover_mount.childNodes[0].getContext("2d"),this.hover_ctx.imageSmoothingEnabled=!1;var o=this.hover_mount.childNodes[1];this.hover_ctx.fillRect(0,0,84,84);var s=r.statuses[a],c=this.state.status_to_color.slice(0,this.state.status_to_color.length-1);c.push([.5,.5,.5]);var l=null,d="black";1===s?(l="#eee",d="black"):l="rgba("+c[r.labels[a]].map(function(t){return Math.round(255*t)}).join(",")+",1)",this.hover_mount.style.background=l,this.hover_mount.style.color=d;var u=I[this.props.dataset],h=u.sprite_side,p=u.sprite_image_size;o.style.background=l,o.innerText=1===s?"selected":[].concat(Object(g.a)(O[this.props.dataset]),["unlabeled"])[r.labels[a]],this.hover_ctx.drawImage(G[this.props.dataset][e],n%h*p,Math.floor(n/h)*p,p,p,0,0,84,84)}},{key:"checkIntersects",value:function(t){var e=this.props,n=e.width,a=e.height,r=Object(T.a)(t,2),i=r[0],o=r[1],s=I[this.props.dataset].sprite_size;var c=function(t){var e=Object(T.a)(t,2),r=e[0],i=e[1];return new z.l(r/n*2-1,-i/a*2+1,1)}(t);if(this.raycaster.setFromCamera(c,this.camera),this.raycaster.params.Points.threshold=.25,"Caletch"===this.props.dataset&&(this.raycaster.params.Points.threshold=4),void 0!==this.scene.children[0]&&this.scene.children[0].children.length>0){var l=this.raycaster.intersectObjects(this.scene.children[0].children);if(l[0]){var d=function(t){return k.sortBy(t,"distanceToRay")}(l)[0],u=d.object.userData.sprite_index,h=d.index,p=u*s+h;this.showHover([i,o],u,h,p)}else this.hover_mount.style.display="none"}}},{key:"handleMouse",value:function(){var t=this,e=D.d(this.renderer.domElement);this.raycaster=new z.g,e.on("mousemove",function(){var n=D.b(e.node()),a=Object(T.a)(n,2),r=[a[0],a[1]];t.checkIntersects(r)}),e.on("mousedown",function(){t.hover_mount.style.display="none"})}},{key:"init",value:function(){var t=this.props,e=t.width,n=t.height,a=Z(this.props.dataset),r=a.color_array,i=a.color_array_hexes,o=a.status_to_color;this.setState({color_array:r,color_array_hexes:i,status_to_color:o}),this.scene=new z.h;var s=e/n;this.camera=new z.e(75,s,.01,1e3),this.camera.position.z=30,this.renderer=new z.m,this.renderer.setClearColor(1118481,1),this.renderer.setSize(e,n),this.mount.appendChild(this.renderer.domElement);var c=new z.c;this.scene.add(c);var l=new z.c;this.scene.add(l),this.d3_zoom=D.e().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var d=D.d(this.mount);this.view=d,d.call(this.d3_zoom);var u=this.getScaleFromZ(this.camera.position.z),h=D.f.translate(e/2,n/2).scale(u);this.d3_zoom.transform(d,h),this.animate(),this.handleMouse()}},{key:"animate",value:function(){requestAnimationFrame(this.animate),P.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,a=e.height,i=e.grem,o=e.dataset;return r.a.createElement("div",{style:{position:"absolute",left:0,width:n,height:a,background:"#222",overflow:"hidden",cursor:"crosshair"},grem:i},r.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:n,height:a},ref:function(e){t.mount=e}}),r.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"auto",padding:"0 ".concat(i/4,"px"),position:"absolute",left:0,bottom:i/2,pointerEvents:"none"}},r.a.createElement("div",{style:{display:"flex",flexWrap:"auto"}},r.a.createElement("div",{style:{padding:"0 ".concat(i/4,"px")}},"Key:"),r.a.createElement("div",{style:{background:"#888",color:"#111",height:i,padding:"0 ".concat(i/4,"px"),textAlign:"center"}},"unlabeled"),r.a.createElement("div",{style:{background:"#fff",color:"#111",height:i,padding:"0 ".concat(i/4,"px"),textAlign:"center",marginLeft:i/4}},"selected")),r.a.createElement("div",{style:{padding:"0 ".concat(i/4,"px 0 ").concat(.75*i,"px"),display:"flex",flexWrap:"auto"}},r.a.createElement("div",{style:{padding:"0 0 0 ".concat(i/4,"px")}},"Labels:"),null!==this.state.color_array_hexes?this.state.color_array_hexes.map(function(e,n){return r.a.createElement("div",{key:"color_"+n,style:{background:t.state.color_array_hexes[n],height:i,textAlign:"center",color:"#111",padding:"0 ".concat(i/4,"px"),marginLeft:i/4}},O[o][n])}):null)),r.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:92,pointerEvents:"none",padding:4,display:"none",color:"white",height:i+84+12+0,lineHeight:0,border:"solid ".concat(0,"px rgba(0,0,0,0.3)")},ref:function(e){t.hover_mount=e}},r.a.createElement("canvas",{width:84,height:84,style:{imageRendering:"pixelated"}}),r.a.createElement("div",{style:{width:84,height:i,textAlign:"center",lineHeight:1.5,paddingTop:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})))}}]),e}(a.Component),Y=(Object(g.a)(Array(40)).map(function(t){return null}),Object(g.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")})),$={MNIST:Y,Quickdraw:Object(g.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("QUICKDRAW_").concat(e,".png")})},X=Object(g.a)(Array(10)).map(function(t,e){return m.hsl(0+36*e,1,.5).luminance(.5).hex()}),tt=(a.Component,function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,a=t.grem,i=t.strategies,o=t.strategy_colors,s=t.strategy,c=t.active_embedding,l=t.requested_embedding,d=t.loaded_embedding,u=t.embeddings,h=(t.mnist_images,t.ranges,t.transition_status),p=t.setTransitionStatus,g=t.loading_round,m=(t.header_height,t.footer_height),v=t.round,f=(t.round_limit,t.dataset);return r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(V,{width:e,height:n,grem:a,active_embedding:c,strategies:i,strategy_colors:o,strategy:s,embeddings:u,requested_embedding:l,loaded_embedding:d,transition_status:h,setTransitionStatus:p,loading_round:g,footer_height:m,selectRound:this.props.selectRound,round:v,dataset:f}),null)}}]),e}(a.Component)),et=function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t,e,n,a=this,i=this.props,o=i.transition_status,s=i.grem,c=i.round_limit,l=i.round;0===o?(e="Loading...",n=null):.5===o?(e="Selecting...",n=null):1===o?(e="Label & train",n=1.5):1.5===o?(e="Labeling...",n=null):2===o?(e="Training...",n=null):2.3===o?(e="Training...",n=null):2.6===o&&(e="Deselecting...",n=null);var d=l;return o>1&&o<2.3&&(d=Math.max(0,d-1)),r.a.createElement("div",{style:{display:"flex",position:"absolute",bottom:this.props.footer_height+2.5*s,left:0,padding:"0 ".concat(s/4,"px"),pointerEvents:"none"}},r.a.createElement("div",{style:{padding:"0 ".concat(s/4,"px")}},"Caltech"===this.props.dataset?"50":"1,000"," points selected"),r.a.createElement("div",{style:{padding:"0 ".concat(s/4,"px")}},r.a.createElement("button",{style:{pointerEvents:"auto"},onClick:function(){a.props.toggleList(!0)}},"view list")),r.a.createElement("div",{style:{padding:"0 ".concat(s/4,"px")}},c!==d?r.a.createElement("button",{style:(t={width:140,height:s,background:null===n?"#444":"white",color:null===n?"white":"black",textAlign:"left",cursor:null===n?"default":"pointer",textDecoration:null===n?"none":"underline",borderRadius:s/2},Object(p.a)(t,"textAlign","center"),Object(p.a)(t,"pointerEvents","auto"),t),disabled:null===n,onClick:function(){null!==n&&a.props.setTransitionStatus(n)}},e):null))}}]),e}(a.Component),nt=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={count:0},n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=0,e=0,n=this;function a(){t+=25;var r=Math.floor(t);r!==e&&(e=r),n.setState({count:e}),e<1e3?requestAnimationFrame(a):setTimeout(function(){n.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(a)},200)}},{key:"render",value:function(){var t=this.props;t.grem,t.ww;return r.a.createElement("div",null,r.a.createElement("div",{style:{position:"absolute",height:"100%",width:"100%",left:0,top:0}},r.a.createElement("div",{style:{height:"100%",width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},r.a.createElement("div",{style:{height:"100%",width:"100%",background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),e}(a.Component),at={sprite_side:73,sprite_size:5329,sprite_number:12,sprite_image_size:28},rt=Object.assign({},at,{sprite_number:13}),it=Object.assign({},at,{sprite_side:9,sprite_size:81,sprite_number:11,sprite_image_size:224}),ot={MNIST:at,Quickdraw:rt,Caltech:it},st=Object(g.a)(Array(at.sprite_number)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")}),ct=Object(g.a)(Array(rt.sprite_number)).map(function(t,e){return"".concat("","/").concat("QUICKDRAW_").concat(e,".png")}),lt={MNIST:st,Quickdraw:ct,Caltech:Object(g.a)(Array(it.sprite_number)).map(function(t,e){return"".concat("","/").concat("CALTECH_").concat(e,".png")})},dt=function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.grem,a=e.embeddings,i=e.loaded_embedding,o=e.dataset,s=e.ww,c=e.wh;console.log(c);var l=[],d=a[i];if(d)for(var u=0;u<d.statuses.length;u++)1===d.statuses[u]&&l.push(u);var h=ot[o],p=h.sprite_size,g=h.sprite_side,m=h.sprite_image_size,v=100+n/2,f=Math.floor((s-n)/v),b=(s-n-n/2*(f-1))/f,y=b/m,_=l.map(function(t){var e=Math.floor(t/p),n=t%p;return[e,n%g,Math.floor(n/g)]});return r.a.createElement("div",{style:{background:"#888"}},r.a.createElement("div",{style:{padding:n/2,background:"white",color:"black",position:"relative"}},"Selected points",r.a.createElement("button",{style:{position:"absolute",right:0,top:0,padding:n/2,color:"black"},onClick:function(){t.props.toggleList(!1)}},"\xd7")),r.a.createElement("div",{style:{overflow:"auto",height:c-6*n}},r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, ".concat(b,"px)"),gridRowGap:n/2,gridColumnGap:n/2,padding:n/2}},_.length>0?_.map(function(t,e){return r.a.createElement("div",{key:t,style:{paddingBottom:"100%",position:"relative"}},r.a.createElement("div",{style:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundImage:"url(".concat(lt[o][t[0]],")"),backgroundSize:"".concat(2048*y,"px ").concat(2048*y,"px"),backgroundPosition:"-".concat(t[1]*y*m,"px -").concat(t[2]*y*m,"px"),imageRendering:"pixelated"}}))}):null)))}}]),e}(a.Component),ut=4,ht=Object(g.a)(Array(ut)).map(function(t,e){return m.hsl(90/ut*e-45,1,.5).luminance(.5).hex()}),pt=[],gt=0;gt<12;gt++){var mt=5329*gt,vt=5329*(gt+1);11===gt&&(vt=63948),pt.push([mt,vt])}var ft=Object(g.a)(Array(12)).map(function(t,e){return"".concat("","/").concat("mnist_").concat(e,".png")}).map(function(t){var e=document.createElement("img");return e.src=t,e});ut=10;var bt,yt=Object(g.a)(Array(ut)).map(function(t,e){return m.hsl(0+360/ut*e,1,.5).luminance(.5).hex()}),_t=yt.reduce(function(t,e,n){return t+e+" "+Math.round(n/ut*100)+(n===ut-1?"%":"%, ")},""),xt=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1,show_list:!1},n.setSize=n.setSize.bind(Object(h.a)(Object(h.a)(n))),n.setHeaderHeight=n.setHeaderHeight.bind(Object(h.a)(Object(h.a)(n))),n.setFooterHeight=n.setFooterHeight.bind(Object(h.a)(Object(h.a)(n))),n.setTransitionStatus=n.setTransitionStatus.bind(Object(h.a)(Object(h.a)(n))),n.labelsGotten=n.labelsGotten.bind(Object(h.a)(Object(h.a)(n))),n.toggleList=n.toggleList.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"setHeaderHeight",value:function(t){this.setState({header_height:t})}},{key:"setFooterHeight",value:function(t){this.setState({footer_height:t})}},{key:"toggleList",value:function(t){this.setState({show_list:t})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(t,e){!0===this.state.loading_round&&t.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(t){1.5===t?(this.setState({transition_status:t,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:t})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var t=this.state,e=t.ww,n=t.wh,a=t.header_height,i=t.footer_height,o=t.loading_round,s=t.simulating_labeling,c=t.transition_status,l=t.show_list,d=this.props,u=d.dataset,h=d.strategy,p=d.round,g=d.datasets,m=d.strategies,v=d.selectDataset,b=d.selectStrategy,y=d.embeddings,_=d.requested_embedding,w=d.loaded_embedding,O=d.strategy_explored;d.toggleList;return null===e?r.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):r.a.createElement("div",{style:{width:e,height:n,overflow:"hidden",position:"relative"}},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"fixed",top:0,right:0,padding:10.5,zIndex:999,background:"red",display:"none"}},c),null!==i&&null!==a?r.a.createElement("div",{style:{background:"white",height:n}},r.a.createElement(tt,{width:e,height:n,grem:21,strategies:m,strategy_colors:ht,strategy:h,dataset:u,embeddings:y,requested_embedding:_,loaded_embedding:w,loading_round:o,selectRound:this.props.selectRound,mnist_images:ft,ranges:pt,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:i,round:p,header_height:a,round_limit:7})):null,null!==i?r.a.createElement(et,{transition_status:this.state.transition_status,grem:21,footer_height:i,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:p,dataset:u,toggleList:this.toggleList}):null,r.a.createElement(f,{datasets:g,selectDataset:v,strategies:m,strategy:h,strategy_colors:ht,selectStrategy:b,dataset:u,activeStyle:x,setHeaderHeight:this.setHeaderHeight,gradient_string:_t,grem:21,transition_status:this.state.transition_status}),null!==a?r.a.createElement(M,{round:p,ww:e,grem:21,strategies:m,strategy_colors:ht,strategy:h,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:_t,color_array_hexes:yt,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:s,strategy_explored:O,round_limit:7,dataset:u}):null,this.state.simulating_labeling?r.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center",color:"black"}},r.a.createElement("div",{style:{position:"relative",width:Math.min(500,e),background:"white",color:"black",padding:21}},r.a.createElement(nt,{grem:21,gradient_string:_t,ww:e,labelsGotten:this.labelsGotten}),r.a.createElement("div",{style:{position:"relative"}},"Getting labels for selected points..."))):null,l?r.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center",color:"black"}},r.a.createElement("div",{style:{position:"relative",width:e-63,color:"black"}},r.a.createElement(dt,{grem:21,dataset:u,embeddings:y,loaded_embedding:w,wh:n,ww:e-63,toggleList:this.toggleList}))):null))}}]),e}(a.Component),wt=["MNIST","Quickdraw","Caltech"],Ot=["random","entropy","adversarial","ensemble"],jt=(bt={},Object(p.a)(bt,wt[0],["mnist_random_round","mnist_entropy_round","mnist_adv_round","mnist_ensemble_entropy_round"]),Object(p.a)(bt,wt[1],["quickdraw_random_round","quickdraw_entropy_round","quickdraw_adv_round","quickdraw_ensemble_entropy_round"]),Object(p.a)(bt,wt[2],["caltech_random_round","caltech_entropy_round","caltech_adv_round","caltech_ensemble_entropy_round"]),bt);function kt(t,e,n){return"".concat(t,"-").concat(e,"-").concat(n)}var Et=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).state={embeddings:{},dataset:wt[0],strategy:Ot[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0},n.scaleEmbeddings=n.scaleEmbeddings.bind(Object(h.a)(Object(h.a)(n))),n.fetchData=n.fetchData.bind(Object(h.a)(Object(h.a)(n))),n.checkOrFetchData=n.checkOrFetchData.bind(Object(h.a)(Object(h.a)(n))),n.selectRound=n.selectRound.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"selectRound",value:function(t){var e=Math.max(this.state.strategy_explored,t);this.setState({round:t,strategy_explored:e}),this.checkOrFetchData(this.state.dataset,this.state.strategy,t)}},{key:"selectDataset",value:function(t){this.setState({dataset:wt[t],strategy_explored:0,round:0}),this.checkOrFetchData(wt[t],this.state.strategy,this.state.round)}},{key:"selectStrategy",value:function(t){this.setState({strategy:Ot[t]}),this.checkOrFetchData(this.state.dataset,Ot[t],this.state.round)}},{key:"checkOrFetchData",value:function(t,e,n){var a=this.state.embeddings,r=kt(t,e,n);this.setState({requested_embedding:r}),void 0!==a[r]?this.setState({loaded_embedding:r}):this.fetchData(t,e,n)}},{key:"scaleEmbeddings",value:function(t){var e=t.map(function(t){return Math.abs(t[0])}),n=t.map(function(t){return Math.abs(t[1])}),a=k.max(e),r=k.max(n),i=Math.max(a,r),o=D.c().domain([-i,i]).range([-20,20]);return t.map(function(t){return[o(t[0]),o(t[1])]})}},{key:"fetchData",value:function(t,e,n){var a=this,r="".concat("","/").concat(jt[t][Ot.indexOf(e)]).concat(n,".json");fetch(r).then(function(t){return t.json()}).then(function(r){var i=r.coordinates,o=i.map(function(t){return Math.abs(t[0])}),s=i.map(function(t){return Math.abs(t[1])}),c=k.max(o),l=k.max(s),d=Math.max(c,l),u=D.c().domain([-d,d]).range([-20,20]),h=i.map(function(t){return[u(t[0]),u(t[1])]}),g={};g.coordinates=h,g.statuses=r.status,g.labels=r.labels;var m=kt(t,e,n);a.setState({loaded_embedding:m,embeddings:Object.assign({},a.state.embeddings,Object(p.a)({},m,g))})})}},{key:"componentDidMount",value:function(){var t=this.state,e=t.dataset,n=t.strategy,a=t.round;this.checkOrFetchData(e,n,a)}},{key:"render",value:function(){return r.a.createElement(xt,Object.assign({},this.state,{datasets:wt,strategies:Ot,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this)}))}}]),e}(a.Component),St=(n(29),function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement(Et,null)}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(St,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.cbdba67f.chunk.js.map