(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){e.exports=n(31)},26:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(20),s=n.n(r),o=(n(26),n(3)),c=n(4),l=n(7),d=n(5),u=n(6),h=n(1),p=n(14),g=n(8),m=n(11),v=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},b=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={},n.setHeight=n.setHeight.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setHeaderHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this,t=this.props,n=t.datasets,a=t.selectDataset,r=t.strategies,s=t.strategy,o=(t.strategy_colors,t.selectStrategy),c=t.dataset,l=(t.activeStyle,t.grem);return i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",left:0,top:0,display:"flex",flexWrap:"wrap"}},i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px"),fontWeight:"bold"}},"Active Learner")),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px")}},"Dataset:"),n.map(function(e,t){var n,r=e===c;return n=r?i.a.createElement("span",null,e):i.a.createElement("button",{onClick:function(){a(t)}},e),i.a.createElement("span",{key:e,style:{padding:"0 ".concat(l/4,"px"),background:r?"white":"transparent",color:r?"black":"white"}},n)}).reduce(function(e,t){return[e," ",t]})),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"wrap",padding:"0 ".concat(l/4,"px"),pointerEvents:"all"}},i.a.createElement("div",{style:{padding:"0 ".concat(l/4,"px")}},"Strategy:"),r.map(function(e,t){var n,a=e===s;return n=a?i.a.createElement("span",null,v(e)):i.a.createElement("button",{onClick:function(){o(t)}},v(e)),i.a.createElement("span",{key:e,style:{padding:"0 ".concat(l/4,"px"),background:a?"white":"transparent",color:a?"black":"white"}},n)}).reduce(function(e,t){return[e," ",t]})))}}]),t}(a.Component);function f(e){return Math.round(1e4*e)/100+"%"}function y(e,t,n,a){a?e.moveTo(t,n):e.lineTo(t,n)}function _(e){return{background:e,boxShadow:"-0.25em 0 0 ".concat(e,", 0.25em 0 0 ").concat(e),textDecoration:"none"}}function w(e){var t=e.split("-");return{dataset:t[0],strategy:t[1],round:t[2]}}var x={MNIST:[0,1,2,3,4,5,6,7,8,9],Quickdraw:["dolphin","cat","face","angel","airplane","apple","broccoli","crayon","bicycle","elephant"]},O=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.getCtx(this.refs.canvas)}},{key:"render",value:function(){this.props.grem;return i.a.createElement("div",{style:{lineHeight:0,width:this.props.width}},i.a.createElement("canvas",{ref:"canvas",width:2*this.props.width,height:2*this.props.height,style:{width:this.props.width,height:this.props.height,pointerEvents:"auto"}}))}}]),t}(a.Component),j=n(9),k={MNIST:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.7685568264784619,.805609637381358,.8077999513263567,.8172913117546848,.8289729861280117,.8298856169384279,.8343270868824532,.8541615964954977,.8440009734728644]},entropy:{accuracy:[.7685568264784619,.805609637381358,.8077999513263567,.8172913117546848,.8289729861280117,.8298856169384279,.8343270868824532,.8541615964954977,.8440009734728644]},adversarial:{accuracy:[.7685568264784619,.805609637381358,.8077999513263567,.8172913117546848,.8289729861280117,.8298856169384279,.8343270868824532,.8541615964954977,.8440009734728644]},ensemble:{accuracy:[.7685568264784619,.805609637381358,.8077999513263567,.8172913117546848,.8289729861280117,.8298856169384279,.8343270868824532,.8541615964954977,.8440009734728644]}},Quickdraw:{num_labeled:[5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3,13e3],random:{accuracy:[.7685568264784619,.8011681674373327,.7949622779265028,.8040885860306644,.8141275249452421,.823192990995376,.8260525675346799,.831284984181066,.8297639328303723]},entropy:{accuracy:[.7685568264784619,.7963008031151132,.7894256510099781,.8050012168410805,.8212460452664881,.8202725724020443,.8123631053784376,.8289729861280117,.8267826721830129]},adversarial:{accuracy:[.7685568264784619,.7963008031151132,.7894256510099781,.8050012168410805,.8212460452664881,.8202725724020443,.8123631053784376,.8289729861280117,.8267826721830129]},ensemble:{accuracy:[.7685568264784619,.8283037235337065,.8426624482842541,.83603066439523,.8523971769286931,.8506935994159163,.8619493794110489,.8623752737892432,.8586639084935508]}}},E=(Object(g.a)(Array(4)).map(function(e){return Object(g.a)(Array(5)).map(function(e){return Math.random()})}),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).ctx=null,n.getCtx=n.getCtx.bind(Object(h.a)(Object(h.a)(n))),n.draw=n.draw.bind(Object(h.a)(Object(h.a)(n))),n.handleRound=n.handleRound.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getCtx",value:function(e){this.ctx=e.getContext("2d")}},{key:"componentDidMount",value:function(){this.ctx.scale(2,2),this.draw()}},{key:"componentDidUpdate",value:function(e){this.props.strategy_explored!==e.strategy_explored&&this.ctx.scale(2,2),this.draw()}},{key:"handleRound",value:function(e){e!==this.props.round&&this.props.selectRound(e)}},{key:"draw",value:function(){var e=this.props,t=(e.width,e.height),n=e.strategies,a=(e.strategy_colors,e.round),i=e.strategy,r=e.grem,s=e.transition_status,o=e.strategy_explored,c=e.dataset,l=k[c],d=l[i];t-=2*r,3===s&&(a+=1);var u=this.ctx,h=4,p=n.map(function(e){return j.min(l[e].accuracy)}),g=Math.floor(10*j.min(p))/10,m=1-g;u.clearRect(0,0,100*(o+1),t);var v=2*h;t-=2*v,u.fillStyle="rgba(100,100,100,0.3)",u.fillRect(100*a,v,100,t),u.lineWidth=3,u.strokeStyle="rgba(100,100,100,0.5)";for(var b=0;b<m+.05;b+=.05){u.beginPath();var f=b/m*t;y(u,0,f+v,!0),y(u,100*(o+1),f+v,!1),u.stroke()}var _=n.filter(function(e){return e!==i}),w=!0,x=!1,O=void 0;try{for(var E,S=_[Symbol.iterator]();!(w=(E=S.next()).done);w=!0){var C=E.value,T=l[C];u.lineWidth=2,u.strokeStyle="#666",u.fillStyle="#666",u.beginPath();for(var M=0;M<o+1;M++){y(u,100*M+50,t-(T.accuracy[M]-g)/(1-g)*t+v,0===M)}u.stroke();for(var A=0;A<o+1;A++){var D=(T.accuracy[A]-g)/(1-g);u.beginPath(),u.arc(100*A+50,t-D*t+v,h,0,2*Math.PI),u.fill()}}}catch(R){x=!0,O=R}finally{try{w||null==S.return||S.return()}finally{if(x)throw O}}h=6,u.lineWidth=2,u.strokeStyle="#efefef",u.fillStyle="#efefef",u.beginPath();for(var H=0;H<o+1;H++){y(u,100*H+50,t-(d.accuracy[H]-g)/(1-g)*t+v,0===H)}u.stroke();for(var P=0;P<o+1;P++){var F=(d.accuracy[P]-g)/(1-g);u.beginPath(),u.arc(100*P+50,t-F*t+v,h,0,2*Math.PI),u.fill()}}},{key:"render",value:function(){var e=this,t=this.props,n=(t.width,t.height),a=t.grem,r=(t.strategies,t.strategy),s=t.round,o=t.transition_status,c=(t.adjusted_round,t.strategy_explored),l=t.round_limit,d=t.dataset,u=k[d].num_labeled,h=k[d][r],p=s;return o>1&&(p=s+1),i.a.createElement("div",{style:{}},i.a.createElement("div",{style:{display:"inline-flex",pointerEvents:"auto"}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("span",null,"Round ",s+1," of ",l+1)," ")),i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"Accuracy: ",f(h.accuracy[s])))),i.a.createElement("div",{style:{position:"relative",width:100*(c+1),height:n-2*a,pointerEvents:"auto"}},i.a.createElement(O,{width:100*(c+1),height:n-2*a,getCtx:this.getCtx,grem:a}),i.a.createElement(i.a.Fragment,null,Object(g.a)(Array(c+1)).map(function(t,r){return i.a.createElement("div",{key:"explored"+r,onClick:function(){e.handleRound(r)},style:{position:"absolute",top:0,left:100*r,width:100,height:n-2*a,cursor:r===s?"default":"pointer"}})}),i.a.createElement("div",{style:{position:"absolute",top:8,left:100*(c+1),width:100*(l-c),height:n-2*a-16,border:"solid 2px rgba(100,100,100,0.2)",borderLeft:"none",pointerEvents:"none"}}))),i.a.createElement("div",{style:{display:"flex",pointerEvents:"auto",justifyContent:"space-between",padding:"0 ".concat(a/4,"px")}},i.a.createElement("div",{style:{padding:"0 ".concat(a/4,"px")}},"100,000 points, ",function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}(u[p])," labelled (",f(u[p]/1e6),")")))}}]),t}(a.Component)),S=(Math.floor(10*Math.random()),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={},n.setHeight=n.setHeight.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setHeight",value:function(){var e=this.divElement.clientHeight;this.props.setFooterHeight(e)}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this,t=this.props,n=t.round,a=t.ww,r=t.grem,s=t.strategies,o=t.strategy_colors,c=t.strategy,l=(t.selectRound,t.color_array_hexes,t.transition_status),d=(t.simulating_labeling,t.gradient_string,t.strategy_explored),u=t.round_limit,h=t.dataset,p=n,g=d;return l>1&&l<2.3&&(p=Math.max(0,p-1),g=Math.max(0,g-1)),i.a.createElement("div",{ref:function(t){e.divElement=t},style:{position:"absolute",bottom:2*r,left:0,height:7*r,pointerEvents:"none"}},i.a.createElement(E,{width:a,transition_status:l,height:7*r,grem:r,strategies:s,selectRound:this.props.selectRound,dataset:h,strategy_colors:o,strategy:c,round:p,strategy_explored:g,round_limit:u}))}}]),t}(a.Component)),C=n(15),T=n(16),M=n(2),A=n(12),D=n(10);function H(e){var t=new M.j;return e.map(function(e){return new Promise(function(n,a){t.load(e,function(e){e.flipY=!1,n(e)},void 0,function(e){return a(e)})})})}(new M.j).load("".concat("","/circle.png")).flipY=!1;for(var P=Object(g.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")}),F=Object(g.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")}),R={MNIST:P,Quickdraw:F},z={MNIST:P.map(function(e){var t=document.createElement("img");return t.src=e,t}),Quickdraw:F.map(function(e){var t=document.createElement("img");return t.src=e,t})},L=[],U=0;U<12;U++){var W=5329*U,I=5329*(U+1);11===U&&(I=63948),L.push([W,I])}var N=10,q=Object(g.a)(Array(N)).map(function(e,t){return m.hsl(0+360/N*t,1,.5).luminance(.5).gl()});q.push(m.hsl(0,0,.5).luminance(.1).gl()),N=10;var G=Object(g.a)(Array(N)).map(function(e,t){return m.hsl(0+360/N*t,1,.5).luminance(.5).hex()}),Q=q.map(function(e){return e.slice(0,3)});function Z(e,t){return{coordinates:e.coordinates.slice(t[0],t[1]),labels:e.labels.slice(t[0],t[1]),statuses:e.statuses.slice(t[0],t[1])}}function B(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];t.push(a[0],a[1],0)}return new Float32Array(t)}for(var K=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={},n.init=n.init.bind(Object(h.a)(Object(h.a)(n))),n.animate=n.animate.bind(Object(h.a)(Object(h.a)(n))),n.addPoints=n.addPoints.bind(Object(h.a)(Object(h.a)(n))),n.transitionPoints=n.transitionPoints.bind(Object(h.a)(Object(h.a)(n))),n.addSelectedPoints=n.addSelectedPoints.bind(Object(h.a)(Object(h.a)(n))),n.labelSelected=n.labelSelected.bind(Object(h.a)(Object(h.a)(n))),n.showHover=n.showHover.bind(Object(h.a)(Object(h.a)(n))),n.hover_ctx=null,n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getZFromScale",value:function(e){var t=M.d.degToRad(this.camera.fov);return this.props.height/e/(2*Math.tan(t/2))}},{key:"getScaleFromZ",value:function(e){var t=M.d.degToRad(this.camera.fov),n=2*(Math.tan(t/2)*e);return this.props.height/n}},{key:"zoomHandler",value:function(){var e=A.a.transform,t=e.k,n=-(e.x-this.props.width/2)/t,a=(e.y-this.props.height/2)/t,i=this.getZFromScale(t);this.camera.position.set(n,a,i)}},{key:"addPoints",value:function(){var e=this.props,t=e.loaded_embedding,n=e.embeddings;this.scene.children[0]=new M.c;for(var a=n[t],i=L.map(function(e){return Z(a,e)}),r=new M.c,s=i.length,o=0;o<s;o++){for(var c=i[o],l=c.coordinates.length,d=new M.b,u=B(c.coordinates),h=new Float32Array(2*l),p=0,g=0,m=l;p<m;p++,g+=2){var v=p%73*28/2048,b=28*Math.floor(p/73)/2048;h[g]=v,h[g+1]=b}var f=c.labels.map(function(e){return Q[e]}),y=j.flatten(f),_=new Float32Array(y),w=this.textures[o],x=[1/73,1/73];d.addAttribute("position",new M.a(u,3)),d.addAttribute("offset",new M.a(h,2)),d.addAttribute("color",new M.a(_,3));var O={texture:{value:w},repeat:{value:Object(T.a)(M.k,x)},size:{value:30}},k=new M.i({uniforms:O,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat  + vOffset);\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new M.f(d,k);E.userData={sprite_index:o},r.add(E)}this.scene.children[0]=r}},{key:"transitionPoints",value:function(e,t,n){for(var a=this,i=this.scene.children[0],r=this.scene.children[1].children,s=t[e],o=L.map(function(e){return Z(s,e)}),c=o.length,l=function(e){var t=i.children[e],s=o[e],c=t.geometry.attributes.position.array.slice(),l=B(s.coordinates),d=t.geometry.attributes.color.array.slice(),u=s.labels.map(function(e){return Q[e]}),h=j.flatten(u),p=new Float32Array(h),g=new D.Tween(d).to(p,400).easing(D.Easing.Linear.None);g.onUpdate(function(){t.geometry.attributes.color.array=d,t.geometry.attributes.color.needsUpdate=!0}),g.delay(400);var m=new D.Tween(c).to(l,800).easing(D.Easing.Linear.None);m.onUpdate(function(){t.geometry.attributes.position.array=c,t.geometry.attributes.position.needsUpdate=!0}),m.start().chain(g);var v=r[e],b=Array.from(v.geometry.attributes.indexes.array),f=v.geometry.attributes.position.array.slice(),y=B(b.map(function(e){return s.coordinates[e]})),_=new Float32Array(y),w=1200;n||(w=400);var x={value:30},O=a,k=new D.Tween(x).to({value:0},400).easing(D.Easing.Linear.None).delay(w).onComplete(function(){0===e&&(O.addSelectedPoints(),O.props.setTransitionStatus(.5))});k.onUpdate(function(){v.material.uniforms.size=x});var E=new D.Tween(f).to(_,800).easing(D.Easing.Linear.None);E.onUpdate(function(){v.geometry.attributes.position.array=f,v.geometry.attributes.position.needsUpdate=!0}),E.onComplete(function(){0===e&&setTimeout(function(){v.material.uniforms.size.value>0?O.props.setTransitionStatus(2.6):(O.addSelectedPoints(),O.props.setTransitionStatus(0))},0)}),v.material.uniforms.size.value>0&&E.chain(k),E.start()},d=0;d<c;d++)l(d)}},{key:"addSelectedPoints",value:function(){var e=this,t=this.props,n=t.loaded_embedding,a=t.embeddings;this.scene.children[1]=new M.c;for(var i=a[n],r=L.map(function(e){return Z(i,e)}),s=new M.c,o=r.length,c=function(t){for(var n=r[t],a=[],i=0;i<n.statuses.length;i++)1===n.statuses[i]&&a.push(i);for(var o=new Float32Array(a),c=a.length,l=new M.b,d=B(a.map(function(e){return n.coordinates[e]})),u=new Float32Array(2*c),h=0,p=0,g=c;h<g;h++,p+=2){var m=a[h],v=m%73*28/2048,b=28*Math.floor(m/73)/2048;u[p]=v,u[p+1]=b}var f=a.map(function(e){return[.85,.85,.85]}),y=j.flatten(f),_=new Float32Array(y),w=e.textures[t],x=[1/73,1/73];l.addAttribute("position",new M.a(d,3)),l.addAttribute("offset",new M.a(u,2)),l.addAttribute("color",new M.a(_,3)),l.addAttribute("indexes",new M.a(o,1));var O={texture:{value:w},repeat:{value:Object(T.a)(M.k,x)},size:{value:0}},k=new M.i({uniforms:O,vertexShader:"\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 color;\n        varying vec3 vColor;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          vColor = color;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vColor;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          // vec4 tex = texture2D( texture, uv * repeat );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          if ( tex.r < 0.5 ) discard;\n          tex.r = 1.0;\n          tex.g = 1.0;\n          tex.b = 1.0;\n          gl_FragColor = tex * vec4(vColor, 1.0);\n        }"}),E=new M.f(l,k);s.add(E)},l=0;l<o;l++)c(l);this.scene.children[1]=s}},{key:"revealSelected",value:function(){for(var e=this,t={value:0},n={value:30},a=this.scene.children[1].children,i=function(i){var r=a[i],s=new D.Tween(t).to(n,400).easing(D.Easing.Linear.None);s.onUpdate(function(){r.material.uniforms.size=t});var o=e;s.onComplete(function(){0===i&&o.props.setTransitionStatus(1)}),s.start()},r=0;r<a.length;r++)i(r)}},{key:"labelSelected",value:function(){for(var e=this,t=this.props,n=t.loaded_embedding,a=t.embeddings[n],i=L.map(function(e){return Z(a,e)}),r=this.scene.children[1].children,s=function(t){var n=i[t],a=r[t],s=Array.from(a.geometry.attributes.indexes.array),o=r[t].geometry.attributes.color.array.slice(),c=s.map(function(e){var t=n.labels[e];return Q[t]}),l=j.flatten(c),d=new Float32Array(l),u=new D.Tween(o).to(d,400).easing(D.Easing.Linear.None),h=r[t];u.onUpdate(function(){h.geometry.attributes.color.array=o,h.geometry.attributes.color.needsUpdate=!0});var p=e;u.onComplete(function(){0===t&&setTimeout(function(){p.props.setTransitionStatus(2.3)},0)}),u.start()},o=0;o<i.length;o++)s(o)}},{key:"componentDidUpdate",value:function(e){var t=this;if(null===e.loaded_embedding&&null!==this.props.loaded_embedding)Promise.all(H(R[this.props.dataset])).then(function(e){t.textures=e,t.addPoints(),t.addSelectedPoints(),t.props.setTransitionStatus(.5)});else if(e.loaded_embedding!==this.props.loaded_embedding){var n=w(e.loaded_embedding),a=w(this.props.loaded_embedding);if(n.dataset!==a.dataset){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);this.props.setTransitionStatus(0);var i=this;setTimeout(function(){Promise.all(H(R[i.props.dataset])).then(function(e){i.textures=e,i.addPoints(),i.addSelectedPoints(),i.props.setTransitionStatus(.5)})},0)}else n.strategy!==a.strategy?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0):n.round!==a.round&&1.5!==this.props.transition_status&&this.transitionPoints(this.props.loaded_embedding,this.props.embeddings,!0)}else.5===this.props.transition_status&&0===e.transition_status||.5===this.props.transition_status&&2.6===e.transition_status?this.revealSelected():2===this.props.transition_status&&1.5===e.transition_status?this.labelSelected(this.props.loaded_embedding,this.props.embeddings):2.3===this.props.transition_status&&2===e.transition_status?this.transitionPoints(this.props.loaded_embedding,this.props.embeddings):(this.props.round,e.round)}},{key:"showHover",value:function(e,t,n,a){var i=this.props.embeddings[this.props.loaded_embedding];this.scene.children[1].visible=!0,this.hover_mount.style.display="block",this.hover_mount.style.transform="translate3d(".concat(e[0]-42-4,"px, ").concat(e[1]-84-this.props.grem-16-14,"px,0)"),this.hover_ctx=this.hover_mount.childNodes[0].getContext("2d");var r=this.hover_mount.childNodes[1];this.hover_ctx.fillRect(0,0,84,84);var s=i.statuses[a],o=Q.slice(0,Q.length-1);o.push([.5,.5,.5]);var c=null,l="black";1===s?(c="#eee",l="black"):c="rgba("+o[i.labels[a]].map(function(e){return Math.round(255*e)}).join(",")+",1)",this.hover_mount.style.background=c,this.hover_mount.style.color=l,r.style.background=c,r.innerText=1===s?"selected":[].concat(Object(g.a)(x[this.props.dataset]),["unlabeled"])[i.labels[a]],this.hover_ctx.drawImage(z[this.props.dataset][t],n%73*28,28*Math.floor(n/73),28,28,0,0,84,84)}},{key:"checkIntersects",value:function(e){var t=this.props,n=t.width,a=t.height,i=Object(C.a)(e,2),r=i[0],s=i[1];var o=function(e){var t=Object(C.a)(e,2),i=t[0],r=t[1];return new M.l(i/n*2-1,-r/a*2+1,1)}(e);if(this.raycaster.setFromCamera(o,this.camera),this.raycaster.params.Points.threshold=.25,void 0!==this.scene.children[0]&&this.scene.children[0].children.length>0){var c=this.raycaster.intersectObjects(this.scene.children[0].children);if(c[0]){var l=function(e){return j.sortBy(e,"distanceToRay")}(c)[0],d=l.object.userData.sprite_index,u=l.index,h=5329*d+u;this.showHover([r,s],d,u,h)}else this.hover_mount.style.display="none"}}},{key:"handleMouse",value:function(){var e=this,t=A.d(this.renderer.domElement);this.raycaster=new M.g,t.on("mousemove",function(){var n=A.b(t.node()),a=Object(C.a)(n,2),i=[a[0],a[1]];e.checkIntersects(i)}),t.on("mousedown",function(){e.hover_mount.style.display="none"})}},{key:"init",value:function(){var e=this.props,t=e.width,n=e.height;this.scene=new M.h;var a=t/n;this.camera=new M.e(75,a,.01,1e3),this.camera.position.z=30,this.renderer=new M.m,this.renderer.setClearColor(1118481,1),this.renderer.setSize(t,n),this.mount.appendChild(this.renderer.domElement);var i=new M.c;this.scene.add(i);var r=new M.c;this.scene.add(r),this.d3_zoom=A.e().scaleExtent([this.getScaleFromZ(999),this.getScaleFromZ(.1)]).on("zoom",this.zoomHandler.bind(this));var s=A.d(this.mount);this.view=s,s.call(this.d3_zoom);var o=this.getScaleFromZ(this.camera.position.z),c=A.f.translate(t/2,n/2).scale(o);this.d3_zoom.transform(s,c),this.animate(),this.handleMouse()}},{key:"animate",value:function(){requestAnimationFrame(this.animate),D.update(),this.renderer.sortObjects=!1,this.renderer.render(this.scene,this.camera)}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,r=t.grem,s=t.dataset;return i.a.createElement("div",{style:{position:"absolute",left:0,width:n,height:a,background:"#222",overflow:"hidden",cursor:"crosshair"},grem:r},i.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:n,height:a},ref:function(t){e.mount=t}}),i.a.createElement("div",{style:{background:"transparent",display:"flex",flexWrap:"auto",padding:"0 ".concat(r/4,"px"),position:"absolute",left:0,bottom:r/2,pointerEvents:"none"}},i.a.createElement("div",{style:{display:"flex",flexWrap:"auto"}},i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px")}},"Key:"),i.a.createElement("div",{style:{background:"#888",color:"#111",height:r,padding:"0 ".concat(r/4,"px"),textAlign:"center"}},"unlabeled"),i.a.createElement("div",{style:{background:"#fff",color:"#111",height:r,padding:"0 ".concat(r/4,"px"),textAlign:"center",marginLeft:r/4}},"selected")),i.a.createElement("div",{style:{padding:"0 ".concat(r/4,"px 0 ").concat(.75*r,"px"),display:"flex",flexWrap:"auto"}},i.a.createElement("div",{style:{padding:"0 0 0 ".concat(r/4,"px")}},"Labels:"),G.map(function(e,t){return i.a.createElement("div",{key:"color_"+t,style:{background:G[t],height:r,textAlign:"center",color:"#111",padding:"0 ".concat(r/4,"px"),marginLeft:r/4}},x[s][t])}))),i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:92,pointerEvents:"none",padding:4,display:"none",color:"white",height:r+84+12+0,lineHeight:0,border:"solid ".concat(0,"px rgba(0,0,0,0.3)")},ref:function(t){e.hover_mount=t}},i.a.createElement("canvas",{width:84,height:84,style:{imageRendering:"pixelated"}}),i.a.createElement("div",{style:{width:84,height:r,textAlign:"center",lineHeight:1.5,paddingTop:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})))}}]),t}(a.Component),J=(Object(g.a)(Array(40)).map(function(e){return null}),Object(g.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")})),V={MNIST:J,Quickdraw:Object(g.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("QUICKDRAW_").concat(t,".png")})},Y=Object(g.a)(Array(10)).map(function(e,t){return m.hsl(0+36*t,1,.5).luminance(.5).hex()}),$=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={labels:null,prev_loaded:null},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.embeddings;if(this.props.loaded_embedding!==e.loaded_embedding)if(null===e.loaded_embedding)this.setState({prev_loaded:this.props.loaded_embedding});else{for(var a=n[e.loaded_embedding],i=[],r=0;r<a.statuses.length;r++)1===a.statuses[r]&&i.push(r);var s=n[this.props.loaded_embedding],o=i.map(function(e,t){return s.labels[e]});this.setState({labels:o})}if(.5===this.props.transition_status&&0!==e.transition_status){var c=this;setTimeout(function(){c.setState({prev_loaded:t.props.loaded_embedding,labels:null})},0)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,r=t.grem,s=t.embeddings,o=t.loaded_embedding,c=t.transition_status,l=t.header_height,d=t.round,u=t.round_limit,h=t.dataset,p=[],g=s[this.state.prev_loaded];if(g)for(var m=0;m<g.statuses.length;m++)1===g.statuses[m]&&p.push(m);var v=r/2,b=r/4,f=(n-2*b*2-2*v)/3,y=f,_=p.map(function(e){var t=e%5329;return[Math.floor(e/5329),t%73,Math.floor(t/73)]});null!==o&&p.map(function(e,t){return s[o].labels[t]});var w=f/28,O=d;return c>1&&c<2.3&&(O=Math.max(0,O-1)),i.a.createElement("div",{style:{position:"absolute",right:0,top:l,width:n,height:a,background:"#333",overflow:"hidden"}},0===c?i.a.createElement("div",{style:{padding:r/4}},i.a.createElement("div",{style:{padding:r/4}},"Use the select data button below to select data points based on the strategy.")):null,i.a.createElement("div",{style:{opacity:0===c||2.6===c||u===O?0:1,transition:"opacity 0.4s linear",transitionDelay:"0.1s",padding:r/2,position:"relative"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",position:"absolute",left:0,top:0,width:n,background:"#444",padding:"".concat(r/4,"px ").concat(r/2,"px")}},i.a.createElement("div",null,c<2?"Selected":"Labeled",":"),i.a.createElement("div",null,"1,000")),i.a.createElement("div",{style:{right:0,top:l,width:n,height:a-r/2,paddingTop:1*r,background:"#333",overflow:"auto"}},i.a.createElement("div",{style:{display:"grid",paddingTop:2*b,paddingBottom:2*b,gridTemplateColumns:"repeat(".concat(3,", ").concat(f,"px)"),gridColumnGap:v,gridRowGap:v}},_.length>0?_.map(function(t,n){var a=null!==e.state.labels&&e.props.transition_status>1.5?x[h][e.state.labels[n]]:"selected",s=null!==e.state.labels&&e.props.transition_status>1.5?Y[e.state.labels[n]]:"#ddd";return i.a.createElement("div",{key:t,style:{width:f,height:y+r-3,background:s,color:"#111",textAlign:"center",transition:"background 400ms linear",paddingLeft:3,paddingTop:3}},i.a.createElement("div",{style:{backgroundImage:"url(".concat(V[h][t[0]],")"),backgroundSize:"".concat(2048*w,"px ").concat(2048*w,"px"),backgroundPosition:"-".concat(t[1]*w*28,"px -").concat(t[2]*w*28,"px"),width:f-6,height:y-6,imageRendering:"pixelated"}}),i.a.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},a))}):null))))}}]),t}(a.Component),X=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,a=e.grem,r=e.strategies,s=e.strategy_colors,o=e.strategy,c=e.active_embedding,l=e.requested_embedding,d=e.loaded_embedding,u=e.embeddings,h=e.mnist_images,p=e.ranges,g=e.transition_status,m=e.setTransitionStatus,v=e.loading_round,b=e.header_height,f=e.footer_height,y=e.round,_=e.round_limit,w=e.dataset;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(K,{width:t,height:n,grem:a,active_embedding:c,strategies:r,strategy_colors:s,strategy:o,embeddings:u,requested_embedding:l,loaded_embedding:d,transition_status:g,setTransitionStatus:m,loading_round:v,footer_height:f,selectRound:this.props.selectRound,round:y,dataset:w}),i.a.createElement($,{width:200,height:n-this.props.footer_height-2*a-b,grem:a,mnist_images:h,embeddings:u,loaded_embedding:d,ranges:p,transition_status:g,header_height:b,round:y,round_limit:_,dataset:w}))}}]),t}(a.Component),ee=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,n=this,a=this.props,r=a.transition_status,s=a.grem,o=a.round_limit,c=a.round;0===r?(e="Loading...",t=null):.5===r?(e="Selecting...",t=null):1===r?(e="Label & train",t=1.5):1.5===r?(e="Labeling...",t=null):2===r?(e="Training...",t=null):2.3===r?(e="Training...",t=null):2.6===r&&(e="Deselecting...",t=null);var l=c;return r>1&&r<2.3&&(l=Math.max(0,l-1)),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",background:"#111",position:"absolute",bottom:this.props.footer_height,right:0}},i.a.createElement("div",null,o!==l?i.a.createElement("button",{style:{width:200,height:2*s,background:null===t?"#eee":"white",color:"black",textAlign:"left",paddingLeft:s/2,cursor:null===t?"default":"pointer",textDecoration:null===t?"none":"underline"},disabled:null===t,onClick:function(){null!==t&&n.props.setTransitionStatus(t)}},e):null))}}]),t}(a.Component),te=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={count:0},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=0,t=0,n=this;function a(){e+=25;var i=Math.floor(e);i!==t&&(t=i),n.setState({count:t}),t<1e3?requestAnimationFrame(a):setTimeout(function(){n.props.labelsGotten()},200)}setTimeout(function(){return requestAnimationFrame(a)},200)}},{key:"render",value:function(){var e=this.props,t=e.grem,n=e.ww;return i.a.createElement("div",null,i.a.createElement("div",{style:{height:t,width:"".concat(100,"%"),marginTop:t/2,background:"#222"}},i.a.createElement("div",{style:{height:t,width:"".concat(this.state.count/1e3*100,"%"),overflow:"hidden"}},i.a.createElement("div",{style:{height:t,width:Math.min(500,n)-2*t,background:"linear-gradient(to right, ".concat(this.props.gradient_string,")")}}))))}}]),t}(a.Component),ne=4,ae=Object(g.a)(Array(ne)).map(function(e,t){return m.hsl(90/ne*t-45,1,.5).luminance(.5).hex()}),ie=[],re=0;re<12;re++){var se=5329*re,oe=5329*(re+1);11===re&&(oe=63948),ie.push([se,oe])}var ce=Object(g.a)(Array(12)).map(function(e,t){return"".concat("","/").concat("mnist_").concat(t,".png")}).map(function(e){var t=document.createElement("img");return t.src=e,t});ne=10;var le,de=Object(g.a)(Array(ne)).map(function(e,t){return m.hsl(0+360/ne*t,1,.5).luminance(.5).hex()}),ue=de.reduce(function(e,t,n){return e+t+" "+Math.round(n/ne*100)+(n===ne-1?"%":"%, ")},""),he=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={ww:null,wh:null,header_height:null,footer_height:null,transition_status:0,loading_round:!1,simulating_labeling:!1},n.setSize=n.setSize.bind(Object(h.a)(Object(h.a)(n))),n.setHeaderHeight=n.setHeaderHeight.bind(Object(h.a)(Object(h.a)(n))),n.setFooterHeight=n.setFooterHeight.bind(Object(h.a)(Object(h.a)(n))),n.setTransitionStatus=n.setTransitionStatus.bind(Object(h.a)(Object(h.a)(n))),n.labelsGotten=n.labelsGotten.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"setHeaderHeight",value:function(e){this.setState({header_height:e})}},{key:"setFooterHeight",value:function(e){this.setState({footer_height:e})}},{key:"setSize",value:function(){this.setState({ww:window.innerWidth,wh:window.innerHeight})}},{key:"componentWillMount",value:function(){this.setSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setSize)}},{key:"componentDidUpdate",value:function(e,t){!0===this.state.loading_round&&e.loaded_embedding!==this.props.loaded_embedding&&this.setState({loading_round:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setSize)}},{key:"setTransitionStatus",value:function(e){1.5===e?(this.setState({transition_status:e,simulating_labeling:!0}),this.props.selectRound(this.props.round+1)):this.setState({transition_status:e})}},{key:"labelsGotten",value:function(){this.setState({transition_status:2,loading_round:!0,simulating_labeling:!1})}},{key:"render",value:function(){var e=this.state,t=e.ww,n=e.wh,a=e.header_height,r=e.footer_height,s=e.loading_round,o=e.simulating_labeling,c=e.transition_status,l=this.props,d=l.dataset,u=l.strategy,h=l.round,p=l.datasets,g=l.strategies,m=l.selectDataset,v=l.selectStrategy,f=l.embeddings,y=l.requested_embedding,w=l.loaded_embedding,x=l.strategy_explored;return null===t?i.a.createElement("div",{style:{padding:5.25}},"Loading layout..."):i.a.createElement("div",{style:{width:t,height:n,overflow:"hidden",position:"relative"}},i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",top:0,right:0,padding:10.5,zIndex:999,background:"red",display:"none"}},c),null!==r&&null!==a?i.a.createElement("div",{style:{background:"white",height:n}},i.a.createElement(X,{width:t,height:n,grem:21,strategies:g,strategy_colors:ae,strategy:u,dataset:d,embeddings:f,requested_embedding:y,loaded_embedding:w,loading_round:s,selectRound:this.props.selectRound,mnist_images:ce,ranges:ie,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,footer_height:r,round:h,header_height:a,round_limit:7})):null,null!==r?i.a.createElement(ee,{transition_status:this.state.transition_status,grem:21,footer_height:r,setTransitionStatus:this.setTransitionStatus,round_limit:7,round:h}):null,i.a.createElement(b,{datasets:p,selectDataset:m,strategies:g,strategy:u,strategy_colors:ae,selectStrategy:v,dataset:d,activeStyle:_,setHeaderHeight:this.setHeaderHeight,gradient_string:ue,grem:21,transition_status:this.state.transition_status}),null!==a?i.a.createElement(S,{round:h,ww:t,grem:21,strategies:g,strategy_colors:ae,strategy:u,setFooterHeight:this.setFooterHeight,selectRound:this.props.selectRound,gradient_string:ue,color_array_hexes:de,transition_status:this.state.transition_status,setTransitionStatus:this.setTransitionStatus,simulating_labeling:o,strategy_explored:x,round_limit:7,dataset:d}):null,this.state.simulating_labeling?i.a.createElement("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",display:"grid",justifyItems:"center",alignItems:"center"}},i.a.createElement("div",{style:{width:Math.min(500,t),background:"#666",padding:21}},i.a.createElement("div",null,"Getting labels for 1,000 selected points..."),i.a.createElement(te,{grem:21,gradient_string:ue,ww:t,labelsGotten:this.labelsGotten}))):null))}}]),t}(a.Component),pe=["MNIST","Quickdraw","Caltech"],ge=["random","entropy","adversarial","ensemble"],me=(le={},Object(p.a)(le,pe[0],["mnist_random_round","mnist_entropy_round","mnist_adv_round","mnist_ensemble_entropy_round"]),Object(p.a)(le,pe[1],["quickdraw_random_round","quickdraw_entropy_round","quickdraw_adv_round","quickdraw_ensemble_entropy_round"]),le);function ve(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}var be=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={embeddings:{},dataset:pe[1],strategy:ge[1],round:0,requested_embedding:null,loaded_embedding:null,strategy_explored:0},n.scaleEmbeddings=n.scaleEmbeddings.bind(Object(h.a)(Object(h.a)(n))),n.fetchData=n.fetchData.bind(Object(h.a)(Object(h.a)(n))),n.checkOrFetchData=n.checkOrFetchData.bind(Object(h.a)(Object(h.a)(n))),n.selectRound=n.selectRound.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"selectRound",value:function(e){var t=Math.max(this.state.strategy_explored,e);this.setState({round:e,strategy_explored:t}),this.checkOrFetchData(this.state.dataset,this.state.strategy,e)}},{key:"selectDataset",value:function(e){this.setState({dataset:pe[e],strategy_explored:0,round:0}),this.checkOrFetchData(pe[e],this.state.strategy,this.state.round)}},{key:"selectStrategy",value:function(e){this.setState({strategy:ge[e]}),this.checkOrFetchData(this.state.dataset,ge[e],this.state.round)}},{key:"checkOrFetchData",value:function(e,t,n){var a=this.state.embeddings,i=ve(e,t,n);this.setState({requested_embedding:i}),void 0!==a[i]?this.setState({loaded_embedding:i}):this.fetchData(e,t,n)}},{key:"scaleEmbeddings",value:function(e){var t=e.map(function(e){return Math.abs(e[0])}),n=e.map(function(e){return Math.abs(e[1])}),a=j.max(t),i=j.max(n),r=Math.max(a,i),s=A.c().domain([-r,r]).range([-20,20]);return e.map(function(e){return[s(e[0]),s(e[1])]})}},{key:"fetchData",value:function(e,t,n){var a=this,i="".concat("","/").concat(me[e][ge.indexOf(t)]).concat(n,".json");fetch(i).then(function(e){return e.json()}).then(function(i){var r=i.coordinates,s=r.map(function(e){return Math.abs(e[0])}),o=r.map(function(e){return Math.abs(e[1])}),c=j.max(s),l=j.max(o),d=Math.max(c,l),u=A.c().domain([-d,d]).range([-20,20]),h=r.map(function(e){return[u(e[0]),u(e[1])]}),g={};g.coordinates=h,g.statuses=i.status,g.labels=i.labels;var m=ve(e,t,n);a.setState({loaded_embedding:m,embeddings:Object.assign({},a.state.embeddings,Object(p.a)({},m,g))})})}},{key:"componentDidMount",value:function(){var e=this.state,t=e.dataset,n=e.strategy,a=e.round;this.checkOrFetchData(t,n,a)}},{key:"render",value:function(){return i.a.createElement(he,Object.assign({},this.state,{datasets:pe,strategies:ge,selectDataset:this.selectDataset.bind(this),selectStrategy:this.selectStrategy.bind(this),selectRound:this.selectRound.bind(this)}))}}]),t}(a.Component),fe=(n(29),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(be,null)}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.caa311e6.chunk.js.map